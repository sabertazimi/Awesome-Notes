
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Javascript Advanced Notes Â· Awesome Notes</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="sabertazimi">
        
        
    
    <link rel="stylesheet" href="../../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-prism/prism-tomorrow.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-disqus/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-theme-comscore/test.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="javascriptBasicNotes.html" />
    
    

    <style>
    @media only screen and (max-width: 640px) {
        .book-header .hidden-mobile {
            display: none;
        }
    }
    </style>
    <script>
        window["gitbook-plugin-github-buttons"] = {"buttons":[{"user":"sabertazimi","repo":"awesome-notes","type":"star","size":"small","count":true}]};
    </script>

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="https://github.com/sabertazimi/awesome-notes" target="_blank" class="custom-link">Awesome Notes</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../../">
            
                <a href="../../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    Computer Science
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" >
            
                <span>
            
                    
                    Algorithms
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="../../../computerScience/algorithms/algorithmsBasicNotes.html">
            
                <a href="../../../computerScience/algorithms/algorithmsBasicNotes.html">
            
                    
                    Algorithms Basic Notes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2" data-path="../../../computerScience/algorithms/ojBasicNotes.html">
            
                <a href="../../../computerScience/algorithms/ojBasicNotes.html">
            
                    
                    Oj Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2" >
            
                <span>
            
                    
                    Architecture
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1" data-path="../../../computerScience/architecture/archBasicNotes.html">
            
                <a href="../../../computerScience/architecture/archBasicNotes.html">
            
                    
                    Arch Basic Notes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.2" data-path="../../../computerScience/architecture/graphProcessingNotes.html">
            
                <a href="../../../computerScience/architecture/graphProcessingNotes.html">
            
                    
                    Graph Processing Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.3" >
            
                <span>
            
                    
                    Compilers
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.3.1" data-path="../../../computerScience/compilers/compilersBasicNotes.html">
            
                <a href="../../../computerScience/compilers/compilersBasicNotes.html">
            
                    
                    Compilers Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.4" >
            
                <span>
            
                    
                    Data Base
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1" data-path="../../../computerScience/dataBase/databaseBasicNotes.html">
            
                <a href="../../../computerScience/dataBase/databaseBasicNotes.html">
            
                    
                    Database Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.5" >
            
                <span>
            
                    
                    Network
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.5.1" data-path="../../../computerScience/network/networkBasicNotes.html">
            
                <a href="../../../computerScience/network/networkBasicNotes.html">
            
                    
                    Network Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.6" >
            
                <span>
            
                    
                    Operating Systems
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.6.1" data-path="../../../computerScience/operatingSystems/CSAPP.html">
            
                <a href="../../../computerScience/operatingSystems/CSAPP.html">
            
                    
                    CSAPP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.2" data-path="../../../computerScience/operatingSystems/memoryManagementBasicNotes.html">
            
                <a href="../../../computerScience/operatingSystems/memoryManagementBasicNotes.html">
            
                    
                    Memory Management Basic Notes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.3" data-path="../../../computerScience/operatingSystems/operatingSystemsBasicNotes.html">
            
                <a href="../../../computerScience/operatingSystems/operatingSystemsBasicNotes.html">
            
                    
                    Operating Systems Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.7" >
            
                <span>
            
                    
                    Software Testing
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.7.1" data-path="../../../computerScience/softwareTesting/softwareTestingBasicNotes.html">
            
                <a href="../../../computerScience/softwareTesting/softwareTestingBasicNotes.html">
            
                    
                    Software Testing Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.8" >
            
                <span>
            
                    
                    Virtualization
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.8.1" data-path="../../../computerScience/virtualization/virtBasicNotes.html">
            
                <a href="../../../computerScience/virtualization/virtBasicNotes.html">
            
                    
                    Virt Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.9" data-path="../../../computerScience/latexBasicNotes.html">
            
                <a href="../../../computerScience/latexBasicNotes.html">
            
                    
                    Latex Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Language
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" >
            
                <span>
            
                    
                    Assembly
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="../../../language/assembly/AssemblyBasic.html">
            
                <a href="../../../language/assembly/AssemblyBasic.html">
            
                    
                    Assembly Basic
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" >
            
                <span>
            
                    
                    C
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" >
            
                <span>
            
                    
                    Tools
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1.1" data-path="../../../language/c/tools/awesomeTools.html">
            
                <a href="../../../language/c/tools/awesomeTools.html">
            
                    
                    Awesome Tools
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.1.2" data-path="../../../language/c/tools/gdbTutorial.html">
            
                <a href="../../../language/c/tools/gdbTutorial.html">
            
                    
                    Gdb Tutorial
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="../../../language/c/cBasicNotes.html">
            
                <a href="../../../language/c/cBasicNotes.html">
            
                    
                    C Basic Notes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" data-path="../../../language/c/namingConventions.html">
            
                <a href="../../../language/c/namingConventions.html">
            
                    
                    Naming Conventions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.4" data-path="../../../language/c/standardLibrary.html">
            
                <a href="../../../language/c/standardLibrary.html">
            
                    
                    Standard Library
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" >
            
                <span>
            
                    
                    Cpp
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" data-path="../../../language/cpp/cppBasicNotes.html">
            
                <a href="../../../language/cpp/cppBasicNotes.html">
            
                    
                    Cpp Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.4" >
            
                <span>
            
                    
                    Go
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.1" data-path="../../../language/go/goBasicNotes.html">
            
                <a href="../../../language/go/goBasicNotes.html">
            
                    
                    Go Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.5" >
            
                <span>
            
                    
                    Haskell
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.5.1" data-path="../../../language/haskell/haskellBasicNotes.html">
            
                <a href="../../../language/haskell/haskellBasicNotes.html">
            
                    
                    Haskell Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.6" >
            
                <span>
            
                    
                    Java
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.6.1" data-path="../../../language/java/javaBasicNotes.html">
            
                <a href="../../../language/java/javaBasicNotes.html">
            
                    
                    Java Basic Notes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6.2" data-path="../../../language/java/javaNamingConventions.html">
            
                <a href="../../../language/java/javaNamingConventions.html">
            
                    
                    Java Naming Conventions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.7" >
            
                <span>
            
                    
                    Python
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.7.1" data-path="../../../language/python/pythonBasicNotes.html">
            
                <a href="../../../language/python/pythonBasicNotes.html">
            
                    
                    Python Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.8" >
            
                <span>
            
                    
                    Verilog
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.8.1" data-path="../../../language/verilog/verilogBasicNotes.html">
            
                <a href="../../../language/verilog/verilogBasicNotes.html">
            
                    
                    Verilog Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    Programming
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" >
            
                <span>
            
                    
                    Android
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="../../android/androidBasicNotes.html">
            
                <a href="../../android/androidBasicNotes.html">
            
                    
                    Android Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" >
            
                <span>
            
                    
                    Code Guide
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../../codeGuide/bugGuideBasicNotes.html">
            
                <a href="../../codeGuide/bugGuideBasicNotes.html">
            
                    
                    Bug Guide Basic Notes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2" data-path="../../codeGuide/cleanCodeBasicNotes.html">
            
                <a href="../../codeGuide/cleanCodeBasicNotes.html">
            
                    
                    Clean Code Basic Notes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.3" data-path="../../codeGuide/codeReviewBasicNotes.html">
            
                <a href="../../codeGuide/codeReviewBasicNotes.html">
            
                    
                    Code Review Basic Notes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.4" data-path="../../codeGuide/designPatternsNotes.html">
            
                <a href="../../codeGuide/designPatternsNotes.html">
            
                    
                    Design Patterns Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.3" >
            
                <span>
            
                    
                    Functional Programming
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.3.1" data-path="../../functionalProgramming/functionalProgrammingBasicNotes.html">
            
                <a href="../../functionalProgramming/functionalProgrammingBasicNotes.html">
            
                    
                    Functional Programming Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.4" >
            
                <span>
            
                    
                    Game
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.4.1" data-path="../../game/gameDesignBasicNotes.html">
            
                <a href="../../game/gameDesignBasicNotes.html">
            
                    
                    Game Design Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.5" >
            
                <span>
            
                    
                    Linux
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.5.1" data-path="../../linux/linuxBasicNotes.html">
            
                <a href="../../linux/linuxBasicNotes.html">
            
                    
                    Linux Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.6" >
            
                <span>
            
                    
                    Server
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.6.1" data-path="../../server/messageQueueBasicNotes.html">
            
                <a href="../../server/messageQueueBasicNotes.html">
            
                    
                    Message Queue Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.7" >
            
                <span>
            
                    
                    Tools
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.7.1" >
            
                <span>
            
                    
                    Build Tools
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.7.1.1" data-path="../../tools/buildTools/CmakeBasicNotes.html">
            
                <a href="../../tools/buildTools/CmakeBasicNotes.html">
            
                    
                    Cmake Basic Notes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7.1.2" data-path="../../tools/buildTools/makefileBasicNotes.html">
            
                <a href="../../tools/buildTools/makefileBasicNotes.html">
            
                    
                    Makefile Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.7.2" >
            
                <span>
            
                    
                    Git
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.7.2.1" data-path="../../tools/git/gitBasicNotes.html">
            
                <a href="../../tools/git/gitBasicNotes.html">
            
                    
                    Git Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.7.3" >
            
                <span>
            
                    
                    Vim
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.7.3.1" data-path="../../tools/vim/vimBasicNotes.html">
            
                <a href="../../tools/vim/vimBasicNotes.html">
            
                    
                    Vim Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.8" >
            
                <span>
            
                    
                    Web
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.8.1" >
            
                <span>
            
                    
                    Angular
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.8.1.1" data-path="../angular/angularBasicNotes.html">
            
                <a href="../angular/angularBasicNotes.html">
            
                    
                    Angular Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.8.2" >
            
                <span>
            
                    
                    Css
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.8.2.1" data-path="../css/bootstrapBasicNotes.html">
            
                <a href="../css/bootstrapBasicNotes.html">
            
                    
                    Bootstrap Basic Notes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.2.2" data-path="../css/cssAdvancedNotes.html">
            
                <a href="../css/cssAdvancedNotes.html">
            
                    
                    Css Advanced Notes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.2.3" data-path="../css/cssBasicNotes.html">
            
                <a href="../css/cssBasicNotes.html">
            
                    
                    Css Basic Notes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.2.4" data-path="../css/sassBasicNotes.html">
            
                <a href="../css/sassBasicNotes.html">
            
                    
                    Sass Basic Notes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.2.5" data-path="../css/sassOfficalReference.html">
            
                <a href="../css/sassOfficalReference.html">
            
                    
                    Sass Offical Reference
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.8.3" >
            
                <span>
            
                    
                    Frameworks
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.8.3.1" data-path="../frameworks/electronBasicNotes.html">
            
                <a href="../frameworks/electronBasicNotes.html">
            
                    
                    Electron Basic Notes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.3.2" data-path="../frameworks/jQueryBasicNotes.html">
            
                <a href="../frameworks/jQueryBasicNotes.html">
            
                    
                    J Query Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.8.4" >
            
                <span>
            
                    
                    Html
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.8.4.1" data-path="../html/htmlBasicNotes.html">
            
                <a href="../html/htmlBasicNotes.html">
            
                    
                    Html Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.8.5" >
            
                <span>
            
                    
                    Javascript
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.4.8.5.1" data-path="javascriptAdvancedNotes.html">
            
                <a href="javascriptAdvancedNotes.html">
            
                    
                    Javascript Advanced Notes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.5.2" data-path="javascriptBasicNotes.html">
            
                <a href="javascriptBasicNotes.html">
            
                    
                    Javascript Basic Notes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.5.3" data-path="typescriptBasicNotes.html">
            
                <a href="typescriptBasicNotes.html">
            
                    
                    Typescript Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.8.6" >
            
                <span>
            
                    
                    Nodejs
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.8.6.1" data-path="../nodejs/expressBasicNotes.html">
            
                <a href="../nodejs/expressBasicNotes.html">
            
                    
                    Express Basic Notes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.6.2" data-path="../nodejs/graphqlBasicNotes.html">
            
                <a href="../nodejs/graphqlBasicNotes.html">
            
                    
                    Graphql Basic Notes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.6.3" data-path="../nodejs/nodejsBasicNotes.html">
            
                <a href="../nodejs/nodejsBasicNotes.html">
            
                    
                    Nodejs Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.8.7" >
            
                <span>
            
                    
                    Reactjs
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.8.7.1" data-path="../reactjs/reactjsBasicNotes.html">
            
                <a href="../reactjs/reactjsBasicNotes.html">
            
                    
                    Reactjs Basic Notes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.7.2" data-path="../reactjs/reactRouterBasicNotes.html">
            
                <a href="../reactjs/reactRouterBasicNotes.html">
            
                    
                    React Router Basic Notes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.7.3" data-path="../reactjs/reduxBasicNotes.html">
            
                <a href="../reactjs/reduxBasicNotes.html">
            
                    
                    Redux Basic Notes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8.7.4" data-path="../reactjs/webpackBasicNotes.html">
            
                <a href="../reactjs/webpackBasicNotes.html">
            
                    
                    Webpack Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.8.8" >
            
                <span>
            
                    
                    Security
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.8.8.1" data-path="../security/securityBasicNotes.html">
            
                <a href="../security/securityBasicNotes.html">
            
                    
                    Security Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.8.9" >
            
                <span>
            
                    
                    Vuejs
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.8.9.1" data-path="../vuejs/vueBasicNotes.html">
            
                <a href="../vuejs/vueBasicNotes.html">
            
                    
                    Vue Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.8.10" data-path="../libraryBasicNotes.html">
            
                <a href="../libraryBasicNotes.html">
            
                    
                    Library Basic Notes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../.." >Javascript Advanced Notes</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><li><span class="title-icon "></span><a href="#javascript-advanced-notes"><b> </b>JavaScript Advanced Notes</a></li><ul><li><span class="title-icon "></span><a href="#modern-javascript"><b>1. </b>Modern JavaScript</a></li><ul><li><span class="title-icon "></span><a href="#tc39"><b>1.1. </b>TC39</a></li><li><span class="title-icon "></span><a href="#babel"><b>1.2. </b>Babel</a></li><li><span class="title-icon "></span><a href="#variable"><b>1.3. </b>Variable</a></li><li><span class="title-icon "></span><a href="#destructuringpattern-matching"><b>1.4. </b>Destructuring(Pattern Matching)</a></li><li><span class="title-icon "></span><a href="#string"><b>1.5. </b>String</a></li><li><span class="title-icon "></span><a href="#regexp"><b>1.6. </b>RegExp</a></li><li><span class="title-icon "></span><a href="#number"><b>1.7. </b>Number</a></li><li><span class="title-icon "></span><a href="#internationalization"><b>1.8. </b>Internationalization</a></li><li><span class="title-icon "></span><a href="#array"><b>1.9. </b>Array</a></li><li><span class="title-icon "></span><a href="#new-object-api"><b>1.10. </b>New Object API</a></li><li><span class="title-icon "></span><a href="#arrow-function"><b>1.11. </b>Arrow Function</a></li><li><span class="title-icon "></span><a href="#modules"><b>1.12. </b>Modules</a></li><li><span class="title-icon "></span><a href="#class-&#x8BED;&#x6CD5;&#x7CD6;"><b>1.13. </b>Class &#x8BED;&#x6CD5;&#x7CD6;</a></li><li><span class="title-icon "></span><a href="#map"><b>1.14. </b>Map</a></li><li><span class="title-icon "></span><a href="#weakmap"><b>1.15. </b>WeakMap</a></li><li><span class="title-icon "></span><a href="#symbol"><b>1.16. </b>Symbol</a></li><li><span class="title-icon "></span><a href="#iterator"><b>1.17. </b>Iterator</a></li><li><span class="title-icon "></span><a href="#generator"><b>1.18. </b>Generator</a></li><li><span class="title-icon "></span><a href="#proxy-and-reflect"><b>1.19. </b>Proxy and Reflect</a></li></ul><li><span class="title-icon "></span><a href="#functional-javascript"><b>2. </b>Functional JavaScript</a></li><ul><li><span class="title-icon "></span><a href="#pros"><b>2.1. </b>Pros</a></li><li><span class="title-icon "></span><a href="#cons"><b>2.2. </b>Cons</a></li><li><span class="title-icon "></span><a href="#closure"><b>2.3. </b>Closure</a></li><li><span class="title-icon "></span><a href="#partial-application"><b>2.4. </b>Partial Application</a></li><li><span class="title-icon "></span><a href="#currying"><b>2.5. </b>Currying</a></li></ul><li><span class="title-icon "></span><a href="#internal-javascript"><b>3. </b>Internal JavaScript</a></li><ul><li><span class="title-icon "></span><a href="#variables-lifecycle"><b>3.1. </b>Variables Lifecycle</a></li><li><span class="title-icon "></span><a href="#exection-context"><b>3.2. </b>Exection Context</a></li><li><span class="title-icon "></span><a href="#event-loop"><b>3.3. </b>Event Loop</a></li></ul><li><span class="title-icon "></span><a href="#browser-internal"><b>4. </b>Browser Internal</a></li><ul><li><span class="title-icon "></span><a href="#browser-process"><b>4.1. </b>Browser Process</a></li><li><span class="title-icon "></span><a href="#render-engine"><b>4.2. </b>Render Engine</a></li></ul><li><span class="title-icon "></span><a href="#effective-javascript"><b>5. </b>Effective JavaScript</a></li><ul><li><span class="title-icon "></span><a href="#memory-leak"><b>5.1. </b>Memory Leak</a></li><li><span class="title-icon "></span><a href="#&#x7981;&#x7528;&#x7279;&#x6027;"><b>5.2. </b>&#x7981;&#x7528;&#x7279;&#x6027;</a></li><li><span class="title-icon "></span><a href="#&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x51FD;&#x6570;&#x53C2;&#x6570;"><b>5.3. </b>&#x5C40;&#x90E8;&#x53D8;&#x91CF;/&#x51FD;&#x6570;&#x53C2;&#x6570;</a></li><li><span class="title-icon "></span><a href="#&#x5B57;&#x7B26;&#x4E32;"><b>5.4. </b>&#x5B57;&#x7B26;&#x4E32;</a></li><li><span class="title-icon "></span><a href="#&#x51FD;&#x6570;"><b>5.5. </b>&#x51FD;&#x6570;</a></li><li><span class="title-icon "></span><a href="#&#x5FAA;&#x73AF;"><b>5.6. </b>&#x5FAA;&#x73AF;</a></li><li><span class="title-icon "></span><a href="#exception"><b>5.7. </b>Exception</a></li><li><span class="title-icon "></span><a href="#event-delegate&#x4E8B;&#x4EF6;&#x59D4;&#x6258;"><b>5.8. </b>Event Delegate(&#x4E8B;&#x4EF6;&#x59D4;&#x6258;)</a></li><li><span class="title-icon "></span><a href="#&#x7F13;&#x5B58;&#x6A21;&#x5F0F;"><b>5.9. </b>&#x7F13;&#x5B58;&#x6A21;&#x5F0F;</a></li><li><span class="title-icon "></span><a href="#&#x52A0;&#x8F7D;&#x811A;&#x672C;"><b>5.10. </b>&#x52A0;&#x8F7D;&#x811A;&#x672C;</a></li><li><span class="title-icon "></span><a href="#dom-performance"><b>5.11. </b>DOM Performance</a></li><li><span class="title-icon "></span><a href="#css"><b>5.12. </b>CSS</a></li><li><span class="title-icon "></span><a href="#&#x5B9A;&#x65F6;&#x5668;&#x9632;&#x6B62;&#x811A;&#x672C;&#x963B;&#x585E;"><b>5.13. </b>&#x5B9A;&#x65F6;&#x5668;(&#x9632;&#x6B62;&#x811A;&#x672C;&#x963B;&#x585E;)</a></li><li><span class="title-icon "></span><a href="#&#x8BA1;&#x65F6;&#x5668;"><b>5.14. </b>&#x8BA1;&#x65F6;&#x5668;</a></li><li><span class="title-icon "></span><a href="#web-worker"><b>5.15. </b>Web Worker</a></li><li><span class="title-icon "></span><a href="#ajax"><b>5.16. </b>Ajax</a></li><li><span class="title-icon "></span><a href="#reduce-repeat-manipulation"><b>5.17. </b>Reduce Repeat Manipulation</a></li><li><span class="title-icon "></span><a href="#first-paint-time"><b>5.18. </b>First Paint Time</a></li><li><span class="title-icon "></span><a href="#&#x7B97;&#x6570;&#x903B;&#x8F91;&#x8FD0;&#x7B97;"><b>5.19. </b>&#x7B97;&#x6570;&#x903B;&#x8F91;&#x8FD0;&#x7B97;</a></li></ul><li><span class="title-icon "></span><a href="#browser-performance"><b>6. </b>Browser Performance</a></li><ul><li><span class="title-icon "></span><a href="#browser-caches"><b>6.1. </b>Browser Caches</a></li><li><span class="title-icon "></span><a href="#browser-pefermance-monitoring"><b>6.2. </b>Browser Pefermance Monitoring</a></li><li><span class="title-icon "></span><a href="#data-format-and-size"><b>6.3. </b>Data Format and Size</a></li><li><span class="title-icon "></span><a href="#data-loading"><b>6.4. </b>Data Loading</a></li><li><span class="title-icon "></span><a href="#v8-good-parts"><b>6.5. </b>V8 Good Parts</a></li><li><span class="title-icon "></span><a href="#perf-and-analysis-tools"><b>6.6. </b>Perf and Analysis Tools</a></li><li><span class="title-icon "></span><a href="#performance-best-practice"><b>6.7. </b>Performance Best Practice</a></li></ul><li><span class="title-icon "></span><a href="#testing-and-debugging"><b>7. </b>Testing and Debugging</a></li><ul><li><span class="title-icon "></span><a href="#log"><b>7.1. </b>Log</a></li><li><span class="title-icon "></span><a href="#headless-testing"><b>7.2. </b>Headless Testing</a></li><li><span class="title-icon "></span><a href="#frameworks"><b>7.3. </b>Frameworks</a></li><li><span class="title-icon "></span><a href="#&#x53EF;&#x6D4B;&#x8BD5;&#x4EE3;&#x7801;"><b>7.4. </b>&#x53EF;&#x6D4B;&#x8BD5;&#x4EE3;&#x7801;</a></li><li><span class="title-icon "></span><a href="#&#x5708;&#x590D;&#x6742;&#x5EA6;"><b>7.5. </b>&#x5708;&#x590D;&#x6742;&#x5EA6;</a></li><li><span class="title-icon "></span><a href="#&#x51FD;&#x6570;&#x590D;&#x6742;&#x5EA6;"><b>7.6. </b>&#x51FD;&#x6570;&#x590D;&#x6742;&#x5EA6;</a></li><li><span class="title-icon "></span><a href="#&#x8026;&#x5408;&#x5EA6;"><b>7.7. </b>&#x8026;&#x5408;&#x5EA6;</a></li><li><span class="title-icon "></span><a href="#&#x5355;&#x5143;&#x6D4B;&#x8BD5;"><b>7.8. </b>&#x5355;&#x5143;&#x6D4B;&#x8BD5;</a></li><li><span class="title-icon "></span><a href="#monkey-patch"><b>7.9. </b>Monkey Patch</a></li><li><span class="title-icon "></span><a href="#tools-api"><b>7.10. </b>Tools API</a></li><li><span class="title-icon "></span><a href="#browser-compatibility"><b>7.11. </b>Browser Compatibility</a></li></ul><li><span class="title-icon "></span><a href="#chrome-dev-tools"><b>8. </b>Chrome Dev Tools</a></li><ul><li><span class="title-icon "></span><a href="#shortcuts"><b>8.1. </b>Shortcuts</a></li><li><span class="title-icon "></span><a href="#elements-panel"><b>8.2. </b>Elements Panel</a></li><li><span class="title-icon "></span><a href="#console-panel"><b>8.3. </b>Console Panel</a></li><li><span class="title-icon "></span><a href="#source-panel"><b>8.4. </b>Source Panel</a></li><li><span class="title-icon "></span><a href="#network-panel"><b>8.5. </b>Network Panel</a></li><li><span class="title-icon "></span><a href="#performance-panel"><b>8.6. </b>Performance Panel</a></li><li><span class="title-icon "></span><a href="#simulation-devtools"><b>8.7. </b>Simulation DevTools</a></li><li><span class="title-icon "></span><a href="#testing-devtools"><b>8.8. </b>Testing DevTools</a></li><li><span class="title-icon "></span><a href="#rendering-panel"><b>8.9. </b>Rendering Panel</a></li><li><span class="title-icon "></span><a href="#more-tools"><b>8.10. </b>More Tools</a></li></ul><li><span class="title-icon "></span><a href="#javascript-style-guide"><b>9. </b>JavaScript Style Guide</a></li><ul><li><span class="title-icon "></span><a href="#naming-style"><b>9.1. </b>Naming Style</a></li><li><span class="title-icon "></span><a href="#variable-style"><b>9.2. </b>Variable Style</a></li><li><span class="title-icon "></span><a href="#object-style"><b>9.3. </b>Object Style</a></li><li><span class="title-icon "></span><a href="#array-style"><b>9.4. </b>Array Style</a></li><li><span class="title-icon "></span><a href="#destruct-style"><b>9.5. </b>Destruct Style</a></li><li><span class="title-icon "></span><a href="#string-style"><b>9.6. </b>String Style</a></li><li><span class="title-icon "></span><a href="#function-style"><b>9.7. </b>Function Style</a></li><li><span class="title-icon "></span><a href="#arrow-function-style"><b>9.8. </b>Arrow Function Style</a></li><li><span class="title-icon "></span><a href="#module-style"><b>9.9. </b>Module Style</a></li><li><span class="title-icon "></span><a href="#iterator-and-generator-style"><b>9.10. </b>Iterator and Generator Style</a></li><li><span class="title-icon "></span><a href="#expression-style"><b>9.11. </b>Expression Style</a></li><li><span class="title-icon "></span><a href="#&#x6362;&#x884C;-style"><b>9.12. </b>&#x6362;&#x884C; Style</a></li><li><span class="title-icon "></span><a href="#&#x7A7A;&#x683C;-style"><b>9.13. </b>&#x7A7A;&#x683C; Style</a></li><li><span class="title-icon "></span><a href="#&#x6CE8;&#x91CA;-style"><b>9.14. </b>&#x6CE8;&#x91CA; Style</a></li></ul><li><span class="title-icon "></span><a href="#ssr"><b>10. </b>SSR</a></li><li><span class="title-icon "></span><a href="#seo"><b>11. </b>SEO</a></li><ul><li><span class="title-icon "></span><a href="#seo-tutorials"><b>11.1. </b>SEO Tutorials</a></li><li><span class="title-icon "></span><a href="#seo-tips"><b>11.2. </b>SEO Tips</a></li></ul><li><span class="title-icon "></span><a href="#pwa"><b>12. </b>PWA</a></li><ul><li><span class="title-icon "></span><a href="#service-worker"><b>12.1. </b>Service Worker</a></li><li><span class="title-icon "></span><a href="#pwa-library"><b>12.2. </b>PWA Library</a></li><li><span class="title-icon "></span><a href="#pwa-tutorials"><b>12.3. </b>PWA Tutorials</a></li></ul><li><span class="title-icon "></span><a href="#http2"><b>13. </b>HTTP/2</a></li><li><span class="title-icon "></span><a href="#security"><b>14. </b>Security</a></li><ul><li><span class="title-icon "></span><a href="#content-security-policy-level-3"><b>14.1. </b>Content Security Policy Level 3</a></li><li><span class="title-icon "></span><a href="#trusted-types"><b>14.2. </b>Trusted Types</a></li><li><span class="title-icon "></span><a href="#csrf"><b>14.3. </b>CSRF</a></li><li><span class="title-icon "></span><a href="#object-property"><b>14.4. </b>Object Property</a></li><li><span class="title-icon "></span><a href="#sandbox"><b>14.5. </b>Sandbox</a></li><li><span class="title-icon "></span><a href="#user-fingerprint"><b>14.6. </b>User Fingerprint</a></li></ul><li><span class="title-icon "></span><a href="#http-protocol"><b>15. </b>HTTP Protocol</a></li><ul><li><span class="title-icon "></span><a href="#http-2"><b>15.1. </b>HTTP 2</a></li><li><span class="title-icon "></span><a href="#http-3"><b>15.2. </b>HTTP 3</a></li></ul><li><span class="title-icon "></span><a href="#devops"><b>16. </b>DevOps</a></li><ul><li><span class="title-icon "></span><a href="#static-assets"><b>16.1. </b>Static Assets</a></li><li><span class="title-icon "></span><a href="#ci-system"><b>16.2. </b>CI System</a></li><li><span class="title-icon "></span><a href="#release-system"><b>16.3. </b>Release System</a></li><li><span class="title-icon "></span><a href="#blue-green-deployment"><b>16.4. </b>Blue Green Deployment</a></li><li><span class="title-icon "></span><a href="#rolling-update"><b>16.5. </b>Rolling Update</a></li><li><span class="title-icon "></span><a href="#gray-release"><b>16.6. </b>Gray Release</a></li></ul></ul></ul></div><a href="#javascript-advanced-notes" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><h1 id="javascript-advanced-notes"><a name="javascript-advanced-notes" class="anchor-navigation-ex-anchor" href="#javascript-advanced-notes"><i class="fa fa-link" aria-hidden="true"></i></a> JavaScript Advanced Notes</h1>
<!-- TOC -->
<ul>
<li><a href="#javascript-advanced-notes">JavaScript Advanced Notes</a><ul>
<li><a href="#modern-javascript">Modern JavaScript</a><ul>
<li><a href="#tc39">TC39</a></li>
<li><a href="#babel">Babel</a><ul>
<li><a href="#babel-node">babel-node</a></li>
<li><a href="#babel-core">babel-core</a></li>
<li><a href="#codemod">Codemod</a></li>
</ul>
</li>
<li><a href="#variable">Variable</a><ul>
<li><a href="#let">let</a></li>
<li><a href="#const">const</a></li>
</ul>
</li>
<li><a href="#destructuringpattern-matching">Destructuring(Pattern Matching)</a><ul>
<li><a href="#&#x9ED8;&#x8BA4;&#x503C;">&#x9ED8;&#x8BA4;&#x503C;</a></li>
<li><a href="#sample">Sample</a><ul>
<li><a href="#swap">swap</a></li>
<li><a href="#&#x7B80;&#x5316;&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570;&#x4E0E;&#x8FD4;&#x56DE;&#x503C;">&#x7B80;&#x5316;&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570;&#x4E0E;&#x8FD4;&#x56DE;&#x503C;</a></li>
<li><a href="#&#x89E3;&#x6790;-json-&#x5BF9;&#x8C61;">&#x89E3;&#x6790; JSON &#x5BF9;&#x8C61;</a></li>
<li><a href="#&#x904D;&#x5386;-maplist">&#x904D;&#x5386; map/list</a></li>
<li><a href="#&#x52A0;&#x8F7D;&#x7279;&#x5B9A;&#x6A21;&#x5757;">&#x52A0;&#x8F7D;&#x7279;&#x5B9A;&#x6A21;&#x5757;</a></li>
</ul>
</li>
<li><a href="#array-iterator-style-matching">Array Iterator Style Matching</a></li>
<li><a href="#object-style-matching">Object Style Matching</a></li>
<li><a href="#string-style-matching">String Style Matching</a></li>
<li><a href="#numberboolean-style-matching">Number/Boolean Style Matching</a></li>
<li><a href="#function-arguments-style-matching">Function Arguments Style Matching</a></li>
</ul>
</li>
<li><a href="#string">String</a><ul>
<li><a href="#methods">Methods</a></li>
<li><a href="#template-string">Template String</a></li>
<li><a href="#tagged-templates">Tagged Templates</a></li>
</ul>
</li>
<li><a href="#regexp">RegExp</a><ul>
<li><a href="#regexp-group">RegExp Group</a></li>
</ul>
</li>
<li><a href="#number">Number</a></li>
<li><a href="#internationalization">Internationalization</a><ul>
<li><a href="#number-intl">Number Intl</a></li>
<li><a href="#string-intl">String Intl</a></li>
<li><a href="#time-intl">Time Intl</a></li>
</ul>
</li>
<li><a href="#array">Array</a><ul>
<li><a href="#arrayincludes">Array.includes</a></li>
<li><a href="#arrayfrom">Array.from</a></li>
<li><a href="#arraycopywithin">Array.copyWithin</a></li>
<li><a href="#arrayfind">Array.find</a></li>
<li><a href="#arrayflat">Array.flat</a></li>
<li><a href="#arrayflatmap">Array.flatMap</a></li>
<li><a href="#arraymap">Array.map</a></li>
<li><a href="#arrayfilter">Array.filter</a></li>
<li><a href="#arrayreduce">Array.reduce</a></li>
<li><a href="#arraysort">Array.sort</a></li>
<li><a href="#spread-array">Spread Array</a></li>
</ul>
</li>
<li><a href="#new-object-api">New Object API</a></li>
<li><a href="#arrow-function">Arrow Function</a></li>
<li><a href="#modules">Modules</a></li>
<li><a href="#class-&#x8BED;&#x6CD5;&#x7CD6;">Class &#x8BED;&#x6CD5;&#x7CD6;</a></li>
<li><a href="#map">Map</a></li>
<li><a href="#weakmap">WeakMap</a></li>
<li><a href="#symbol">Symbol</a></li>
<li><a href="#iterator">Iterator</a><ul>
<li><a href="#synchronous-iterator">Synchronous Iterator</a></li>
<li><a href="#asynchronous-iterator">Asynchronous Iterator</a></li>
</ul>
</li>
<li><a href="#generator">Generator</a><ul>
<li><a href="#basic-usage">Basic Usage</a></li>
<li><a href="#complex-usage">Complex Usage</a></li>
<li><a href="#asynchronous-generator">Asynchronous Generator</a></li>
</ul>
</li>
<li><a href="#proxy-and-reflect">Proxy and Reflect</a><ul>
<li><a href="#default-zero-value-with-proxy">Default Zero Value with Proxy</a></li>
<li><a href="#negative-array-indice-with-proxy">Negative Array Indice with Proxy</a></li>
<li><a href="#hiding-properties-with-proxy">Hiding Properties with Proxy</a></li>
<li><a href="#read-only-object-with-proxy">Read Only Object with Proxy</a></li>
<li><a href="#range-judgement-with-proxy">Range Judgement with Proxy</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#functional-javascript">Functional JavaScript</a><ul>
<li><a href="#pros">Pros</a></li>
<li><a href="#cons">Cons</a></li>
<li><a href="#closure">Closure</a><ul>
<li><a href="#&#x95ED;&#x5305;&#x51FD;&#x6570;&#x7684;&#x7ED3;&#x6784;">&#x95ED;&#x5305;&#x51FD;&#x6570;&#x7684;&#x7ED3;&#x6784;</a></li>
</ul>
</li>
<li><a href="#partial-application">Partial Application</a></li>
<li><a href="#currying">Currying</a></li>
</ul>
</li>
<li><a href="#internal-javascript">Internal JavaScript</a><ul>
<li><a href="#variables-lifecycle">Variables Lifecycle</a></li>
<li><a href="#exection-context">Exection Context</a><ul>
<li><a href="#global-exection-context">Global Exection Context</a></li>
<li><a href="#function-exection-context">Function Exection Context</a></li>
</ul>
</li>
<li><a href="#event-loop">Event Loop</a></li>
</ul>
</li>
<li><a href="#browser-internal">Browser Internal</a><ul>
<li><a href="#browser-process">Browser Process</a></li>
<li><a href="#render-engine">Render Engine</a><ul>
<li><a href="#html-parser">HTML Parser</a></li>
<li><a href="#css-parser">CSS Parser</a></li>
<li><a href="#layout">Layout</a></li>
<li><a href="#paint">Paint</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#effective-javascript">Effective JavaScript</a><ul>
<li><a href="#memory-leak">Memory Leak</a></li>
<li><a href="#&#x7981;&#x7528;&#x7279;&#x6027;">&#x7981;&#x7528;&#x7279;&#x6027;</a></li>
<li><a href="#&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x51FD;&#x6570;&#x53C2;&#x6570;">&#x5C40;&#x90E8;&#x53D8;&#x91CF;/&#x51FD;&#x6570;&#x53C2;&#x6570;</a></li>
<li><a href="#&#x5B57;&#x7B26;&#x4E32;">&#x5B57;&#x7B26;&#x4E32;</a></li>
<li><a href="#&#x51FD;&#x6570;">&#x51FD;&#x6570;</a><ul>
<li><a href="#&#x4F5C;&#x7528;&#x57DF;&#x94FE;">&#x4F5C;&#x7528;&#x57DF;&#x94FE;</a></li>
</ul>
</li>
<li><a href="#&#x5FAA;&#x73AF;">&#x5FAA;&#x73AF;</a><ul>
<li><a href="#&#x5012;&#x5E8F;&#x5FAA;&#x73AF;&#x53EF;&#x63D0;&#x5347;&#x6027;&#x80FD;"><strong>&#x5012;&#x5E8F;</strong>&#x5FAA;&#x73AF;&#x53EF;&#x63D0;&#x5347;&#x6027;&#x80FD;</a></li>
<li><a href="#duffs-device&#x8FBE;&#x592B;&#x8BBE;&#x5907;">Duff&apos;s Device(&#x8FBE;&#x592B;&#x8BBE;&#x5907;)</a></li>
</ul>
</li>
<li><a href="#exception">Exception</a><ul>
<li><a href="#call-stack-overflow">Call Stack Overflow</a></li>
</ul>
</li>
<li><a href="#event-delegate&#x4E8B;&#x4EF6;&#x59D4;&#x6258;">Event Delegate(&#x4E8B;&#x4EF6;&#x59D4;&#x6258;)</a></li>
<li><a href="#&#x7F13;&#x5B58;&#x6A21;&#x5F0F;">&#x7F13;&#x5B58;&#x6A21;&#x5F0F;</a></li>
<li><a href="#&#x52A0;&#x8F7D;&#x811A;&#x672C;">&#x52A0;&#x8F7D;&#x811A;&#x672C;</a><ul>
<li><a href="#&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;">&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;</a></li>
<li><a href="#&#x52A8;&#x6001;&#x52A0;&#x8F7D;">&#x52A8;&#x6001;&#x52A0;&#x8F7D;</a></li>
</ul>
</li>
<li><a href="#dom-performance">DOM Performance</a><ul>
<li><a href="#&#x91CD;&#x6392;&#x4E0E;&#x91CD;&#x7ED8;">&#x91CD;&#x6392;&#x4E0E;&#x91CD;&#x7ED8;</a></li>
<li><a href="#&#x6279;&#x91CF;&#x4FEE;&#x6539;-dom">&#x6279;&#x91CF;&#x4FEE;&#x6539; DOM</a></li>
<li><a href="#requestanimationframe">requestAnimationFrame</a></li>
</ul>
</li>
<li><a href="#css">CSS</a></li>
<li><a href="#&#x5B9A;&#x65F6;&#x5668;&#x9632;&#x6B62;&#x811A;&#x672C;&#x963B;&#x585E;">&#x5B9A;&#x65F6;&#x5668;(&#x9632;&#x6B62;&#x811A;&#x672C;&#x963B;&#x585E;)</a></li>
<li><a href="#&#x8BA1;&#x65F6;&#x5668;">&#x8BA1;&#x65F6;&#x5668;</a></li>
<li><a href="#web-worker">Web Worker</a><ul>
<li><a href="#&#x8FD0;&#x884C;&#x73AF;&#x5883;">&#x8FD0;&#x884C;&#x73AF;&#x5883;</a></li>
<li><a href="#web-worker-loader">Web Worker Loader</a></li>
<li><a href="#worker-&#x5B9E;&#x4F8B;">worker &#x5B9E;&#x4F8B;</a></li>
</ul>
</li>
<li><a href="#ajax">Ajax</a><ul>
<li><a href="#&#x6570;&#x636E;&#x683C;&#x5F0F;">&#x6570;&#x636E;&#x683C;&#x5F0F;</a></li>
<li><a href="#ajax-&#x7F13;&#x5B58;">Ajax &#x7F13;&#x5B58;</a></li>
</ul>
</li>
<li><a href="#reduce-repeat-manipulation">Reduce Repeat Manipulation</a><ul>
<li><a href="#debounce-and-throttle">Debounce and Throttle</a></li>
<li><a href="#requestanimationframe-throttling">RequestAnimationFrame Throttling</a></li>
</ul>
</li>
<li><a href="#first-paint-time">First Paint Time</a></li>
<li><a href="#&#x7B97;&#x6570;&#x903B;&#x8F91;&#x8FD0;&#x7B97;">&#x7B97;&#x6570;&#x903B;&#x8F91;&#x8FD0;&#x7B97;</a><ul>
<li><a href="#&#x4F4D;&#x64CD;&#x4F5C;">&#x4F4D;&#x64CD;&#x4F5C;</a></li>
<li><a href="#math-&#x5BF9;&#x8C61;">Math &#x5BF9;&#x8C61;</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#browser-performance">Browser Performance</a><ul>
<li><a href="#browser-caches">Browser Caches</a><ul>
<li><a href="#http-cache">HTTP Cache</a></li>
<li><a href="#code-caching">Code Caching</a></li>
</ul>
</li>
<li><a href="#browser-pefermance-monitoring">Browser Pefermance Monitoring</a><ul>
<li><a href="#&#x5408;&#x6210;&#x76D1;&#x63A7;">&#x5408;&#x6210;&#x76D1;&#x63A7;</a></li>
<li><a href="#&#x771F;&#x5B9E;&#x7528;&#x6237;&#x76D1;&#x63A7;">&#x771F;&#x5B9E;&#x7528;&#x6237;&#x76D1;&#x63A7;</a></li>
<li><a href="#&#x5BF9;&#x6BD4;">&#x5BF9;&#x6BD4;</a></li>
<li><a href="#&#x65B9;&#x6848;">&#x65B9;&#x6848;</a></li>
<li><a href="#&#x4F7F;&#x7528;&#x6807;&#x51C6;&#x7684;-api">&#x4F7F;&#x7528;&#x6807;&#x51C6;&#x7684; API</a></li>
<li><a href="#&#x5B9A;&#x4E49;&#x5408;&#x9002;&#x7684;&#x6307;&#x6807;">&#x5B9A;&#x4E49;&#x5408;&#x9002;&#x7684;&#x6307;&#x6807;</a></li>
<li><a href="#&#x4E0A;&#x62A5;&#x5173;&#x8054;&#x7684;&#x7EF4;&#x5EA6;">&#x4E0A;&#x62A5;&#x5173;&#x8054;&#x7684;&#x7EF4;&#x5EA6;</a></li>
<li><a href="#speed-tools">Speed Tools</a></li>
</ul>
</li>
<li><a href="#data-format-and-size">Data Format and Size</a><ul>
<li><a href="#images-format">Images Format</a></li>
<li><a href="#images-compression">Images Compression</a></li>
<li><a href="#images-scaling">Images Scaling</a></li>
</ul>
</li>
<li><a href="#data-loading">Data Loading</a><ul>
<li><a href="#data-preloading">Data Preloading</a></li>
<li><a href="#images-lazy-loading">Images Lazy Loading</a></li>
<li><a href="#javascript-lazy-loading">JavaScript Lazy Loading</a></li>
<li><a href="#prefetch">Prefetch</a></li>
<li><a href="#babel-config-for-javascript">Babel Config for JavaScript</a></li>
</ul>
</li>
<li><a href="#v8-good-parts">V8 Good Parts</a><ul>
<li><a href="#object-shape">Object Shape</a></li>
<li><a href="#inline-cache">Inline Cache</a></li>
<li><a href="#v8-perf-tools">V8 Perf Tools</a></li>
<li><a href="#awesome-v8-performance-tutorial">Awesome V8 Performance Tutorial</a></li>
</ul>
</li>
<li><a href="#perf-and-analysis-tools">Perf and Analysis Tools</a><ul>
<li><a href="#inspect-android-device">Inspect Android Device</a></li>
</ul>
</li>
<li><a href="#performance-best-practice">Performance Best Practice</a></li>
</ul>
</li>
<li><a href="#testing-and-debugging">Testing and Debugging</a><ul>
<li><a href="#log">Log</a><ul>
<li><a href="#log-clock">Log Clock</a></li>
</ul>
</li>
<li><a href="#headless-testing">Headless Testing</a><ul>
<li><a href="#browser-context">Browser Context</a></li>
<li><a href="#dom-testing">DOM Testing</a></li>
<li><a href="#event-testing">Event Testing</a></li>
<li><a href="#operation-simulation-testing">Operation Simulation Testing</a></li>
<li><a href="#tracing-testing">Tracing Testing</a></li>
<li><a href="#other-puppeterr-testing-api">Other Puppeterr Testing API</a></li>
</ul>
</li>
<li><a href="#frameworks">Frameworks</a><ul>
<li><a href="#unit-&#x6D4B;&#x8BD5;">Unit &#x6D4B;&#x8BD5;</a></li>
<li><a href="#ui-&#x6D4B;&#x8BD5;">UI &#x6D4B;&#x8BD5;</a></li>
</ul>
</li>
<li><a href="#&#x53EF;&#x6D4B;&#x8BD5;&#x4EE3;&#x7801;">&#x53EF;&#x6D4B;&#x8BD5;&#x4EE3;&#x7801;</a><ul>
<li><a href="#&#x8303;&#x4F8B;">&#x8303;&#x4F8B;</a></li>
</ul>
</li>
<li><a href="#&#x5708;&#x590D;&#x6742;&#x5EA6;">&#x5708;&#x590D;&#x6742;&#x5EA6;</a></li>
<li><a href="#&#x51FD;&#x6570;&#x590D;&#x6742;&#x5EA6;">&#x51FD;&#x6570;&#x590D;&#x6742;&#x5EA6;</a><ul>
<li><a href="#&#x6247;&#x51FA;&#x5F15;&#x7528;-7">&#x6247;&#x51FA;(&#x5F15;&#x7528;) <strong>&lt;7</strong></a></li>
<li><a href="#&#x6247;&#x5165;&#x88AB;&#x5F15;&#x7528;">&#x6247;&#x5165;(&#x88AB;&#x5F15;&#x7528;)</a></li>
</ul>
</li>
<li><a href="#&#x8026;&#x5408;&#x5EA6;">&#x8026;&#x5408;&#x5EA6;</a><ul>
<li><a href="#&#x5185;&#x5BB9;&#x8026;&#x5408;5">&#x5185;&#x5BB9;&#x8026;&#x5408;(5)</a></li>
<li><a href="#&#x516C;&#x5171;&#x8026;&#x5408;4">&#x516C;&#x5171;&#x8026;&#x5408;(4)</a></li>
<li><a href="#&#x63A7;&#x5236;&#x8026;&#x5408;3">&#x63A7;&#x5236;&#x8026;&#x5408;(3)</a></li>
<li><a href="#&#x5370;&#x8BB0;&#x8026;&#x5408;2">&#x5370;&#x8BB0;&#x8026;&#x5408;(2)</a></li>
<li><a href="#&#x6570;&#x636E;&#x8026;&#x5408;1">&#x6570;&#x636E;&#x8026;&#x5408;(1)</a></li>
<li><a href="#&#x65E0;&#x8026;&#x5408;0">&#x65E0;&#x8026;&#x5408;(0)</a></li>
</ul>
</li>
<li><a href="#&#x5355;&#x5143;&#x6D4B;&#x8BD5;">&#x5355;&#x5143;&#x6D4B;&#x8BD5;</a><ul>
<li><a href="#&#x6D4B;&#x8BD5;&#x539F;&#x5219;">&#x6D4B;&#x8BD5;&#x539F;&#x5219;</a></li>
<li><a href="#&#x9694;&#x79BB;&#x88AB;&#x6D4B;&#x4EE3;&#x7801;">&#x9694;&#x79BB;&#x88AB;&#x6D4B;&#x4EE3;&#x7801;</a></li>
<li><a href="#mockstubspy">mock/stub/spy</a></li>
</ul>
</li>
<li><a href="#monkey-patch">Monkey Patch</a></li>
<li><a href="#tools-api">Tools API</a><ul>
<li><a href="#console-api">console API</a></li>
<li><a href="#js-api">JS API</a><ul>
<li><a href="#trace-property-vue-internal">Trace Property (Vue Internal)</a></li>
</ul>
</li>
<li><a href="#node-api">Node API</a></li>
</ul>
</li>
<li><a href="#browser-compatibility">Browser Compatibility</a><ul>
<li><a href="#&#x7279;&#x6027;&#x68C0;&#x6D4B;">&#x7279;&#x6027;&#x68C0;&#x6D4B;</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#chrome-dev-tools">Chrome Dev Tools</a><ul>
<li><a href="#shortcuts">Shortcuts</a></li>
<li><a href="#elements-panel">Elements Panel</a><ul>
<li><a href="#style-tab">Style Tab</a></li>
</ul>
</li>
<li><a href="#console-panel">Console Panel</a><ul>
<li><a href="#console-settings">Console Settings</a></li>
<li><a href="#capture-default-eventlistener">capture default eventListener</a></li>
</ul>
</li>
<li><a href="#source-panel">Source Panel</a></li>
<li><a href="#network-panel">Network Panel</a></li>
<li><a href="#performance-panel">Performance Panel</a></li>
<li><a href="#simulation-devtools">Simulation DevTools</a></li>
<li><a href="#testing-devtools">Testing DevTools</a><ul>
<li><a href="#memory-panel">Memory Panel</a></li>
<li><a href="#js-profiler-panel">JS Profiler Panel</a></li>
<li><a href="#layer-panel">Layer Panel</a></li>
</ul>
</li>
<li><a href="#rendering-panel">Rendering Panel</a></li>
<li><a href="#more-tools">More Tools</a></li>
</ul>
</li>
<li><a href="#javascript-style-guide">JavaScript Style Guide</a><ul>
<li><a href="#naming-style">Naming Style</a></li>
<li><a href="#variable-style">Variable Style</a></li>
<li><a href="#object-style">Object Style</a></li>
<li><a href="#array-style">Array Style</a></li>
<li><a href="#destruct-style">Destruct Style</a></li>
<li><a href="#string-style">String Style</a></li>
<li><a href="#function-style">Function Style</a></li>
<li><a href="#arrow-function-style">Arrow Function Style</a></li>
<li><a href="#module-style">Module Style</a></li>
<li><a href="#iterator-and-generator-style">Iterator and Generator Style</a></li>
<li><a href="#expression-style">Expression Style</a></li>
<li><a href="#&#x6362;&#x884C;-style">&#x6362;&#x884C; Style</a></li>
<li><a href="#&#x7A7A;&#x683C;-style">&#x7A7A;&#x683C; Style</a></li>
<li><a href="#&#x6CE8;&#x91CA;-style">&#x6CE8;&#x91CA; Style</a><ul>
<li><a href="#&#x6A21;&#x5757;">&#x6A21;&#x5757;</a></li>
<li><a href="#&#x5BF9;&#x8C61;">&#x5BF9;&#x8C61;</a></li>
<li><a href="#&#x5C5E;&#x6027;">&#x5C5E;&#x6027;</a></li>
<li><a href="#&#x65B9;&#x6CD5;&#x51FD;&#x6570;">&#x65B9;&#x6CD5;/&#x51FD;&#x6570;</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#ssr">SSR</a></li>
<li><a href="#seo">SEO</a><ul>
<li><a href="#seo-tutorials">SEO Tutorials</a></li>
<li><a href="#seo-tips">SEO Tips</a><ul>
<li><a href="#seo-metadata">SEO Metadata</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#pwa">PWA</a><ul>
<li><a href="#service-worker">Service Worker</a><ul>
<li><a href="#sw-pros">SW Pros</a></li>
<li><a href="#sw-costs">SW Costs</a></li>
<li><a href="#sw-demo">SW Demo</a></li>
<li><a href="#sw-for-broken-images">SW for Broken Images</a></li>
</ul>
</li>
<li><a href="#pwa-library">PWA Library</a></li>
<li><a href="#pwa-tutorials">PWA Tutorials</a></li>
</ul>
</li>
<li><a href="#http2">HTTP/2</a></li>
<li><a href="#security">Security</a><ul>
<li><a href="#content-security-policy-level-3">Content Security Policy Level 3</a></li>
<li><a href="#trusted-types">Trusted Types</a></li>
<li><a href="#csrf">CSRF</a></li>
<li><a href="#object-property">Object Property</a></li>
<li><a href="#sandbox">Sandbox</a></li>
<li><a href="#user-fingerprint">User Fingerprint</a></li>
</ul>
</li>
<li><a href="#http-protocol">HTTP Protocol</a><ul>
<li><a href="#http-2">HTTP 2</a></li>
<li><a href="#http-3">HTTP 3</a></li>
</ul>
</li>
<li><a href="#devops">DevOps</a><ul>
<li><a href="#static-assets">Static Assets</a></li>
<li><a href="#ci-system">CI System</a></li>
<li><a href="#release-system">Release System</a></li>
<li><a href="#blue-green-deployment">Blue Green Deployment</a></li>
<li><a href="#rolling-update">Rolling Update</a></li>
<li><a href="#gray-release">Gray Release</a><ul>
<li><a href="#gray-release-introduction">Gray Release Introduction</a></li>
<li><a href="#gray-release-solution">Gray Release Solution</a></li>
<li><a href="#gray-release-performance">Gray Release Performance</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="modern-javascript"><a name="modern-javascript" class="anchor-navigation-ex-anchor" href="#modern-javascript"><i class="fa fa-link" aria-hidden="true"></i></a>1. Modern JavaScript</h2>
<h3 id="tc39"><a name="tc39" class="anchor-navigation-ex-anchor" href="#tc39"><i class="fa fa-link" aria-hidden="true"></i></a>1.1. TC39</h3>
<ul>
<li><a href="http://tc39.github.io/process-document" target="_blank">New Feature Process</a></li>
</ul>
<h3 id="babel"><a name="babel" class="anchor-navigation-ex-anchor" href="#babel"><i class="fa fa-link" aria-hidden="true"></i></a>1.2. Babel</h3>
<pre class="language-"><code class="lang-bash">babel example.js -o compiled.js
babel src -d lib -s
</code></pre>
<h4 id="babel-node"><a name="babel-node" class="anchor-navigation-ex-anchor" href="#babel-node"><i class="fa fa-link" aria-hidden="true"></i></a><a name="babel-node" class="plugin-anchor" href="#babel-node"><i class="fa fa-link" aria-hidden="true"></i></a>babel-node</h4>
<p>A read-eval-print loop(REPL) can replace node REPL.</p>
<h4 id="babel-core"><a name="babel-core" class="anchor-navigation-ex-anchor" href="#babel-core"><i class="fa fa-link" aria-hidden="true"></i></a><a name="babel-core" class="plugin-anchor" href="#babel-core"><i class="fa fa-link" aria-hidden="true"></i></a>babel-core</h4>
<p>&#x63D0;&#x4F9B; babel &#x8F6C;&#x7801; API</p>
<pre class="language-"><code class="lang-bash"><span class="token function">npm</span> <span class="token function">install</span> babel-core --save
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> babel <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;babel-core&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// &#x5B57;&#x7B26;&#x4E32;&#x8F6C;&#x7801;</span>
babel<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span><span class="token string">&apos;code();&apos;</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; { code, map, ast }</span>

<span class="token comment">// &#x6587;&#x4EF6;&#x8F6C;&#x7801;&#xFF08;&#x5F02;&#x6B65;&#xFF09;</span>
babel<span class="token punctuation">.</span><span class="token function">transformFile</span><span class="token punctuation">(</span><span class="token string">&apos;filename.js&apos;</span><span class="token punctuation">,</span> options<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  result<span class="token punctuation">;</span> <span class="token comment">// =&gt; { code, map, ast }</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// &#x6587;&#x4EF6;&#x8F6C;&#x7801;&#xFF08;&#x540C;&#x6B65;&#xFF09;</span>
babel<span class="token punctuation">.</span><span class="token function">transformFileSync</span><span class="token punctuation">(</span><span class="token string">&apos;filename.js&apos;</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; { code, map, ast }</span>

<span class="token comment">// Babel AST&#x8F6C;&#x7801;</span>
babel<span class="token punctuation">.</span><span class="token function">transformFromAst</span><span class="token punctuation">(</span>ast<span class="token punctuation">,</span> code<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; { code, map, ast }</span>
</code></pre>
<h4 id="codemod"><a name="codemod" class="anchor-navigation-ex-anchor" href="#codemod"><i class="fa fa-link" aria-hidden="true"></i></a><a name="codemod" class="plugin-anchor" href="#codemod"><i class="fa fa-link" aria-hidden="true"></i></a>Codemod</h4>
<p>Use Babel to refactor code,
like <a href="https://github.com/facebook/jscodeshift" target="_blank">jscodeshift</a>.</p>
<h3 id="variable"><a name="variable" class="anchor-navigation-ex-anchor" href="#variable"><i class="fa fa-link" aria-hidden="true"></i></a>1.3. Variable</h3>
<ul>
<li>&#x4E00;&#x65B9;&#x9762;&#x89C4;&#x5B9A;, var/function &#x58F0;&#x660E;&#x7684;&#x5168;&#x5C40;&#x53D8;&#x91CF;,
&#x4F9D;&#x65E7;&#x662F;&#x5168;&#x5C40;&#x5BF9;&#x8C61;&#x7684;&#x5C5E;&#x6027;, &#x610F;&#x5473;&#x7740;&#x4F1A;<code>Hoisting</code>.</li>
<li>&#x53E6;&#x4E00;&#x65B9;&#x9762;&#x89C4;&#x5B9A;, let/const/class &#x58F0;&#x660E;&#x7684;&#x5168;&#x5C40;&#x53D8;&#x91CF;,
&#x4E0D;&#x5C5E;&#x4E8E;&#x5168;&#x5C40;&#x5BF9;&#x8C61;&#x7684;&#x5C5E;&#x6027;, &#x610F;&#x5473;&#x7740;&#x4E0D;&#x4F1A;<code>Hoisting</code>.</li>
</ul>
<h4 id="let"><a name="let" class="anchor-navigation-ex-anchor" href="#let"><i class="fa fa-link" aria-hidden="true"></i></a><a name="let" class="plugin-anchor" href="#let"><i class="fa fa-link" aria-hidden="true"></i></a>let</h4>
<ul>
<li>&#x5757;&#x7EA7;&#x4F5C;&#x7528;&#x57DF;&#x5185;&#x5B9A;&#x4E49;&#x7684;&#x53D8;&#x91CF;/&#x51FD;&#x6570;&#xFF0C;&#x5728;&#x5757;&#x7EA7;&#x4F5C;&#x7528;&#x57DF;&#x5916; ReferenceError</li>
<li>&#x4E0D;&#x5B58;&#x5728;&#x53D8;&#x91CF;&#x63D0;&#x5347;, &#x5BFC;&#x81F4;&#x6682;&#x65F6;&#x6027;&#x6B7B;&#x533A; (Temporal Dead Zone)</li>
<li><code>let</code> variable in <code>for-loop</code> closure,
every closure for each loop
binds the block-scoped variable.</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

b <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">// temporal dead zone: throw reference error</span>

<span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="const"><a name="const" class="anchor-navigation-ex-anchor" href="#const"><i class="fa fa-link" aria-hidden="true"></i></a><a name="const" class="plugin-anchor" href="#const"><i class="fa fa-link" aria-hidden="true"></i></a>const</h4>
<ul>
<li>const &#x4E00;&#x65E6;&#x58F0;&#x660E;&#x53D8;&#x91CF;&#xFF0C;&#x5C31;&#x5FC5;&#x987B;&#x7ACB;&#x5373;&#x521D;&#x59CB;&#x5316;&#xFF0C;&#x4E0D;&#x80FD;&#x7559;&#x5230;&#x4EE5;&#x540E;&#x8D4B;&#x503C;</li>
<li>&#x5F15;&#x7528;&#x4E00;&#x4E2A;<code>Reference</code>&#x53D8;&#x91CF;&#x65F6;&#xFF0C;&#x53EA;&#x8868;&#x793A;&#x6B64;&#x53D8;&#x91CF;&#x5730;&#x5740;&#x4E0D;&#x53EF;&#x53D8;&#xFF0C;&#x4F46;&#x6240;&#x5F15;&#x7528;&#x53D8;&#x91CF;&#x7684;&#x503C;/&#x5C5E;&#x6027;&#x53EF;&#x53D8;
(xxx * const, &#x5373;<code>const</code>&#x6307;&#x9488;, &#x6307;&#x5411;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;)</li>
<li>&#x4E0D;&#x5B58;&#x5728;&#x53D8;&#x91CF;&#x63D0;&#x5347;, &#x5BFC;&#x81F4;&#x6682;&#x65F6;&#x6027;&#x6B7B;&#x533A; (Temporal Dead Zone)</li>
<li>&#x5757;&#x7EA7;&#x4F5C;&#x7528;&#x57DF;</li>
</ul>
<h3 id="destructuringpattern-matching"><a name="destructuringpattern-matching" class="anchor-navigation-ex-anchor" href="#destructuringpattern-matching"><i class="fa fa-link" aria-hidden="true"></i></a>1.4. Destructuring(Pattern Matching)</h3>
<ul>
<li><strong>&#x5EFA;&#x8BAE;&#x53EA;&#x8981;&#x6709;&#x53EF;&#x80FD;&#xFF0C;&#x5C31;&#x4E0D;&#x8981;&#x5728;&#x6A21;&#x5F0F;&#x4E2D;&#x653E;&#x7F6E;&#x5706;&#x62EC;&#x53F7;</strong></li>
<li>&#x8D4B;&#x503C;&#x8BED;&#x53E5;&#x7684;&#x975E;&#x6A21;&#x5F0F;&#x90E8;&#x5206;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5706;&#x62EC;&#x53F7;</li>
</ul>
<h4 id="&#x9ED8;&#x8BA4;&#x503C;"><a name="&#x9ED8;&#x8BA4;&#x503C;" class="anchor-navigation-ex-anchor" href="#&#x9ED8;&#x8BA4;&#x503C;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x9ED8;&#x8BA4;&#x503C;" class="plugin-anchor" href="#&#x9ED8;&#x8BA4;&#x503C;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x9ED8;&#x8BA4;&#x503C;</h4>
<ul>
<li>ES6 &#x5185;&#x90E8;&#x4F7F;&#x7528;&#x4E25;&#x683C;&#x76F8;&#x7B49;&#x8FD0;&#x7B97;&#x7B26;&#xFF08;===&#xFF09;&#xFF0C;&#x5224;&#x65AD;&#x4E00;&#x4E2A;&#x4F4D;&#x7F6E;&#x662F;&#x5426;&#x6709;&#x503C;&#x3002;&#x82E5;&#x6B64;&#x4F4D;&#x7F6E;&#x65E0;&#x503C;&#xFF0C;&#x5219;&#x4F7F;&#x7528;&#x9ED8;&#x8BA4;&#x503C;</li>
<li>&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#x6210;&#x5458;&#x4E0D;&#x4E25;&#x683C;&#x7B49;&#x4E8E; undefined&#xFF0C;&#x9ED8;&#x8BA4;&#x503C;&#x4E0D;&#x4F1A;&#x751F;&#x6548;</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> <span class="token punctuation">[</span>x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">undefined</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
x<span class="token punctuation">;</span> <span class="token comment">// 1</span>

<span class="token keyword">const</span> <span class="token punctuation">[</span>x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">null</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
x<span class="token punctuation">;</span> <span class="token comment">// null</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token keyword">let</span> <span class="token punctuation">[</span>x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// x=1; y=1</span>
<span class="token keyword">let</span> <span class="token punctuation">[</span>x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// x=2; y=2</span>
<span class="token keyword">let</span> <span class="token punctuation">[</span>x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// x=1; y=2</span>
<span class="token keyword">let</span> <span class="token punctuation">[</span>x <span class="token operator">=</span> y<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// ReferenceError</span>
</code></pre>
<h4 id="sample"><a name="sample" class="anchor-navigation-ex-anchor" href="#sample"><i class="fa fa-link" aria-hidden="true"></i></a><a name="sample" class="plugin-anchor" href="#sample"><i class="fa fa-link" aria-hidden="true"></i></a>Sample</h4>
<h5 id="swap"><a name="swap" class="anchor-navigation-ex-anchor" href="#swap"><i class="fa fa-link" aria-hidden="true"></i></a><a name="swap" class="plugin-anchor" href="#swap"><i class="fa fa-link" aria-hidden="true"></i></a>swap</h5>
<pre class="language-"><code class="lang-js"><span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>y<span class="token punctuation">,</span> x<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
<h5 id="&#x7B80;&#x5316;&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570;&#x4E0E;&#x8FD4;&#x56DE;&#x503C;"><a name="&#x7B80;&#x5316;&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570;&#x4E0E;&#x8FD4;&#x56DE;&#x503C;" class="anchor-navigation-ex-anchor" href="#&#x7B80;&#x5316;&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570;&#x4E0E;&#x8FD4;&#x56DE;&#x503C;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x7B80;&#x5316;&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570;&#x4E0E;&#x8FD4;&#x56DE;&#x503C;" class="plugin-anchor" href="#&#x7B80;&#x5316;&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570;&#x4E0E;&#x8FD4;&#x56DE;&#x503C;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x7B80;&#x5316;&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570;&#x4E0E;&#x8FD4;&#x56DE;&#x503C;</h5>
<ul>
<li>&#x53EF;&#x7528;&#x4E8E;&#x5DE5;&#x5382;(factory)/&#x8BBE;&#x7F6E;(options)&#x6A21;&#x5F0F;: &#x4F20;&#x53C2;&#x4E00;&#x822C;&#x4E3A; options &#x5BF9;&#x8C61;&#xFF0C;&#x5177;&#x6709;&#x56FA;&#x5B9A;&#x7684;&#x5C5E;&#x6027;&#x540D;</li>
<li>&#x4E00;&#x6B21;&#x6027;&#x5B9A;&#x4E49;&#x591A;&#x4E2A;&#x53C2;&#x6570;</li>
<li>&#x4E00;&#x6B21;&#x6027;&#x5B9A;&#x4E49;&#x591A;&#x4E2A;&#x53C2;&#x6570;&#x7684;&#x9ED8;&#x8BA4;&#x503C;</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// &#x53C2;&#x6570;&#x662F;&#x4E00;&#x7EC4;&#x6709;&#x6B21;&#x5E8F;&#x7684;&#x503C;</span>
<span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">// &#x53C2;&#x6570;&#x662F;&#x4E00;&#x7EC4;&#x65E0;&#x6B21;&#x5E8F;&#x7684;&#x503C;</span>
<span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">{</span>z<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> x<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// &#x53EF;&#x7701;&#x7565; var foo = config.foo || &apos;default foo&apos;;</span>
jQuery<span class="token punctuation">.</span><span class="token function-variable function">ajax</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  async <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token function-variable function">beforeSend</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  cache <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token function-variable function">complete</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  crossDomain <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  global <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token comment">// ... more config</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ... do stuff</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token comment">// &#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;</span>
<span class="token keyword">function</span> <span class="token function">example</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">example</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// &#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;</span>
<span class="token keyword">function</span> <span class="token function">example</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    foo<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    bar<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> foo<span class="token punctuation">,</span> bar <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">example</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h5 id="&#x89E3;&#x6790;-json-&#x5BF9;&#x8C61;"><a name="&#x89E3;&#x6790;-json-&#x5BF9;&#x8C61;" class="anchor-navigation-ex-anchor" href="#&#x89E3;&#x6790;-json-&#x5BF9;&#x8C61;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x89E3;&#x6790;-json-&#x5BF9;&#x8C61;" class="plugin-anchor" href="#&#x89E3;&#x6790;-json-&#x5BF9;&#x8C61;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x89E3;&#x6790; JSON &#x5BF9;&#x8C61;</h5>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> jsonData <span class="token operator">=</span> <span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
  status<span class="token operator">:</span> <span class="token string">&apos;OK&apos;</span><span class="token punctuation">,</span>
  data<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">867</span><span class="token punctuation">,</span> <span class="token number">5309</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> id<span class="token punctuation">,</span> status<span class="token punctuation">,</span> data<span class="token operator">:</span> number <span class="token punctuation">}</span> <span class="token operator">=</span> jsonData<span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> status<span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 42, &quot;OK&quot;, [867, 5309]</span>
</code></pre>
<h5 id="&#x904D;&#x5386;-maplist"><a name="&#x904D;&#x5386;-maplist" class="anchor-navigation-ex-anchor" href="#&#x904D;&#x5386;-maplist"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x904D;&#x5386;-maplist" class="plugin-anchor" href="#&#x904D;&#x5386;-maplist"><i class="fa fa-link" aria-hidden="true"></i></a>&#x904D;&#x5386; map/list</h5>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&apos;first&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;hello&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&apos;second&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;world&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> value<span class="token punctuation">]</span> <span class="token keyword">of</span> map<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key <span class="token operator">+</span> <span class="token string">&apos; is &apos;</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// first is hello</span>
<span class="token comment">// second is world</span>

<span class="token comment">// &#x83B7;&#x53D6;&#x952E;&#x540D;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token keyword">of</span> map<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token comment">// &#x83B7;&#x53D6;&#x952E;&#x503C;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> value<span class="token punctuation">]</span> <span class="token keyword">of</span> map<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre>
<h5 id="&#x52A0;&#x8F7D;&#x7279;&#x5B9A;&#x6A21;&#x5757;"><a name="&#x52A0;&#x8F7D;&#x7279;&#x5B9A;&#x6A21;&#x5757;" class="anchor-navigation-ex-anchor" href="#&#x52A0;&#x8F7D;&#x7279;&#x5B9A;&#x6A21;&#x5757;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x52A0;&#x8F7D;&#x7279;&#x5B9A;&#x6A21;&#x5757;" class="plugin-anchor" href="#&#x52A0;&#x8F7D;&#x7279;&#x5B9A;&#x6A21;&#x5757;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x52A0;&#x8F7D;&#x7279;&#x5B9A;&#x6A21;&#x5757;</h5>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> SourceMapConsumer<span class="token punctuation">,</span> SourceNode <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;source-map&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="array-iterator-style-matching"><a name="array-iterator-style-matching" class="anchor-navigation-ex-anchor" href="#array-iterator-style-matching"><i class="fa fa-link" aria-hidden="true"></i></a><a name="array-iterator-style-matching" class="plugin-anchor" href="#array-iterator-style-matching"><i class="fa fa-link" aria-hidden="true"></i></a>Array Iterator Style Matching</h4>
<p>&#x7B49;&#x53F7;&#x53F3;&#x8FB9;&#x5FC5;&#x987B;&#x4E3A;&#x6570;&#x7EC4;&#x7B49;&#x5B9E;&#x73B0;&#x4E86; Iterator &#x63A5;&#x53E3;&#x7684;&#x5BF9;&#x8C61;,&#x5426;&#x5219;&#x62A5;&#x9519;</p>
<ul>
<li>Array</li>
<li>Set</li>
<li>Generator &#x51FD;&#x6570;</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> <span class="token punctuation">[</span>foo<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>bar<span class="token punctuation">]</span><span class="token punctuation">,</span> baz<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
foo<span class="token punctuation">;</span> <span class="token comment">// 1</span>
bar<span class="token punctuation">;</span> <span class="token comment">// 2</span>
baz<span class="token punctuation">;</span> <span class="token comment">// 3</span>

<span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">,</span> third<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&apos;foo&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;bar&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;baz&apos;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
third<span class="token punctuation">;</span> <span class="token comment">// &quot;baz&quot;</span>

<span class="token keyword">const</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span> <span class="token punctuation">,</span> y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
x<span class="token punctuation">;</span> <span class="token comment">// 1</span>
y<span class="token punctuation">;</span> <span class="token comment">// 3</span>

<span class="token keyword">const</span> <span class="token punctuation">[</span>head<span class="token punctuation">,</span> <span class="token operator">...</span>tail<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
head<span class="token punctuation">;</span> <span class="token comment">// 1</span>
tail<span class="token punctuation">;</span> <span class="token comment">// [2, 3, 4]</span>

<span class="token keyword">const</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token operator">...</span>z<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&apos;a&apos;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
x<span class="token punctuation">;</span> <span class="token comment">// &quot;a&quot;</span>
y<span class="token punctuation">;</span> <span class="token comment">// undefined</span>
z<span class="token punctuation">;</span> <span class="token comment">// []</span>

<span class="token comment">// Generator &#x51FD;&#x6570;</span>
<span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">fibs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">yield</span> a<span class="token punctuation">;</span>
    <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>b<span class="token punctuation">,</span> a <span class="token operator">+</span> b<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token punctuation">[</span>first<span class="token punctuation">,</span> second<span class="token punctuation">,</span> third<span class="token punctuation">,</span> fourth<span class="token punctuation">,</span> fifth<span class="token punctuation">,</span> sixth<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">fibs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
sixth<span class="token punctuation">;</span> <span class="token comment">// 5</span>
</code></pre>
<h4 id="object-style-matching"><a name="object-style-matching" class="anchor-navigation-ex-anchor" href="#object-style-matching"><i class="fa fa-link" aria-hidden="true"></i></a><a name="object-style-matching" class="plugin-anchor" href="#object-style-matching"><i class="fa fa-link" aria-hidden="true"></i></a>Object Style Matching</h4>
<ul>
<li>&#x771F;&#x6B63;&#x88AB;&#x8D4B;&#x503C;&#x7684;&#x662F;&#x540E;&#x8005;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x524D;&#x8005;</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> pattern<span class="token operator">:</span> variable <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span> key<span class="token operator">:</span> value <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<ul>
<li>&#x89E3;&#x6784;&#x8D4B;&#x503C;&#x7684;&#x89C4;&#x5219;: &#x53EA;&#x8981;&#x7B49;&#x53F7;&#x53F3;&#x8FB9;&#x7684;&#x503C;&#x4E0D;&#x662F;&#x5BF9;&#x8C61;&#xFF0C;&#x5C31;&#x5148;&#x5C06;&#x5176;&#x8F6C;&#x4E3A;&#x5BF9;&#x8C61;</li>
<li>undefined/null &#x65E0;&#x6CD5;&#x8F6C;&#x5316;&#x4E3A;&#x5BF9;&#x8C61;</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> prop<span class="token operator">:</span> x <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span> <span class="token comment">// TypeError</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> prop<span class="token operator">:</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// TypeError</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> bar<span class="token punctuation">,</span> foo <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span> foo<span class="token operator">:</span> <span class="token string">&apos;aaa&apos;</span><span class="token punctuation">,</span> bar<span class="token operator">:</span> <span class="token string">&apos;bbb&apos;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
foo<span class="token punctuation">;</span> <span class="token comment">// &quot;aaa&quot;</span>
bar<span class="token punctuation">;</span> <span class="token comment">// &quot;bbb&quot;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> foo<span class="token operator">:</span> foo<span class="token punctuation">,</span> bar<span class="token operator">:</span> bar <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span> foo<span class="token operator">:</span> <span class="token string">&apos;aaa&apos;</span><span class="token punctuation">,</span> bar<span class="token operator">:</span> <span class="token string">&apos;bbb&apos;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> baz <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span> foo<span class="token operator">:</span> <span class="token string">&apos;aaa&apos;</span><span class="token punctuation">,</span> bar<span class="token operator">:</span> <span class="token string">&apos;bbb&apos;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
baz<span class="token punctuation">;</span> <span class="token comment">// undefined</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> foo<span class="token operator">:</span> baz <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span> foo<span class="token operator">:</span> <span class="token string">&apos;aaa&apos;</span><span class="token punctuation">,</span> bar<span class="token operator">:</span> <span class="token string">&apos;bbb&apos;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
baz<span class="token punctuation">;</span> <span class="token comment">// &quot;aaa&quot;</span>

<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> first<span class="token operator">:</span> <span class="token string">&apos;hello&apos;</span><span class="token punctuation">,</span> last<span class="token operator">:</span> <span class="token string">&apos;world&apos;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> first<span class="token operator">:</span> f<span class="token punctuation">,</span> last<span class="token operator">:</span> l <span class="token punctuation">}</span> <span class="token operator">=</span> obj<span class="token punctuation">;</span>
f<span class="token punctuation">;</span> <span class="token comment">// &apos;hello&apos;</span>
l<span class="token punctuation">;</span> <span class="token comment">// &apos;world&apos;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> log<span class="token punctuation">,</span> sin<span class="token punctuation">,</span> cos <span class="token punctuation">}</span> <span class="token operator">=</span> Math<span class="token punctuation">;</span>
</code></pre>
<h4 id="string-style-matching"><a name="string-style-matching" class="anchor-navigation-ex-anchor" href="#string-style-matching"><i class="fa fa-link" aria-hidden="true"></i></a><a name="string-style-matching" class="plugin-anchor" href="#string-style-matching"><i class="fa fa-link" aria-hidden="true"></i></a>String Style Matching</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> e<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&apos;hello&apos;</span><span class="token punctuation">;</span>
a<span class="token punctuation">;</span> <span class="token comment">// &quot;h&quot;</span>
b<span class="token punctuation">;</span> <span class="token comment">// &quot;e&quot;</span>
c<span class="token punctuation">;</span> <span class="token comment">// &quot;l&quot;</span>
d<span class="token punctuation">;</span> <span class="token comment">// &quot;l&quot;</span>
e<span class="token punctuation">;</span> <span class="token comment">// &quot;o&quot;</span>

<span class="token keyword">let</span> <span class="token punctuation">{</span> length<span class="token operator">:</span> len <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token string">&apos;hello&apos;</span><span class="token punctuation">;</span>
len<span class="token punctuation">;</span> <span class="token comment">// 5</span>
</code></pre>
<h4 id="numberboolean-style-matching"><a name="numberboolean-style-matching" class="anchor-navigation-ex-anchor" href="#numberboolean-style-matching"><i class="fa fa-link" aria-hidden="true"></i></a><a name="numberboolean-style-matching" class="plugin-anchor" href="#numberboolean-style-matching"><i class="fa fa-link" aria-hidden="true"></i></a>Number/Boolean Style Matching</h4>
<p>number/boolean &#x4F1A;&#x8F6C;&#x5316;&#x6210;&#x5BF9;&#x8C61;</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">let</span> <span class="token punctuation">{</span> toString<span class="token operator">:</span> s <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span>
s <span class="token operator">===</span> <span class="token class-name">Number</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>toString<span class="token punctuation">;</span> <span class="token comment">// true</span>

<span class="token keyword">let</span> <span class="token punctuation">{</span> toString<span class="token operator">:</span> s <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
s <span class="token operator">===</span> <span class="token class-name">Boolean</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>toString<span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre>
<h4 id="function-arguments-style-matching"><a name="function-arguments-style-matching" class="anchor-navigation-ex-anchor" href="#function-arguments-style-matching"><i class="fa fa-link" aria-hidden="true"></i></a><a name="function-arguments-style-matching" class="plugin-anchor" href="#function-arguments-style-matching"><i class="fa fa-link" aria-hidden="true"></i></a>Function Arguments Style Matching</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 3</span>
  <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// [ 3, 7 ]</span>

<span class="token keyword">function</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">move</span><span class="token punctuation">(</span><span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">8</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [3, 8]</span>
<span class="token function">move</span><span class="token punctuation">(</span><span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [3, 0]</span>
<span class="token function">move</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [0, 0]</span>
<span class="token function">move</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [0, 0]</span>

<span class="token comment">// &#x4E25;&#x683C;&#x4E3A; undefined &#x65F6;&#xFF0C;&#x89E6;&#x53D1;&#x9ED8;&#x8BA4;&#x503C;&#x8BBE;&#x7F6E;</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token string">&apos;yes&apos;</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// [ 1, &apos;yes&apos;, 3 ]</span>
</code></pre>
<h3 id="string"><a name="string" class="anchor-navigation-ex-anchor" href="#string"><i class="fa fa-link" aria-hidden="true"></i></a>1.5. String</h3>
<pre class="language-"><code class="lang-js"><span class="token string">&apos;z&apos;</span> <span class="token operator">===</span> <span class="token string">&apos;z&apos;</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token string">&apos;\172&apos;</span> <span class="token operator">===</span> <span class="token string">&apos;z&apos;</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token string">&apos;\x7A&apos;</span> <span class="token operator">===</span> <span class="token string">&apos;z&apos;</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token string">&apos;\u007A&apos;</span> <span class="token operator">===</span> <span class="token string">&apos;z&apos;</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token string">&apos;\u{7A}&apos;</span> <span class="token operator">===</span> <span class="token string">&apos;z&apos;</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre>
<h4 id="methods"><a name="methods" class="anchor-navigation-ex-anchor" href="#methods"><i class="fa fa-link" aria-hidden="true"></i></a><a name="methods" class="plugin-anchor" href="#methods"><i class="fa fa-link" aria-hidden="true"></i></a>Methods</h4>
<ul>
<li>string.codePointAt(index): &#x6B63;&#x786E;&#x5904;&#x7406; 4 &#x5B57;&#x8282;&#x5B58;&#x50A8;&#x5B57;&#x7B26;</li>
<li>string.fromCodePoint(codePoint)</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span> <span class="token function">is32Bit</span><span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">codePointAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0xffff</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

String<span class="token punctuation">.</span><span class="token function">fromCodePoint</span><span class="token punctuation">(</span><span class="token number">0x78</span><span class="token punctuation">,</span> <span class="token number">0x1f680</span><span class="token punctuation">,</span> <span class="token number">0x79</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&apos;x\uD83D\uDE80y&apos;</span><span class="token punctuation">;</span>
<span class="token comment">// true</span>
</code></pre>
<ul>
<li>string.includes(substr)/startsWith(substr)/endsWith(substr)</li>
<li>&#x4F7F;&#x7528;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570; n &#x65F6;&#xFF0C;endsWith &#x9488;&#x5BF9;&#x524D; n &#x4E2A;&#x5B57;&#x7B26;&#xFF0C;&#x5176;&#x4ED6;&#x4E24;&#x4E2A;&#x65B9;&#x6CD5;&#x9488;&#x5BF9;&#x4ECE;&#x7B2C; n &#x4E2A;&#x4F4D;&#x7F6E;&#x76F4;&#x5230;&#x5B57;&#x7B26;&#x4E32;&#x7ED3;&#x675F;</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> s <span class="token operator">=</span> <span class="token string">&apos;Hello world!&apos;</span><span class="token punctuation">;</span>

s<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&apos;world&apos;</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
s<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">&apos;Hello&apos;</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
s<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&apos;Hello&apos;</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
</code></pre>
<ul>
<li>repeat(times)</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token string">&apos;hello&apos;</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;hellohello&quot;</span>
<span class="token string">&apos;na&apos;</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">2.9</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;nana&quot;</span>

<span class="token string">&apos;na&apos;</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.9</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;&quot;</span>
<span class="token string">&apos;na&apos;</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// RangeError</span>

<span class="token string">&apos;na&apos;</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;&quot;</span>
<span class="token string">&apos;na&apos;</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">Infinity</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// RangeError</span>

<span class="token string">&apos;na&apos;</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token string">&apos;na&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;&quot;</span>
<span class="token string">&apos;na&apos;</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token string">&apos;3&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;nanana&quot;</span>
</code></pre>
<ul>
<li>padStart/padEnd(len, paddingStr)</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token string">&apos;1&apos;</span><span class="token punctuation">.</span><span class="token function">padStart</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&apos;0&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;0000000001&quot;</span>
<span class="token string">&apos;12&apos;</span><span class="token punctuation">.</span><span class="token function">padStart</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&apos;0&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;0000000012&quot;</span>
<span class="token string">&apos;123456&apos;</span><span class="token punctuation">.</span><span class="token function">padStart</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&apos;0&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;0000123456&quot;</span>

<span class="token string">&apos;12&apos;</span><span class="token punctuation">.</span><span class="token function">padStart</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&apos;YYYY-MM-DD&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;YYYY-MM-12&quot;</span>
<span class="token string">&apos;09-12&apos;</span><span class="token punctuation">.</span><span class="token function">padStart</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&apos;YYYY-MM-DD&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;YYYY-09-12&quot;</span>
</code></pre>
<h4 id="template-string"><a name="template-string" class="anchor-navigation-ex-anchor" href="#template-string"><i class="fa fa-link" aria-hidden="true"></i></a><a name="template-string" class="plugin-anchor" href="#template-string"><i class="fa fa-link" aria-hidden="true"></i></a>Template String</h4>
<p><code>str</code> &#x8868;&#x793A;&#x6A21;&#x677F;&#x5B57;&#x7B26;&#x4E32;</p>
<pre class="language-"><code class="lang-js"><span class="token comment">// &#x666E;&#x901A;&#x5B57;&#x7B26;&#x4E32;</span>
<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">In JavaScript &apos;\n&apos; is a line-feed.</span><span class="token template-punctuation string">`</span></span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\`Yo\` World!</span><span class="token template-punctuation string">`</span></span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">In JavaScript this is // &#x591A;&#x884C;&#x5B57;&#x7B26;&#x4E32;
 not legal.</span><span class="token template-punctuation string">`</span></span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>
  x <span class="token comment">// &#x5F15;&#x7528;&#x53D8;&#x91CF;</span>
<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> + </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>y <span class="token operator">*</span> <span class="token number">2</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>x <span class="token operator">+</span> y <span class="token operator">*</span> <span class="token number">2</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>obj<span class="token punctuation">.</span>x <span class="token operator">+</span> obj<span class="token punctuation">.</span>y<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">foo </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>
  <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// &#x8C03;&#x7528;&#x51FD;&#x6570;</span>
<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> bar</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
</code></pre>
<h4 id="tagged-templates"><a name="tagged-templates" class="anchor-navigation-ex-anchor" href="#tagged-templates"><i class="fa fa-link" aria-hidden="true"></i></a><a name="tagged-templates" class="plugin-anchor" href="#tagged-templates"><i class="fa fa-link" aria-hidden="true"></i></a>Tagged Templates</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> <span class="token function-variable function">boldify</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">parts<span class="token punctuation">,</span> <span class="token operator">...</span>insertedParts</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> parts
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">s<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">===</span> insertedParts<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token keyword">return</span> s<span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>s<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;strong&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>insertedParts<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/strong&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&apos;&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">&apos;Jamon Holmgren&apos;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>boldify<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hi, my name is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; &quot;Hi, my name is &lt;strong&gt;Jamon Holmgren&lt;/strong&gt;!&quot;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span> <span class="token function">template</span><span class="token punctuation">(</span><span class="token parameter">strings<span class="token punctuation">,</span> <span class="token operator">...</span>keys</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>values</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> dict <span class="token operator">=</span> values<span class="token punctuation">[</span>values<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token punctuation">[</span>strings<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    keys<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> value <span class="token operator">=</span> Number<span class="token punctuation">.</span><span class="token function">isInteger</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">?</span> values<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">:</span> dict<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
      result<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> strings<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&apos;&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> t1Closure <span class="token operator">=</span> template<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token number">0</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token number">0</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token function">t1Closure</span><span class="token punctuation">(</span><span class="token string">&apos;Y&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;A&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;YAY!&quot;</span>
<span class="token keyword">const</span> t2Closure <span class="token operator">=</span> template<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token number">0</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token string">&apos;foo&apos;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token function">t2Closure</span><span class="token punctuation">(</span><span class="token string">&apos;Hello&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> foo<span class="token operator">:</span> <span class="token string">&apos;World&apos;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;Hello World!&quot;</span>
</code></pre>
<ul>
<li>&#x7F16;&#x8BD1;&#x6A21;&#x677F;(&#x5C0F;&#x578B;&#x6A21;&#x677F;&#x5F15;&#x64CE;)</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span> <span class="token function">compile</span><span class="token punctuation">(</span><span class="token parameter">template</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> evalExpr <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&lt;%=(.+?)%&gt;</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> expr <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&lt;%([\s\S]+?)%&gt;</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">;</span>

  template <span class="token operator">=</span> template
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>evalExpr<span class="token punctuation">,</span> <span class="token string">&apos;`); \n  echo( $1 ); \n  echo(`&apos;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>expr<span class="token punctuation">,</span> <span class="token string">&apos;`); \n $1 \n  echo(`&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  template <span class="token operator">=</span> <span class="token string">&apos;echo(`&apos;</span> <span class="token operator">+</span> template <span class="token operator">+</span> <span class="token string">&apos;`);&apos;</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> script <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">(function parse(data){
      var output = &quot;&quot;;

      function echo(html){
        output += html;
      }

      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>template<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">

      return output;
    })</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> script<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> template <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
&lt;ul&gt;
  &lt;% for(var i=0; i &lt; data.supplies.length; i++) { %&gt;
    &lt;li&gt;&lt;%= data.supplies[i] %&gt;&lt;/li&gt;
  &lt;% } %&gt;
&lt;/ul&gt;
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> parse <span class="token operator">=</span> <span class="token function">compile</span><span class="token punctuation">(</span>template<span class="token punctuation">)</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">{</span> supplies<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&apos;broom&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;mop&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;cleaner&apos;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; &lt;ul&gt;</span>
<span class="token comment">// =&gt;   &lt;li&gt;broom&lt;/li&gt;</span>
<span class="token comment">// =&gt;   &lt;li&gt;mop&lt;/li&gt;</span>
<span class="token comment">// =&gt;   &lt;li&gt;cleaner&lt;/li&gt;</span>
<span class="token comment">// =&gt; &lt;/ul&gt;</span>

<span class="token comment">// &#x4E0B;&#x9762;&#x7684;hashTemplate&#x51FD;&#x6570;</span>
<span class="token comment">// &#x662F;&#x4E00;&#x4E2A;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x6A21;&#x677F;&#x5904;&#x7406;&#x51FD;&#x6570;</span>
<span class="token keyword">const</span> libraryHtml <span class="token operator">=</span> hashTemplate<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  &lt;ul&gt;
    #for book in </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>myBooks<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
      &lt;li&gt;&lt;i&gt;#{book.title}&lt;/i&gt; by #{book.author}&lt;/li&gt;
    #end
  &lt;/ul&gt;
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
</code></pre>
<ul>
<li>&#x56FD;&#x9645;&#x5316;&#x5904;&#x7406;</li>
</ul>
<pre class="language-"><code class="lang-js">i18n<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Welcome to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>siteName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, you are visitor number </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>visitorNumber<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token comment">// &quot;&#x6B22;&#x8FCE;&#x8BBF;&#x95EE;xxx&#xFF0C;&#x60A8;&#x662F;&#x7B2C;xxxx&#x4F4D;&#x8BBF;&#x95EE;&#x8005;&#xFF01;&quot;</span>
</code></pre>
<ul>
<li>XSS &#x653B;&#x51FB;</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> message <span class="token operator">=</span> SaferHTML<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;p&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>sender<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> has sent you a message.&lt;/p&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">SaferHTML</span><span class="token punctuation">(</span><span class="token parameter">templateData</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> s <span class="token operator">=</span> templateData<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> arg <span class="token operator">=</span> <span class="token function">String</span><span class="token punctuation">(</span>arguments<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Escape special characters in the substitution.</span>
    s <span class="token operator">+=</span> arg<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&amp;</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&apos;&amp;amp;&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&lt;</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&apos;&amp;lt;&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&gt;</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&apos;&amp;gt;&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Don&apos;t escape special characters in the template.</span>
    s <span class="token operator">+=</span> templateData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<ul>
<li>&#x8FD0;&#x884C;&#x4EE3;&#x7801;</li>
</ul>
<pre class="language-"><code class="lang-js">jsx<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  &lt;div&gt;
    &lt;input
      ref=&apos;input&apos;
      onChange=&apos;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleChange<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&apos;
      defaultValue=&apos;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&apos; /&gt;
      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
   &lt;/div&gt;
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

java<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
class HelloWorldApp {
  public static void main(String[] args) {
    System.out.println(&#x201C;Hello World!&#x201D;); // Display the string.
  }
}
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
HelloWorldApp<span class="token punctuation">.</span><span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="regexp"><a name="regexp" class="anchor-navigation-ex-anchor" href="#regexp"><i class="fa fa-link" aria-hidden="true"></i></a>1.6. RegExp</h3>
<ul>
<li>u &#x4FEE;&#x9970;&#x7B26;</li>
<li>y (&#x7C98;&#x8FDE;&#x5168;&#x5C40;&#x7B26;) &#x4FEE;&#x9970;&#x7B26;&#x53F7;&#x9690;&#x542B;&#x4E86;&#x5934;&#x90E8;&#x5339;&#x914D;&#x7684;&#x6807;&#x5FD7;</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span> <span class="token function">codePointLength</span><span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> result <span class="token operator">=</span> text<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\s\S]</span><span class="token regex-delimiter">/</span><span class="token regex-flags">gu</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> result <span class="token operator">?</span> result<span class="token punctuation">.</span>length <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> s <span class="token operator">=</span> <span class="token string">&apos;&#x20BB7;&#x20BB7;&apos;</span><span class="token punctuation">;</span>

s<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token comment">// 4</span>
<span class="token function">codePointLength</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
</code></pre>
<h4 id="regexp-group"><a name="regexp-group" class="anchor-navigation-ex-anchor" href="#regexp-group"><i class="fa fa-link" aria-hidden="true"></i></a><a name="regexp-group" class="plugin-anchor" href="#regexp-group"><i class="fa fa-link" aria-hidden="true"></i></a>RegExp Group</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> string <span class="token operator">=</span> <span class="token string">&apos;Favorite GitHub Repos: tc39/ecma262 v8/v8.dev&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> regex <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\b(?&lt;owner&gt;[a-z0-9]+)\/(?&lt;repo&gt;[a-z0-9\.]+)\b</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> match <span class="token keyword">of</span> string<span class="token punctuation">.</span><span class="token function">matchAll</span><span class="token punctuation">(</span>regex<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>match<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> at </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>match<span class="token punctuation">.</span>index<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> with &apos;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>match<span class="token punctuation">.</span>input<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&apos;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">owner: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>match<span class="token punctuation">.</span>groups<span class="token punctuation">.</span>owner<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">repo: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>match<span class="token punctuation">.</span>groups<span class="token punctuation">.</span>repo<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="number"><a name="number" class="anchor-navigation-ex-anchor" href="#number"><i class="fa fa-link" aria-hidden="true"></i></a>1.7. Number</h3>
<ul>
<li>0bxxx/0Bxxx</li>
<li>0oxxx/0Oxxx</li>
<li>Number.isFinite()/isNaN()/parseInt()/parseFloat()/isInteger()/isSafeInteger()</li>
<li>Number.EPSILON/<code>MAX_SAFE_INTEGER</code>/<code>MIN_SAFE_INTEGER</code></li>
<li>** &#x6307;&#x6570;&#x8FD0;&#x7B97;&#x7B26;</li>
<li>BigInt</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token number">2172141653</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token number">15346349309</span><span class="token punctuation">;</span>
a <span class="token operator">*</span> b<span class="token punctuation">;</span>
<span class="token comment">// =&gt; 33334444555566670000</span>
<span class="token function">BigInt</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">BigInt</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; 33334444555566667777n</span>
</code></pre>
<h3 id="internationalization"><a name="internationalization" class="anchor-navigation-ex-anchor" href="#internationalization"><i class="fa fa-link" aria-hidden="true"></i></a>1.8. Internationalization</h3>
<h4 id="number-intl"><a name="number-intl" class="anchor-navigation-ex-anchor" href="#number-intl"><i class="fa fa-link" aria-hidden="true"></i></a><a name="number-intl" class="plugin-anchor" href="#number-intl"><i class="fa fa-link" aria-hidden="true"></i></a>Number Intl</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> nfFrench <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intl<span class="token punctuation">.</span>NumberFormat</span><span class="token punctuation">(</span><span class="token string">&apos;fr&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
nf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">12345678901234567890n</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; 12 345 678 901 234 567 890</span>
</code></pre>
<h4 id="string-intl"><a name="string-intl" class="anchor-navigation-ex-anchor" href="#string-intl"><i class="fa fa-link" aria-hidden="true"></i></a><a name="string-intl" class="plugin-anchor" href="#string-intl"><i class="fa fa-link" aria-hidden="true"></i></a>String Intl</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> lfEnglish <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intl<span class="token punctuation">.</span>ListFormat</span><span class="token punctuation">(</span><span class="token string">&apos;en&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// const lfEnglish = new Intl.ListFormat(&apos;en&apos;, { type: &apos;disjunction&apos; }); =&gt; &apos;or&apos;</span>

lfEnglish<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&apos;Ada&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;Grace&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;Ida&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; &apos;Ada, Grace and Ida&apos;</span>
</code></pre>
<h4 id="time-intl"><a name="time-intl" class="anchor-navigation-ex-anchor" href="#time-intl"><i class="fa fa-link" aria-hidden="true"></i></a><a name="time-intl" class="plugin-anchor" href="#time-intl"><i class="fa fa-link" aria-hidden="true"></i></a>Time Intl</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> rtfEnglish <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intl<span class="token punctuation">.</span>RelativeTimeFormat</span><span class="token punctuation">(</span><span class="token string">&apos;en&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> numeric<span class="token operator">:</span> <span class="token string">&apos;auto&apos;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&apos;day&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &apos;yesterday&apos;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&apos;day&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &apos;today&apos;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&apos;day&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &apos;tomorrow&apos;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&apos;week&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &apos;last week&apos;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&apos;week&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &apos;this week&apos;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&apos;week&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &apos;next week&apos;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> dtfEnglish <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intl<span class="token punctuation">.</span>DateTimeFormat</span><span class="token punctuation">(</span><span class="token string">&apos;en&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  year<span class="token operator">:</span> <span class="token string">&apos;numeric&apos;</span><span class="token punctuation">,</span>
  month<span class="token operator">:</span> <span class="token string">&apos;long&apos;</span><span class="token punctuation">,</span>
  day<span class="token operator">:</span> <span class="token string">&apos;numeric&apos;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

dtfEnglish<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; &apos;May 7, 2019&apos;</span>
dtfEnglish<span class="token punctuation">.</span><span class="token function">formatRange</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; &apos;May 7 - 9, 2019&apos;</span>
</code></pre>
<h3 id="array"><a name="array" class="anchor-navigation-ex-anchor" href="#array"><i class="fa fa-link" aria-hidden="true"></i></a>1.9. Array</h3>
<pre class="language-"><code class="lang-js"><span class="token punctuation">[</span><span class="token operator">...</span><span class="token function">Array</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; [0, 1, 2, 3, 4]</span>
</code></pre>
<h4 id="arrayincludes"><a name="arrayincludes" class="anchor-navigation-ex-anchor" href="#arrayincludes"><i class="fa fa-link" aria-hidden="true"></i></a><a name="arrayincludes" class="plugin-anchor" href="#arrayincludes"><i class="fa fa-link" aria-hidden="true"></i></a>Array.includes</h4>
<p>no more <code>indexOf() &gt; -1</code></p>
<h4 id="arrayfrom"><a name="arrayfrom" class="anchor-navigation-ex-anchor" href="#arrayfrom"><i class="fa fa-link" aria-hidden="true"></i></a><a name="arrayfrom" class="plugin-anchor" href="#arrayfrom"><i class="fa fa-link" aria-hidden="true"></i></a>Array.from</h4>
<p>&#x5F3A;&#x5927;&#x7684;<strong>&#x51FD;&#x6570;&#x5F0F;</strong>&#x65B9;&#x6CD5;</p>
<ul>
<li>&#x4F2A;&#x6570;&#x7EC4;&#x5BF9;&#x8C61;(array-like object)</li>
<li>&#x53EF;&#x679A;&#x4E3E;&#x5BF9;&#x8C61;(iterable object)</li>
<li>&#x514B;&#x9686;&#x6570;&#x7EC4;</li>
<li>map &#x51FD;&#x6570;</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// Set</span>
<span class="token comment">// Map</span>

<span class="token comment">// NodeList&#x5BF9;&#x8C61;</span>
<span class="token keyword">const</span> ps <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">&apos;p&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">p</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// arguments&#x5BF9;&#x8C61;</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> args <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&apos;hello&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; [&apos;h&apos;, &apos;e&apos;, &apos;l&apos;, &apos;l&apos;, &apos;o&apos;]</span>

<span class="token keyword">const</span> namesSet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&apos;a&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;b&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>namesSet<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [&apos;a&apos;, &apos;b&apos;]</span>

<span class="token comment">// &#x514B;&#x9686;&#x6570;&#x7EC4;</span>
Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; [1, 2, 3]</span>

Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>arrayLike<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x <span class="token operator">*</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt;</span>
Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>arrayLike<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x <span class="token operator">*</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>

Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x <span class="token operator">*</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// [1, 4, 9]</span>
</code></pre>
<h4 id="arraycopywithin"><a name="arraycopywithin" class="anchor-navigation-ex-anchor" href="#arraycopywithin"><i class="fa fa-link" aria-hidden="true"></i></a><a name="arraycopywithin" class="plugin-anchor" href="#arraycopywithin"><i class="fa fa-link" aria-hidden="true"></i></a>Array.copyWithin</h4>
<p>&#x66FF;&#x6362;&#x6570;&#x7EC4;&#x5143;&#x7D20;&#xFF0C;&#x4FEE;&#x6539;&#x539F;&#x6570;&#x7EC4;</p>
<pre class="language-"><code class="lang-js"><span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">copyWithin</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> <span class="token punctuation">(</span>start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>end <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">copyWithin</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">[</span>
  <span class="token comment">// =&gt; [4, 5, 3, 4, 5]</span>

  <span class="token comment">// -2&#x76F8;&#x5F53;&#x4E8E;3&#x53F7;&#x4F4D;&#xFF0C;-1&#x76F8;&#x5F53;&#x4E8E;4&#x53F7;&#x4F4D;</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">copyWithin</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; [4, 2, 3, 4, 5]</span>

<span class="token comment">// &#x5C06;2&#x53F7;&#x4F4D;&#x5230;&#x6570;&#x7EC4;&#x7ED3;&#x675F;&#xFF0C;&#x590D;&#x5236;&#x5230;0&#x53F7;&#x4F4D;</span>
<span class="token keyword">const</span> i32a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Int32Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
i32a<span class="token punctuation">.</span><span class="token function">copyWithin</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; Int32Array [3, 4, 5, 4, 5]</span>
</code></pre>
<h4 id="arrayfind"><a name="arrayfind" class="anchor-navigation-ex-anchor" href="#arrayfind"><i class="fa fa-link" aria-hidden="true"></i></a><a name="arrayfind" class="plugin-anchor" href="#arrayfind"><i class="fa fa-link" aria-hidden="true"></i></a>Array.find</h4>
<pre class="language-"><code class="lang-js">arr<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
arr<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="arrayflat"><a name="arrayflat" class="anchor-navigation-ex-anchor" href="#arrayflat"><i class="fa fa-link" aria-hidden="true"></i></a><a name="arrayflat" class="plugin-anchor" href="#arrayflat"><i class="fa fa-link" aria-hidden="true"></i></a>Array.flat</h4>
<p><code>[2, [2, 2]] =&gt; [2, 2, 2]</code></p>
<h4 id="arrayflatmap"><a name="arrayflatmap" class="anchor-navigation-ex-anchor" href="#arrayflatmap"><i class="fa fa-link" aria-hidden="true"></i></a><a name="arrayflatmap" class="plugin-anchor" href="#arrayflatmap"><i class="fa fa-link" aria-hidden="true"></i></a>Array.flatMap</h4>
<p>map + flat</p>
<h4 id="arraymap"><a name="arraymap" class="anchor-navigation-ex-anchor" href="#arraymap"><i class="fa fa-link" aria-hidden="true"></i></a><a name="arraymap" class="plugin-anchor" href="#arraymap"><i class="fa fa-link" aria-hidden="true"></i></a>Array.map</h4>
<p>&#x76F8;&#x5F53;&#x4E8E; Haskell &#x4E2D;&#x7684; List Map</p>
<h4 id="arrayfilter"><a name="arrayfilter" class="anchor-navigation-ex-anchor" href="#arrayfilter"><i class="fa fa-link" aria-hidden="true"></i></a><a name="arrayfilter" class="plugin-anchor" href="#arrayfilter"><i class="fa fa-link" aria-hidden="true"></i></a>Array.filter</h4>
<p>&#x76F8;&#x5F53;&#x4E8E; Haskell &#x4E2D;&#x7684; List Filter</p>
<h4 id="arrayreduce"><a name="arrayreduce" class="anchor-navigation-ex-anchor" href="#arrayreduce"><i class="fa fa-link" aria-hidden="true"></i></a><a name="arrayreduce" class="plugin-anchor" href="#arrayreduce"><i class="fa fa-link" aria-hidden="true"></i></a>Array.reduce</h4>
<p>&#x76F8;&#x5F53;&#x4E8E; Haskell &#x4E2D;&#x7684; fold</p>
<h4 id="arraysort"><a name="arraysort" class="anchor-navigation-ex-anchor" href="#arraysort"><i class="fa fa-link" aria-hidden="true"></i></a><a name="arraysort" class="plugin-anchor" href="#arraysort"><i class="fa fa-link" aria-hidden="true"></i></a>Array.sort</h4>
<h4 id="spread-array"><a name="spread-array" class="anchor-navigation-ex-anchor" href="#spread-array"><i class="fa fa-link" aria-hidden="true"></i></a><a name="spread-array" class="plugin-anchor" href="#spread-array"><i class="fa fa-link" aria-hidden="true"></i></a>Spread Array</h4>
<pre class="language-"><code class="lang-js">arr2<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">...</span>arr1<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> z<span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

obj<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">yield</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token punctuation">[</span><span class="token operator">...</span>obj<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// print [1, 2, 3]</span>
</code></pre>
<h3 id="new-object-api"><a name="new-object-api" class="anchor-navigation-ex-anchor" href="#new-object-api"><i class="fa fa-link" aria-hidden="true"></i></a>1.10. New Object API</h3>
<ul>
<li>Object.keys()</li>
<li>Object.values()</li>
<li>Object.entries()</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> score <span class="token operator">=</span> <span class="token punctuation">{</span>
  jamon<span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
  todd<span class="token operator">:</span> <span class="token number">19</span><span class="token punctuation">,</span>
  ken<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
  gant<span class="token operator">:</span> <span class="token number">41</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">k</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> score<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; [ 42, 19, 4, 41 ]</span>

Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; [ 42, 19, 4, 41 ]</span>

Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * =&gt;
 * [
 * [ &apos;jamon&apos;, 42 ],
 * [ &apos;todd&apos;, 19 ],
 * [ &apos;ken&apos;, 4 ],
 * [ &apos;gant&apos;, 41 ],
 * ]
 */</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> object <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span> abc<span class="token operator">:</span> <span class="token number">9001</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">fromEntries</span><span class="token punctuation">(</span>
  Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>key<span class="token punctuation">,</span> value<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> key<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>key<span class="token punctuation">,</span> value<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> value <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> objectCopy <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">fromEntries</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="arrow-function"><a name="arrow-function" class="anchor-navigation-ex-anchor" href="#arrow-function"><i class="fa fa-link" aria-hidden="true"></i></a>1.11. Arrow Function</h3>
<ul>
<li>no thisArgs binding</li>
<li>no arguments binding</li>
<li>no prototype binding</li>
<li>no suited for <code>New</code> constructor</li>
<li>not suited as methods of plain object
(<code>this</code> in arrow function would be refer to <code>window</code>)</li>
</ul>
<h3 id="modules"><a name="modules" class="anchor-navigation-ex-anchor" href="#modules"><i class="fa fa-link" aria-hidden="true"></i></a>1.12. Modules</h3>
<pre class="language-"><code class="lang-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> lastName <span class="token keyword">as</span> surname <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;./profile.js&apos;</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token keyword">export</span> <span class="token keyword">const</span> firstName <span class="token operator">=</span> <span class="token string">&apos;Michael&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> lastName <span class="token operator">=</span> <span class="token string">&apos;Jackson&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> year <span class="token operator">=</span> <span class="token number">1958</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token comment">// profile.js</span>
<span class="token keyword">const</span> firstName <span class="token operator">=</span> <span class="token string">&apos;Michael&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> lastName <span class="token operator">=</span> <span class="token string">&apos;Jackson&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> year <span class="token operator">=</span> <span class="token number">1958</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> firstName<span class="token punctuation">,</span> lastName<span class="token punctuation">,</span> year <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token comment">// &#x63A5;&#x53E3;&#x6539;&#x540D;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> foo <span class="token keyword">as</span> myFoo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;my_module&apos;</span><span class="token punctuation">;</span>

<span class="token comment">// &#x6574;&#x4F53;&#x8F93;&#x51FA;</span>
<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">&apos;my_module&apos;</span><span class="token punctuation">;</span>
</code></pre>
<ul>
<li>CommonJS &#x6A21;&#x5757;&#x662F;&#x8FD0;&#x884C;&#x65F6;&#x52A0;&#x8F7D;&#xFF0C;ES6 &#x6A21;&#x5757;&#x662F;&#x7F16;&#x8BD1;&#x65F6;&#x8F93;&#x51FA;&#x63A5;&#x53E3;</li>
<li>CommonJS &#x6A21;&#x5757;&#x8F93;&#x51FA;&#x7684;&#x662F;&#x4E00;&#x4E2A;&#x503C;&#x7684;&#x62F7;&#x8D1D;,
ES6 &#x6A21;&#x5757; Export &#x5206; 3 &#x79CD;&#x60C5;&#x51B5;:<ol>
<li><code>export default xxx</code>&#x8F93;&#x51FA;<code>value</code>,</li>
<li><code>export xxx</code>&#x8F93;&#x51FA;<code>reference</code>.
<code>defaultThing</code> and <code>anotherDefaultThing</code> shows ES6 export default value,
<code>importedThing</code> and <code>module.thing</code> shows ES6 export normal reference,
and <code>Destructuring Behavior</code> create a brand new value.</li>
<li>function/class special case:
<code>export default function/class thing() {}; // function/class expressions</code>
export default reference,
<code>function/class thing() {}; export default thing; // function/class statements</code>
export default value.</li>
</ol>
</li>
</ul>
<p>Export default value:</p>
<pre class="language-"><code class="lang-js"><span class="token comment">// module.js</span>
<span class="token keyword">let</span> thing <span class="token operator">=</span> <span class="token string">&apos;initial&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> thing <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> thing<span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  thing <span class="token operator">=</span> <span class="token string">&apos;changed&apos;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// main.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> thing<span class="token punctuation">,</span> <span class="token keyword">default</span> <span class="token keyword">as</span> defaultThing <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;./module.js&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> anotherDefaultThing <span class="token keyword">from</span> <span class="token string">&apos;./module.js&apos;</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>thing<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;changed&quot;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>defaultThing<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;initial&quot;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>anotherDefaultThing<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;initial&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Export normal reference:</p>
<pre class="language-"><code class="lang-js"><span class="token comment">// module.js</span>
<span class="token keyword">export</span> <span class="token keyword">let</span> thing <span class="token operator">=</span> <span class="token string">&apos;initial&apos;</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  thing <span class="token operator">=</span> <span class="token string">&apos;changed&apos;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// main.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> thing <span class="token keyword">as</span> importedThing <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;./module.js&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> module <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&apos;./module.js&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token punctuation">{</span> thing <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&apos;./module.js&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Destructuring Behavior</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>importedThing<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;changed&quot;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>thing<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;changed&quot;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>thing<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;initial&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>To sum up:</p>
<pre class="language-"><code class="lang-js"><span class="token comment">// These give you a live reference to the exported thing(s):</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> thing <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;./module.js&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> thing <span class="token keyword">as</span> otherName <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;./module.js&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> module <span class="token keyword">from</span> <span class="token string">&apos;./module.js&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> module <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&apos;./module.js&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// This assigns the current value of the export to a new identifier:</span>
<span class="token keyword">let</span> <span class="token punctuation">{</span> thing <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&apos;./module.js&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// These export a live reference:</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> thing <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> thing <span class="token keyword">as</span> otherName <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> thing <span class="token keyword">as</span> <span class="token keyword">default</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">thing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// These export the current value:</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> thing<span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token string">&apos;hello!&apos;</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="class-&#x8BED;&#x6CD5;&#x7CD6;"><a name="class-&#x8BED;&#x6CD5;&#x7CD6;" class="anchor-navigation-ex-anchor" href="#class-&#x8BED;&#x6CD5;&#x7CD6;"><i class="fa fa-link" aria-hidden="true"></i></a>1.13. Class &#x8BED;&#x6CD5;&#x7CD6;</h3>
<pre class="language-"><code class="lang-js"><span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>val <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">B</span> <span class="token keyword">extends</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">B</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">B</span><span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token constant">A</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">B</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">===</span> <span class="token constant">B</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">B</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">A</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">B</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token constant">AA</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>val <span class="token operator">=</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token constant">BB</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token constant">AA</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">BB</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">AA</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">BB</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> <span class="token constant">BB</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> bb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BB</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">BB</span><span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// not consistence with class syntax</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">BB</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">===</span> <span class="token constant">BB</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">BB</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">AA</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>bb<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">BB</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>&#x7981;&#x6B62;&#x5BF9;&#x590D;&#x5408;&#x5BF9;&#x8C61;&#x5B57;&#x9762;&#x91CF;&#x8FDB;&#x884C;&#x5BFC;&#x51FA;&#x64CD;&#x4F5C; (array literal, object literal)</p>
<h3 id="map"><a name="map" class="anchor-navigation-ex-anchor" href="#map"><i class="fa fa-link" aria-hidden="true"></i></a>1.14. Map</h3>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token comment">// You define a map via an array of 2-element arrays. The first</span>
  <span class="token comment">// element of each nested array is the key, and the 2nd is the value</span>
  <span class="token punctuation">[</span><span class="token string">&apos;name&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;Jean-Luc Picard&apos;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">&apos;age&apos;</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">&apos;rank&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;Captain&apos;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// To get the value associated with a given `key` in a map, you</span>
<span class="token comment">// need to call `map.get(key)`. Using `map.key` will **not** work.</span>
map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&apos;name&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &apos;Jean-Luc Picard&apos;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> n1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> n2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span> <span class="token string">&apos;One&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>n2<span class="token punctuation">,</span> <span class="token string">&apos;Two&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// `n1` and `n2` are objects, so `n1 !== n2`. That means the map has</span>
<span class="token comment">// separate keys for `n1` and `n2`.</span>
map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>n1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &apos;One&apos;</span>
map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>n2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &apos;Two&apos;</span>
map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>

<span class="token comment">// If you were to do this with an object, `n2` would overwrite `n1`</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
obj<span class="token punctuation">[</span>n1<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&apos;One&apos;</span><span class="token punctuation">;</span>
obj<span class="token punctuation">[</span>n2<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&apos;Two&apos;</span><span class="token punctuation">;</span>

obj<span class="token punctuation">[</span>n1<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// &apos;Two&apos;</span>
obj<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// &apos;Two&apos;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> objectClone <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> arrayClone <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span>entries<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token string">&apos;name&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;Jean-Luc Picard&apos;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">&apos;age&apos;</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">&apos;rank&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;Captain&apos;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// The `for/of` loop can loop through iterators</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">of</span> map<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  key<span class="token punctuation">;</span> <span class="token comment">// &apos;name&apos;, &apos;age&apos;, &apos;rank&apos;</span>
<span class="token punctuation">}</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> v <span class="token keyword">of</span> map<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  v<span class="token punctuation">;</span> <span class="token comment">// &apos;Jean-Luc Picard&apos;, 59, &apos;Captain&apos;</span>
<span class="token punctuation">}</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> value<span class="token punctuation">]</span> <span class="token keyword">of</span> map<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  key<span class="token punctuation">;</span> <span class="token comment">// &apos;name&apos;, &apos;age&apos;, &apos;rank&apos;</span>
  value<span class="token punctuation">;</span> <span class="token comment">// &apos;Jean-Luc Picard&apos;, 59, &apos;Captain&apos;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="weakmap"><a name="weakmap" class="anchor-navigation-ex-anchor" href="#weakmap"><i class="fa fa-link" aria-hidden="true"></i></a>1.15. WeakMap</h3>
<p>WeakMap &#x7ED3;&#x6784;&#x4E0E; Map &#x7ED3;&#x6784;&#x57FA;&#x672C;&#x7C7B;&#x4F3C;,
&#x552F;&#x4E00;&#x7684;&#x533A;&#x522B;&#x5C31;&#x662F; WeakMap &#x53EA;&#x63A5;&#x53D7;&#x5BF9;&#x8C61;&#x4F5C;&#x4E3A;&#x952E;&#x540D; (null &#x9664;&#x5916;),
&#x800C;&#x4E14;&#x952E;&#x540D;&#x6240;&#x6307;&#x5411;&#x7684;&#x5BF9;&#x8C61;&#x4E0D;&#x8BA1;&#x5165;&#x5783;&#x573E;&#x56DE;&#x6536;&#x673A;&#x5236;.</p>
<p>&#x5B83;&#x7684;&#x952E;&#x6240;&#x5BF9;&#x5E94;&#x7684;&#x5BF9;&#x8C61;&#x53EF;&#x80FD;&#x4F1A;&#x5728;&#x5C06;&#x6765;&#x6D88;&#x5931;.
&#x4E00;&#x4E2A;&#x5BF9;&#x5E94; DOM &#x5143;&#x7D20;&#x7684; WeakMap &#x7ED3;&#x6784;,
&#x5F53;&#x67D0;&#x4E2A; DOM &#x5143;&#x7D20;&#x88AB;&#x6E05;&#x9664;,
&#x5176;&#x6240;&#x5BF9;&#x5E94;&#x7684; WeakMap &#x8BB0;&#x5F55;&#x5C31;&#x4F1A;&#x81EA;&#x52A8;&#x88AB;&#x79FB;&#x9664;.</p>
<p>&#x6709;&#x65F6;&#x5019;&#x6211;&#x4EEC;&#x4F1A;&#x628A;&#x5BF9;&#x8C61;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x952E;&#x7528;&#x6765;&#x5B58;&#x653E;&#x5C5E;&#x6027;&#x503C;,
&#x666E;&#x901A;&#x96C6;&#x5408;&#x7C7B;&#x578B;&#x6BD4;&#x5982;&#x7B80;&#x5355;&#x5BF9;&#x8C61;&#x4F1A;&#x963B;&#x6B62;&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;&#x5BF9;&#x8FD9;&#x4E9B;&#x4F5C;&#x4E3A;&#x5C5E;&#x6027;&#x952E;&#x5B58;&#x5728;&#x7684;&#x5BF9;&#x8C61;&#x7684;&#x56DE;&#x6536;,
&#x6709;&#x9020;&#x6210;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#x7684;&#x5371;&#x9669;,
&#x800C; WeakMap/WeakSet &#x5219;&#x66F4;&#x52A0;&#x5B89;&#x5168;&#x4E9B;.</p>
<h3 id="symbol"><a name="symbol" class="anchor-navigation-ex-anchor" href="#symbol"><i class="fa fa-link" aria-hidden="true"></i></a>1.16. Symbol</h3>
<ul>
<li>A Symbol is a <strong>unique</strong> and <strong>immutable</strong> primitive value
and may be used as the key of an Object property.</li>
<li>Symbols don&apos;t auto-convert to &quot;strings&quot; and can&apos;t convert to numbers</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&apos;a&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;b&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;c&apos;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> iter <span class="token operator">=</span> arr<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { value: &apos;a&apos;, done: false }</span>
iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { value: &apos;b&apos;, done: false }</span>
iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { value: &apos;c&apos;, done: false }</span>
iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { value: undefined, done: true }</span>
</code></pre>
<h3 id="iterator"><a name="iterator" class="anchor-navigation-ex-anchor" href="#iterator"><i class="fa fa-link" aria-hidden="true"></i></a>1.17. Iterator</h3>
<ul>
<li>&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x53EA;&#x8981;&#x5177;&#x6709; Symbol.iterator &#x5C5E;&#x6027; (&#x5176;&#x4E3A; function), &#x5C31;&#x53EF;&#x4EE5;&#x8BA4;&#x4E3A;&#x662F; &quot;&#x53EF;&#x904D;&#x5386;&#x7684;&quot; (iterable)</li>
<li>implement iterator with <code>Symbol.iterator</code></li>
</ul>
<h4 id="synchronous-iterator"><a name="synchronous-iterator" class="anchor-navigation-ex-anchor" href="#synchronous-iterator"><i class="fa fa-link" aria-hidden="true"></i></a><a name="synchronous-iterator" class="plugin-anchor" href="#synchronous-iterator"><i class="fa fa-link" aria-hidden="true"></i></a>Synchronous Iterator</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> Iterable <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Iterator<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> Iterator <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> IteratorResult<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> IteratorResult<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">throw</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> e<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> IteratorResult <span class="token operator">=</span> <span class="token punctuation">{</span>
  value<span class="token operator">:</span> any<span class="token punctuation">,</span>
  done<span class="token operator">:</span> boolean<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> Iterator <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> IteratorResult<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span> <span class="token function">methodsIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> methods <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">typeof</span> <span class="token keyword">this</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&apos;function&apos;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// iterator object</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">next</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// Conform to Iterator protocol</span>
      done<span class="token operator">:</span> index <span class="token operator">&gt;=</span> methods<span class="token punctuation">.</span>length<span class="token punctuation">,</span>
      value<span class="token operator">:</span> methods<span class="token punctuation">[</span>index<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> myMethods <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">toString</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&apos;[object myMethods]&apos;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">sumNumbers</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  numbers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token operator">:</span> methodsIterator<span class="token punctuation">,</span> <span class="token comment">// Conform to Iterable Protocol</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> method <span class="token keyword">of</span> myMethods<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>method<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// logs methods `toString` and `sumNumbers`</span>
<span class="token punctuation">}</span>
</code></pre>
<h4 id="asynchronous-iterator"><a name="asynchronous-iterator" class="anchor-navigation-ex-anchor" href="#asynchronous-iterator"><i class="fa fa-link" aria-hidden="true"></i></a><a name="asynchronous-iterator" class="plugin-anchor" href="#asynchronous-iterator"><i class="fa fa-link" aria-hidden="true"></i></a>Asynchronous Iterator</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> AsyncIterable <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>asyncIterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> AsyncIterator<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> AsyncIterator <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>IteratorResult<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>IteratorResult<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">throw</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> IteratorResult <span class="token operator">=</span> <span class="token punctuation">{</span>
  value<span class="token operator">:</span> any<span class="token punctuation">,</span>
  done<span class="token operator">:</span> boolean<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span> <span class="token function">remotePostsAsyncIteratorsFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> done <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> asyncIterableIterator <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// the next method will always return a Promise</span>
    <span class="token keyword">async</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// do nothing if we went out-of-bounds</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>done<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          done<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          value<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>
        <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://jsonplaceholder.typicode.com/posts/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i<span class="token operator">++</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
      <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">r</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> r<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// the posts source is ended</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        done <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          done<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          value<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          done<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
          value<span class="token operator">:</span> res<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>asyncIterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> asyncIterableIterator<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> ait <span class="token operator">=</span> <span class="token function">remotePostsAsyncIteratorsFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">await</span> ait<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { done:false, value:{id: 1, ...} }</span>
  <span class="token keyword">await</span> ait<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { done:false, value:{id: 2, ...} }</span>
  <span class="token keyword">await</span> ait<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { done:false, value:{id: 3, ...} }</span>
  <span class="token comment">// ...</span>
  <span class="token keyword">await</span> ait<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { done:false, value:{id: 100, ...} }</span>
  <span class="token keyword">await</span> ait<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { done:true, value:undefined }</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token comment">// tasks will run in parallel</span>
ait<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ait<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ait<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="generator"><a name="generator" class="anchor-navigation-ex-anchor" href="#generator"><i class="fa fa-link" aria-hidden="true"></i></a>1.18. Generator</h3>
<ul>
<li><a href="https://dev.to/jfet97/javascript-iterators-and-generators-synchronous-generators-3ai4" target="_blank">Synchronous Generators</a></li>
</ul>
<h4 id="basic-usage"><a name="basic-usage" class="anchor-navigation-ex-anchor" href="#basic-usage"><i class="fa fa-link" aria-hidden="true"></i></a><a name="basic-usage" class="plugin-anchor" href="#basic-usage"><i class="fa fa-link" aria-hidden="true"></i></a>Basic Usage</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">yield</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> g <span class="token operator">=</span> <span class="token function">gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { value: 1, done: false }</span>
g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { value: 2, done: false }</span>
g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { value: 3, done: false }</span>
g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { value: undefined, done: true }</span>
g<span class="token punctuation">.</span><span class="token function">return</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { value: undefined, done: true }</span>
g<span class="token punctuation">.</span><span class="token function">return</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { value: 1, done: true }</span>
</code></pre>
<p>iterable object</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> users <span class="token operator">=</span> <span class="token punctuation">{</span>
  james<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  andrew<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  alexander<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  daisy<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  luke<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  clare<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>

  <span class="token operator">*</span><span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// this === &apos;users&apos;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> <span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">yield</span> key<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>early return</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">yield</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> g <span class="token operator">=</span> <span class="token function">gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { value: 1, done: false }</span>
g<span class="token punctuation">.</span><span class="token function">return</span><span class="token punctuation">(</span><span class="token string">&apos;foo&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { value: &quot;foo&quot;, done: true }</span>
g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { value: undefined, done: true }</span>
</code></pre>
<h4 id="complex-usage"><a name="complex-usage" class="anchor-navigation-ex-anchor" href="#complex-usage"><i class="fa fa-link" aria-hidden="true"></i></a><a name="complex-usage" class="plugin-anchor" href="#complex-usage"><i class="fa fa-link" aria-hidden="true"></i></a>Complex Usage</h4>
<p>The generator function itself is not iterable, call it to get the iterable-iterator</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> v <span class="token keyword">of</span> someOddNumbers<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token comment">// =&gt; TypeEror: someOddNumbers is not iterable</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> v <span class="token keyword">of</span> <span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1 3 5 7</span>
<span class="token punctuation">}</span>
</code></pre>
<p>messaging system</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">lazyCalculator</span><span class="token punctuation">(</span><span class="token parameter">operator</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> firstOperand <span class="token operator">=</span> <span class="token keyword">yield</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> secondOperand <span class="token operator">=</span> <span class="token keyword">yield</span><span class="token punctuation">;</span>

  <span class="token keyword">switch</span> <span class="token punctuation">(</span>operator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">&apos;+&apos;</span><span class="token operator">:</span>
      <span class="token keyword">yield</span> firstOperand <span class="token operator">+</span> secondOperand<span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">&apos;-&apos;</span><span class="token operator">:</span>
      <span class="token keyword">yield</span> firstOperand <span class="token operator">-</span> secondOperand<span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">&apos;*&apos;</span><span class="token operator">:</span>
      <span class="token keyword">yield</span> firstOperand <span class="token operator">*</span> secondOperand<span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">&apos;/&apos;</span><span class="token operator">:</span>
      <span class="token keyword">yield</span> firstOperand <span class="token operator">/</span> secondOperand<span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> g <span class="token operator">=</span> <span class="token function">gen</span><span class="token punctuation">(</span><span class="token string">&apos;*&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { value: undefined, done: false }</span>
g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { value: undefined, done: false }</span>
g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { value: 20, done: false }</span>
g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { value: undefined, done: true }</span>
</code></pre>
<p>error handling</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">generator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">yield</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">yield</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span> <span class="token number">3</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span> <span class="token number">4</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> it <span class="token operator">=</span> <span class="token function">generator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {value: 1, done: false}</span>

<span class="token comment">// the error will be handled and printed (&quot;Error: Handled!&quot;),</span>
<span class="token comment">// then the flow will continue, so we will get the</span>
<span class="token comment">// next yielded value as result.</span>
it<span class="token punctuation">.</span><span class="token function">throw</span><span class="token punctuation">(</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">&apos;Handled!&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {value: 2, done: false}</span>

it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {value: 3, done: false}</span>

<span class="token comment">// now the generator instance is paused on the</span>
<span class="token comment">// third yield that is not inside a try-catch.</span>
<span class="token comment">// the error will be re-thrown out</span>
it<span class="token punctuation">.</span><span class="token function">throw</span><span class="token punctuation">(</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">&apos;Not handled!&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// !!! Uncaught Error: Not handled! !!!</span>

<span class="token comment">// now the iterator is exhausted</span>
it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {value: undefined, done: true}</span>
</code></pre>
<p>Generator based control flow goodness for nodejs and the browser,
using promises, letting you write non-blocking code in a nice-ish way
(just like <a href="https://github.com/tj/co" target="_blank">tj/co</a>).</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span> <span class="token function">coroutine</span><span class="token punctuation">(</span><span class="token parameter">generatorFunc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> generator <span class="token operator">=</span> <span class="token function">generatorFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">nextResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">nextResponse</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> generator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>done<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">.</span>then<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      value<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>nextResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">nextResponse</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">coroutine</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">bounce</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">yield</span> bounceUp<span class="token punctuation">;</span>
  <span class="token keyword">yield</span> bounceDown<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="asynchronous-generator"><a name="asynchronous-generator" class="anchor-navigation-ex-anchor" href="#asynchronous-generator"><i class="fa fa-link" aria-hidden="true"></i></a><a name="asynchronous-generator" class="plugin-anchor" href="#asynchronous-generator"><i class="fa fa-link" aria-hidden="true"></i></a>Asynchronous Generator</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> asyncSource <span class="token operator">=</span> <span class="token punctuation">{</span>
  async <span class="token operator">*</span><span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>asyncIterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">yield</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">remotePostsAsyncGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://jsonplaceholder.typicode.com/posts/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i<span class="token operator">++</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">r</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> r<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// when no more remote posts will be available,</span>
    <span class="token comment">// it will break the infinite loop.</span>
    <span class="token comment">// the async iteration will end</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">yield</span> res<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token comment">// do you remember it?</span>
<span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">chunkify</span><span class="token punctuation">(</span><span class="token parameter">array<span class="token punctuation">,</span> n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">yield</span> array<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
  array<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> n <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token keyword">yield</span><span class="token operator">*</span> <span class="token function">chunkify</span><span class="token punctuation">(</span>array<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">getRemoteData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> hasMore <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> page<span class="token punctuation">;</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span>hasMore<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> next_page<span class="token punctuation">,</span> results <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token constant">URL</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> params<span class="token operator">:</span> <span class="token punctuation">{</span> page <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
      <span class="token punctuation">(</span><span class="token parameter">r</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> r<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// return 5 elements with each iteration</span>
    <span class="token keyword">yield</span><span class="token operator">*</span> <span class="token function">chunkify</span><span class="token punctuation">(</span>results<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    hasMore <span class="token operator">=</span> next_page <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    page <span class="token operator">=</span> next_page<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="proxy-and-reflect"><a name="proxy-and-reflect" class="anchor-navigation-ex-anchor" href="#proxy-and-reflect"><i class="fa fa-link" aria-hidden="true"></i></a>1.19. Proxy and Reflect</h3>
<p>modify default object behavior with <code>Proxy</code> and <code>Reflect</code></p>
<pre class="language-"><code class="lang-js"><span class="token comment">// new Proxy(target, handler)</span>
<span class="token function">Proxy</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> name<span class="token punctuation">,</span> value<span class="token punctuation">,</span> receiver</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> success <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> name<span class="token punctuation">,</span> value<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>success<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;property &apos;</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">&apos; on &apos;</span> <span class="token operator">+</span> target <span class="token operator">+</span> <span class="token string">&apos; set to &apos;</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> success<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>APIs of handler:</p>
<ul>
<li>get</li>
<li>set</li>
<li>has</li>
<li>apply</li>
<li>construct</li>
<li>ownKeys</li>
<li>deleteProperty</li>
<li>defineProperty</li>
<li>isExtensible</li>
<li>preventExtensions</li>
<li>getPrototypeOf</li>
<li>setPrototypeOf</li>
<li>getOwnPropertyDescriptor</li>
</ul>
<h4 id="default-zero-value-with-proxy"><a name="default-zero-value-with-proxy" class="anchor-navigation-ex-anchor" href="#default-zero-value-with-proxy"><i class="fa fa-link" aria-hidden="true"></i></a><a name="default-zero-value-with-proxy" class="plugin-anchor" href="#default-zero-value-with-proxy"><i class="fa fa-link" aria-hidden="true"></i></a>Default Zero Value with Proxy</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> <span class="token function-variable function">withZeroValue</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> zeroValue <span class="token operator">=</span> <span class="token number">0</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> prop</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>prop <span class="token keyword">in</span> obj <span class="token operator">?</span> obj<span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">:</span> zeroValue<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> pos <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">19</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>pos<span class="token punctuation">.</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; undefined</span>
pos <span class="token operator">=</span> <span class="token function">withZeroValue</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>pos<span class="token punctuation">.</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; 0</span>
</code></pre>
<h4 id="negative-array-indice-with-proxy"><a name="negative-array-indice-with-proxy" class="anchor-navigation-ex-anchor" href="#negative-array-indice-with-proxy"><i class="fa fa-link" aria-hidden="true"></i></a><a name="negative-array-indice-with-proxy" class="plugin-anchor" href="#negative-array-indice-with-proxy"><i class="fa fa-link" aria-hidden="true"></i></a>Negative Array Indice with Proxy</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> <span class="token function-variable function">negativeArray</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">els</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> propKey<span class="token punctuation">,</span> receiver</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
      Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>
        target<span class="token punctuation">,</span>
        <span class="token operator">+</span>propKey <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token function">String</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token operator">+</span>propKey<span class="token punctuation">)</span> <span class="token operator">:</span> propKey<span class="token punctuation">,</span>
        receiver
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="hiding-properties-with-proxy"><a name="hiding-properties-with-proxy" class="anchor-navigation-ex-anchor" href="#hiding-properties-with-proxy"><i class="fa fa-link" aria-hidden="true"></i></a><a name="hiding-properties-with-proxy" class="plugin-anchor" href="#hiding-properties-with-proxy"><i class="fa fa-link" aria-hidden="true"></i></a>Hiding Properties with Proxy</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> hide <span class="token operator">=</span> <span class="token punctuation">(</span>target<span class="token punctuation">,</span> prefix <span class="token operator">=</span> <span class="token string">&apos;_&apos;</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">has</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> prop</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span>prop<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span>prefix<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> prop <span class="token keyword">in</span> obj<span class="token punctuation">,</span>
    <span class="token function-variable function">ownKeys</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
      Reflect<span class="token punctuation">.</span><span class="token function">ownKeys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token parameter">prop</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">typeof</span> prop <span class="token operator">!==</span> <span class="token string">&apos;string&apos;</span> <span class="token operator">||</span> <span class="token operator">!</span>prop<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span>prefix<span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> prop<span class="token punctuation">,</span> rec</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>prop <span class="token keyword">in</span> rec <span class="token operator">?</span> obj<span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> userData <span class="token operator">=</span> <span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  firstName<span class="token operator">:</span> <span class="token string">&apos;Tom&apos;</span><span class="token punctuation">,</span>
  mediumHandle<span class="token operator">:</span> <span class="token string">&apos;@tbarrasso&apos;</span><span class="token punctuation">,</span>
  _favoriteRapper<span class="token operator">:</span> <span class="token string">&apos;Drake&apos;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token string">&apos;_favoriteRapper&apos;</span> <span class="token keyword">in</span> userData<span class="token punctuation">;</span> <span class="token comment">// has: false</span>
Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>userData<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ownKeys: [&apos;firstName&apos;, &apos;mediumHandle&apos;]</span>
userData<span class="token punctuation">.</span>_favoriteRapper<span class="token punctuation">;</span> <span class="token comment">// get: undefined</span>
</code></pre>
<h4 id="read-only-object-with-proxy"><a name="read-only-object-with-proxy" class="anchor-navigation-ex-anchor" href="#read-only-object-with-proxy"><i class="fa fa-link" aria-hidden="true"></i></a><a name="read-only-object-with-proxy" class="plugin-anchor" href="#read-only-object-with-proxy"><i class="fa fa-link" aria-hidden="true"></i></a>Read Only Object with Proxy</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> <span class="token function-variable function">NOPE</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&apos;Can\&apos;t modify read-only object&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">NOPE_HANDLER</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  set<span class="token operator">:</span> <span class="token constant">NOPE</span><span class="token punctuation">,</span>
  defineProperty<span class="token operator">:</span> <span class="token constant">NOPE</span><span class="token punctuation">,</span>
  deleteProperty<span class="token operator">:</span> <span class="token constant">NOPE</span><span class="token punctuation">,</span>
  deleteProperty<span class="token operator">:</span> <span class="token constant">NOPE</span><span class="token punctuation">,</span>
  preventExtensions<span class="token operator">:</span> <span class="token constant">NOPE</span><span class="token punctuation">,</span>
  setPrototypeOf<span class="token operator">:</span> <span class="token constant">NOPE</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> prop</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>prop <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> prop<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ReferenceError</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Unknown prop &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>prop<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">readOnly</span> <span class="token operator">=</span> <span class="token parameter">target</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> <span class="token constant">NODE_HANDLER</span><span class="token punctuation">)</span>
</code></pre>
<h4 id="range-judgement-with-proxy"><a name="range-judgement-with-proxy" class="anchor-navigation-ex-anchor" href="#range-judgement-with-proxy"><i class="fa fa-link" aria-hidden="true"></i></a><a name="range-judgement-with-proxy" class="plugin-anchor" href="#range-judgement-with-proxy"><i class="fa fa-link" aria-hidden="true"></i></a>Range Judgement with Proxy</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> <span class="token function-variable function">range</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">min<span class="token punctuation">,</span> max</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">has</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> prop</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">+</span>prop <span class="token operator">&gt;=</span> min <span class="token operator">&amp;&amp;</span> <span class="token operator">+</span>prop <span class="token operator">&lt;=</span> max<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">X</span> <span class="token operator">=</span> <span class="token number">10.5</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> nums <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token constant">X</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">X</span> <span class="token keyword">in</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// =&gt; true</span>
<span class="token punctuation">}</span>

nums<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> n <span class="token keyword">in</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; [1, 5]</span>
</code></pre>
<h2 id="functional-javascript"><a name="functional-javascript" class="anchor-navigation-ex-anchor" href="#functional-javascript"><i class="fa fa-link" aria-hidden="true"></i></a>2. Functional JavaScript</h2>
<ul>
<li>predictable (pure and immutable)</li>
<li>safe (pure and immutable)</li>
<li>transparent (pure and immutable)</li>
<li>modular (composite)</li>
</ul>
<h3 id="pros"><a name="pros" class="anchor-navigation-ex-anchor" href="#pros"><i class="fa fa-link" aria-hidden="true"></i></a>2.1. Pros</h3>
<ul>
<li>type safe and state safe</li>
<li>explicit flow of data</li>
<li>concurrency safety</li>
</ul>
<h3 id="cons"><a name="cons" class="anchor-navigation-ex-anchor" href="#cons"><i class="fa fa-link" aria-hidden="true"></i></a>2.2. Cons</h3>
<ul>
<li>verbose</li>
<li>more object creation</li>
<li>more garbage collection</li>
<li>more memory usage</li>
</ul>
<p>With help of <code>immutable.js</code>,
object creation/garbage collection/memory usage can be alleviated.</p>
<p>For example, in vanilla.js, <code>map2 === map1</code> become <code>false</code>,
but in immutable.js <code>map2 === map1</code> become <code>true</code>
(copy free due to immutable data).</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> map1 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&apos;b&apos;</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> map2 <span class="token operator">=</span> map1<span class="token punctuation">.</span>set<span class="token punctuation">{</span> <span class="token string">&apos;b&apos;</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="closure"><a name="closure" class="anchor-navigation-ex-anchor" href="#closure"><i class="fa fa-link" aria-hidden="true"></i></a>2.3. Closure</h3>
<p>Closure is a function that remembers
the variables from the place where it is defined (lexical scope),
regardless of where it is executed later:</p>
<ul>
<li>&#x51FD;&#x6570;&#x5916;&#x90E8;&#x4E0D;&#x53EF;&#x5BF9;&#x51FD;&#x6570;&#x5185;&#x90E8;&#x8FDB;&#x884C;&#x8D4B;&#x503C;&#x6216;&#x5F15;&#x7528;</li>
<li>&#x51FD;&#x6570;&#x4E2D;&#x7684;&#x95ED;&#x5305;&#x51FD;&#x6570;&#x53EF;&#x5BF9;&#x51FD;&#x6570;&#x8FDB;&#x884C;&#x8D4B;&#x503C;&#x6216;&#x5F15;&#x7528;(&#x51FD;&#x6570;&#x5BF9;&#x4E8E;&#x95ED;&#x5305;&#x6765;&#x8BF4;&#x662F;&#x5916;&#x90E8;, &#x5373;&#x5185;&#x90E8;&#x5F15;&#x7528;&#x5916;&#x90E8;)</li>
<li>&#x7279;&#x6743;&#x6027;&#x8D28;: &#x4ECE;&#x5916;&#x90E8;&#x901A;&#x8FC7;&#x95ED;&#x5305;&#x65B9;&#x6CD5;&#x8BBF;&#x95EE;&#x5185;&#x90E8;(&#x51FD;&#x6570;&#x4F5C;&#x7528;&#x57DF;)&#x5C40;&#x90E8;&#x53D8;&#x91CF; (private getter)</li>
<li>Local Scope -&gt; Outer Functions Scope -&gt; Global Scope.</li>
<li>Closure Performance: avoid unnecessary closure creation.</li>
<li>The stale closure captures variables that have outdated values.</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// global scope</span>
<span class="token keyword">var</span> e <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// outer functions scope</span>
      <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// local scope</span>
        <span class="token keyword">return</span> a <span class="token operator">+</span> b <span class="token operator">+</span> c <span class="token operator">+</span> d <span class="token operator">+</span> e<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// log 20</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token comment">// BAD</span>
<span class="token keyword">function</span> <span class="token function">MyObject</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> message</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">=</span> message<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">getMessage</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// GOOD: avoid unnecessary</span>
<span class="token keyword">function</span> <span class="token function">MyObject</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> message</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">=</span> message<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">MyObject</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">MyObject</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getMessage</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="&#x95ED;&#x5305;&#x51FD;&#x6570;&#x7684;&#x7ED3;&#x6784;"><a name="&#x95ED;&#x5305;&#x51FD;&#x6570;&#x7684;&#x7ED3;&#x6784;" class="anchor-navigation-ex-anchor" href="#&#x95ED;&#x5305;&#x51FD;&#x6570;&#x7684;&#x7ED3;&#x6784;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x95ED;&#x5305;&#x51FD;&#x6570;&#x7684;&#x7ED3;&#x6784;" class="plugin-anchor" href="#&#x95ED;&#x5305;&#x51FD;&#x6570;&#x7684;&#x7ED3;&#x6784;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x95ED;&#x5305;&#x51FD;&#x6570;&#x7684;&#x7ED3;&#x6784;</h4>
<ul>
<li>&#x4F18;&#x5148;&#x7EA7;: this &gt; &#x5C40;&#x90E8;&#x53D8;&#x91CF; &gt; &#x5F62;&#x53C2; &gt; arguments &gt; &#x51FD;&#x6570;&#x540D;</li>
<li><code>innerFunc()</code> has access to <code>outerVar</code> from its lexical scope,
even being <strong>executed outside of its lexical scope</strong>.</li>
</ul>
<pre class="language-"><code class="lang-js">unction <span class="token function">outerFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> outerVar <span class="token operator">=</span> <span class="token string">&apos;I am outside!&apos;</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">innerFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>outerVar<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; logs &quot;I am outside!&quot;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> innerFunc<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> myInnerFunc <span class="token operator">=</span> <span class="token function">outerFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">myInnerFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="partial-application"><a name="partial-application" class="anchor-navigation-ex-anchor" href="#partial-application"><i class="fa fa-link" aria-hidden="true"></i></a>2.4. Partial Application</h3>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> <span class="token function-variable function">partialFromBind</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">partial</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>rest</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">,</span> <span class="token operator">...</span>rest<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="currying"><a name="currying" class="anchor-navigation-ex-anchor" href="#currying"><i class="fa fa-link" aria-hidden="true"></i></a>2.5. Currying</h3>
<p>chain of multiple single argument functions</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter">y</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-javascript"><span class="token keyword">function</span> <span class="token function">schonfinkelize</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> slice <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>slice<span class="token punctuation">,</span>
    stored_args <span class="token operator">=</span> <span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> new_args <span class="token operator">=</span> <span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">,</span>
      args <span class="token operator">=</span> stored_args<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>new_args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> addOne <span class="token operator">=</span> <span class="token function">schonfinkelize</span><span class="token punctuation">(</span>add<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// addOne(3) === 4;</span>
<span class="token keyword">const</span> addFive <span class="token operator">=</span> <span class="token function">schonfinkelize</span><span class="token punctuation">(</span>addOne<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// addFive(4) === 9;</span>
</code></pre>
<h2 id="internal-javascript"><a name="internal-javascript" class="anchor-navigation-ex-anchor" href="#internal-javascript"><i class="fa fa-link" aria-hidden="true"></i></a>3. Internal JavaScript</h2>
<p>Under the hood</p>
<h3 id="variables-lifecycle"><a name="variables-lifecycle" class="anchor-navigation-ex-anchor" href="#variables-lifecycle"><i class="fa fa-link" aria-hidden="true"></i></a>3.1. Variables Lifecycle</h3>
<ul>
<li>Creation phase (<strong>Hoisting</strong>)<ul>
<li>Declaration phase: &#x5728;&#x4F5C;&#x7528;&#x57DF;&#x4E2D;&#x6CE8;&#x518C;&#x53D8;&#x91CF;</li>
<li>Initialization phase: &#x5206;&#x914D;&#x5185;&#x5B58;, &#x5728;&#x4F5C;&#x7528;&#x57DF;&#x4E2D;&#x7ED1;&#x5B9A;&#x53D8;&#x91CF; (<code>undefined</code>)</li>
</ul>
</li>
<li>Execution phase/Assignment phase</li>
</ul>
<h3 id="exection-context"><a name="exection-context" class="anchor-navigation-ex-anchor" href="#exection-context"><i class="fa fa-link" aria-hidden="true"></i></a>3.2. Exection Context</h3>
<h4 id="global-exection-context"><a name="global-exection-context" class="anchor-navigation-ex-anchor" href="#global-exection-context"><i class="fa fa-link" aria-hidden="true"></i></a><a name="global-exection-context" class="plugin-anchor" href="#global-exection-context"><i class="fa fa-link" aria-hidden="true"></i></a>Global Exection Context</h4>
<ul>
<li>create global object (<code>window</code>)</li>
<li>create <code>this</code> object(refer to <code>window</code>)</li>
<li>declare and initialize variable(<code>undefined</code>)/function, store them into memory</li>
</ul>
<h4 id="function-exection-context"><a name="function-exection-context" class="anchor-navigation-ex-anchor" href="#function-exection-context"><i class="fa fa-link" aria-hidden="true"></i></a><a name="function-exection-context" class="plugin-anchor" href="#function-exection-context"><i class="fa fa-link" aria-hidden="true"></i></a>Function Exection Context</h4>
<ul>
<li>create arguments object</li>
<li>create <code>this</code> object</li>
<li>declare and initialize variable(<code>undefined</code>)/function, store them into memory</li>
</ul>
<p>&#x5982;&#x679C; JavaScript &#x5F15;&#x64CE;&#x5728;&#x51FD;&#x6570;&#x6267;&#x884C;&#x4E0A;&#x4E0B;&#x6587;&#x4E2D;&#x627E;&#x4E0D;&#x5230;&#x53D8;&#x91CF;,
&#x5B83;&#x4F1A;&#x5728;&#x6700;&#x8FD1;&#x7684;&#x7236;&#x7EA7;&#x6267;&#x884C;&#x4E0A;&#x4E0B;&#x6587;&#x4E2D;&#x67E5;&#x627E;&#x8BE5;&#x53D8;&#x91CF;.
&#x8FD9;&#x4E2A;&#x67E5;&#x627E;&#x94FE;&#x5C06;&#x4F1A;&#x4E00;&#x76F4;&#x6301;&#x7EED;, &#x76F4;&#x5230;&#x5F15;&#x64CE;&#x67E5;&#x627E;&#x5230;&#x5168;&#x5C40;&#x6267;&#x884C;&#x4E0A;&#x4E0B;&#x6587;.
&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;, &#x5982;&#x679C;&#x5168;&#x5C40;&#x6267;&#x884C;&#x4E0A;&#x4E0B;&#x6587;&#x4E5F;&#x6CA1;&#x6709;&#x8BE5;&#x53D8;&#x91CF;, &#x90A3;&#x4E48;&#x5C06;&#x4F1A;&#x629B;&#x51FA;&#x5F15;&#x7528;&#x9519;&#x8BEF; (Reference Error).
&#x5B50;&#x51FD;&#x6570;&#x201C;&#x5305;&#x542B;&#x201D;&#x5B83;&#x7236;&#x7EA7;&#x51FD;&#x6570;&#x7684;&#x53D8;&#x91CF;&#x73AF;&#x5883;&#xFF0C;&#x628A;&#x8FD9;&#x4E2A;&#x6982;&#x5FF5;&#x79F0;&#x4E3A;<strong>&#x95ED;&#x5305;(Closure)</strong>,
&#x5373;&#x4F7F;&#x7236;&#x7EA7;&#x51FD;&#x6570;&#x6267;&#x884C;&#x73AF;&#x5883;&#x5DF2;&#x7ECF;&#x4ECE;&#x6267;&#x884C;&#x6808;&#x5F39;&#x51FA;&#x4E86;, &#x5B50;&#x51FD;&#x6570;&#x8FD8;&#x662F;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x7236;&#x7EA7;&#x51FD;&#x6570;&#x53D8;&#x91CF; x (&#x901A;&#x8FC7;&#x4F5C;&#x7528;&#x57DF;&#x94FE;).</p>
<h3 id="event-loop"><a name="event-loop" class="anchor-navigation-ex-anchor" href="#event-loop"><i class="fa fa-link" aria-hidden="true"></i></a>3.3. Event Loop</h3>
<p><img src="images/event_loop.jpg" alt="Event Loop"></p>
<p>The job of the <strong>event loop</strong> is to look into the call stack
and determine if the call stack is empty or not.
If the <strong>call stack</strong> is empty,
it looks into the <strong>ES6 job queue</strong> and <strong>message queue</strong> to see
if there&#x2019;s any pending call back waiting to be executed:</p>
<ul>
<li>ES6 job queue: used by <code>Promises</code> (higher priority)</li>
<li>message queue: used by <code>setTimeout</code>, <code>DOM events</code></li>
<li>&#x5FAE;&#x4EFB;&#x52A1; Microtask&#xFF0C;&#x6709;&#x7279;&#x6743;, &#x53EF;&#x4EE5;&#x63D2;&#x961F;:
process.nextTick,
Promises.then (Promise &#x6784;&#x9020;&#x51FD;&#x6570;&#x662F;&#x540C;&#x6B65;&#x51FD;&#x6570;),
Object.observer, MutationObserver</li>
<li>&#x5B8F;&#x4EFB;&#x52A1; Macrotask&#xFF0C;&#x6CA1;&#x6709;&#x7279;&#x6743;:
setTimeout, setInterval,
setImmediate, I/O,
MessageChannel, postMessage,
UI rendering, UI Interaction Events</li>
<li>Microtask &#x4F18;&#x5148;&#x4E8E; Macrotask</li>
<li>&#x6D4F;&#x89C8;&#x5668;&#x4E3A;&#x4E86;&#x80FD;&#x591F;&#x4F7F;&#x5F97; JS &#x5185;&#x90E8; (macro)task &#x4E0E; DOM &#x4EFB;&#x52A1;&#x80FD;&#x591F;&#x6709;&#x5E8F;&#x7684;&#x6267;&#x884C;,
&#x4F1A;&#x5728;&#x4E00;&#x4E2A; (macro)task &#x6267;&#x884C;&#x7ED3;&#x675F;&#x540E;, &#x5728;&#x4E0B;&#x4E00;&#x4E2A; (macro)task &#x6267;&#x884C;&#x5F00;&#x59CB;&#x524D;, &#x5BF9;&#x9875;&#x9762;&#x8FDB;&#x884C;&#x91CD;&#x65B0;&#x6E32;&#x67D3;.
&#x5F53; JS &#x5F15;&#x64CE;&#x4ECE;&#x4EFB;&#x52A1;&#x961F;&#x5217;&#x4E2D;&#x53D6;&#x51FA;&#x4E00;&#x4E2A;&#x5B8F;&#x4EFB;&#x52A1;&#x6765;&#x6267;&#x884C;, &#x5982;&#x679C;&#x6267;&#x884C;&#x8FC7;&#x7A0B;&#x4E2D;&#x6709;&#x9047;&#x5230;&#x5FAE;&#x4EFB;&#x52A1;,
&#x90A3;&#x4E48;&#x6267;&#x884C;&#x5B8C;&#x8BE5;&#x5B8F;&#x4EFB;&#x52A1;&#x5C31;&#x4F1A;&#x53BB;&#x6267;&#x884C;&#x5B8F;&#x4EFB;&#x52A1;&#x5185;&#x7684;&#x6240;&#x6709;&#x5FAE;&#x4EFB;&#x52A1;, &#x7136;&#x540E;&#x66F4;&#x65B0; UI.
&#x540E;&#x9762;&#x5C31;&#x662F;&#x518D;&#x4ECE;&#x4EFB;&#x52A1;&#x961F;&#x5217;&#x4E2D;&#x53D6;&#x51FA;&#x4E0B;&#x4E00;&#x4E2A;&#x5B8F;&#x4EFB;&#x52A1;&#x6765;&#x7EE7;&#x7EED;&#x6267;&#x884C;, &#x4EE5;&#x6B64;&#x7C7B;&#x63A8;.</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> ii <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> ii <span class="token operator">&lt;</span> macrotask<span class="token punctuation">.</span>length<span class="token punctuation">;</span> ii<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">eval</span><span class="token punctuation">(</span>macrotask<span class="token punctuation">[</span>ii<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>microtask<span class="token punctuation">.</span>length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// process all microtasks</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> __i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> __i <span class="token operator">&lt;</span> microtask<span class="token punctuation">.</span>length<span class="token punctuation">;</span> __i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">eval</span><span class="token punctuation">(</span>microtask<span class="token punctuation">[</span>__i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// empty microtask</span>
    microtask <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// next macrotask in next loop iteration</span>
<span class="token punctuation">}</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> <span class="token function-variable function">bar</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;bar&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">baz</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;baz&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;foo&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span>bar<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&apos;Promise resolved&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// foo</span>
<span class="token comment">// baz</span>
<span class="token comment">// Promised resolved</span>
<span class="token comment">// bar</span>
</code></pre>
<p>As above code, using <code>setTimeout</code> with <code>0</code> seconds timer
helps to defer execution of <code>Promise</code> and <code>bar</code> until the <strong>stack</strong> is <strong>empty</strong>.</p>
<pre class="language-"><code class="lang-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;1&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    process<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

process<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  process<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;10&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 1 10 8 9 5 7 2 3 4 6</span>
</code></pre>
<p>Promise &#x6784;&#x9020;&#x51FD;&#x6570;&#x672C;&#x8EAB;&#x662F;&#x540C;&#x6B65;&#x51FD;&#x6570;</p>
<pre class="language-"><code class="lang-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;script start&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> promise1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;promise1&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;promise1 end&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;promise2&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;settimeout&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;script end&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// &#x8F93;&#x51FA;&#x987A;&#x5E8F;: script start-&gt;promise1-&gt;promise1 end-&gt;script end-&gt;promise2-&gt;settimeout</span>
</code></pre>
<p><code>await a(); b()</code> &#x7B49;&#x4EF7;&#x4E8E; <code>Promise(a()).then(b())</code>: a &#x662F;&#x540C;&#x6B65;&#x6267;&#x884C;, b &#x662F; microtask</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;async1 start&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;async1 end&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;async2&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;script start&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;setTimeout&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;promise1&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;promise2&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;script end&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
script start
async1 start
async2
promise1
script end
async1 end
promise2
setTimeout
*/</span>
</code></pre>
<p>&#x5F53;&#x8C03;&#x7528;&#x6808;&#x6CA1;&#x6709;&#x540C;&#x6B65;&#x51FD;&#x6570;&#x65F6;, &#x76F4;&#x63A5;&#x6267;&#x884C;&#x4EFB;&#x52A1;&#x961F;&#x5217;&#x91CC;&#x7684;&#x51FD;&#x6570;</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;start&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;children2&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;children2-1&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;children3&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;children3-1&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;children1&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;end&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// start</span>
<span class="token comment">// end</span>
<span class="token comment">// children1</span>
<span class="token comment">// children2</span>
<span class="token comment">// children2-1</span>
<span class="token comment">// children3</span>
<span class="token comment">// children3-1</span>
</code></pre>
<h2 id="browser-internal"><a name="browser-internal" class="anchor-navigation-ex-anchor" href="#browser-internal"><i class="fa fa-link" aria-hidden="true"></i></a>4. Browser Internal</h2>
<ul>
<li>Chrome: Blink (based on Webkit) + V8</li>
<li>Firefox: Gecko + SpiderMonkey</li>
<li>Safari: Webkit + JavaScriptCore (Nitro)</li>
<li>Edge: Trident/EdgeHTML + Chakra</li>
</ul>
<h3 id="browser-process"><a name="browser-process" class="anchor-navigation-ex-anchor" href="#browser-process"><i class="fa fa-link" aria-hidden="true"></i></a>4.1. Browser Process</h3>
<ul>
<li>&#x6D4F;&#x89C8;&#x5668;&#x8FDB;&#x7A0B;: &#x4E3B;&#x8981;&#x8D1F;&#x8D23;&#x754C;&#x9762;&#x663E;&#x793A;&#x3001;&#x7528;&#x6237;&#x4EA4;&#x4E92;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x7BA1;&#x7406;&#xFF0C;&#x540C;&#x65F6;&#x63D0;&#x4F9B;&#x5B58;&#x50A8;&#x7B49;&#x529F;&#x80FD;.</li>
<li>GPU &#x8FDB;&#x7A0B;: &#x5B9E;&#x73B0; 3D CSS, &#x7ED8;&#x5236; UI &#x754C;&#x9762;.</li>
<li>&#x7F51;&#x7EDC;&#x8FDB;&#x7A0B;&#xFF1A;&#x4E3B;&#x8981;&#x8D1F;&#x8D23;&#x9875;&#x9762;&#x7684;&#x7F51;&#x7EDC;&#x8D44;&#x6E90;&#x52A0;&#x8F7D;.</li>
<li>&#x6E32;&#x67D3;&#x8FDB;&#x7A0B;&#xFF1A;&#x6838;&#x5FC3;&#x4EFB;&#x52A1;&#x662F;&#x5C06; HTML&#x3001;CSS &#x548C; JavaScript &#x8F6C;&#x6362;&#x4E3A;&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x4E0E;&#x4E4B;&#x4EA4;&#x4E92;&#x7684;&#x7F51;&#x9875;,
&#x6392;&#x7248;&#x5F15;&#x64CE; Blink &#x548C; JavaScript &#x5F15;&#x64CE; V8 &#x90FD;&#x662F;&#x8FD0;&#x884C;&#x5728;&#x8BE5;&#x8FDB;&#x7A0B;&#x4E2D;.
&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;, Chrome &#x4F1A;&#x4E3A;&#x6BCF;&#x4E2A; Tab &#x6807;&#x7B7E;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x6E32;&#x67D3;&#x8FDB;&#x7A0B;.
&#x51FA;&#x4E8E;&#x5B89;&#x5168;&#x8003;&#x8651;, &#x6E32;&#x67D3;&#x8FDB;&#x7A0B;&#x90FD;&#x662F;&#x8FD0;&#x884C;&#x5728;&#x6C99;&#x7BB1;&#x6A21;&#x5F0F;&#x4E0B;.</li>
<li>&#x63D2;&#x4EF6;&#x8FDB;&#x7A0B;&#xFF1A;&#x4E3B;&#x8981;&#x662F;&#x8D1F;&#x8D23;&#x63D2;&#x4EF6;&#x7684;&#x8FD0;&#x884C;, &#x56E0;&#x63D2;&#x4EF6;&#x6613;&#x5D29;&#x6E83;&#xFF0C;&#x6240;&#x4EE5;&#x9700;&#x8981;&#x901A;&#x8FC7;&#x9694;&#x79BB;&#x4EE5;&#x4FDD;&#x8BC1;&#x63D2;&#x4EF6;&#x8FDB;&#x7A0B;&#x5D29;&#x6E83;&#x4E0D;&#x4F1A;&#x5BF9;&#x6D4F;&#x89C8;&#x5668;&#x548C;&#x9875;&#x9762;&#x9020;&#x6210;&#x5F71;&#x54CD;.</li>
</ul>
<h3 id="render-engine"><a name="render-engine" class="anchor-navigation-ex-anchor" href="#render-engine"><i class="fa fa-link" aria-hidden="true"></i></a>4.2. Render Engine</h3>
<p>Parser/Script -&gt; DOM Tree -&gt; Styled Tree -&gt; Layout -&gt; Paint -&gt; Composite</p>
<h4 id="html-parser"><a name="html-parser" class="anchor-navigation-ex-anchor" href="#html-parser"><i class="fa fa-link" aria-hidden="true"></i></a><a name="html-parser" class="plugin-anchor" href="#html-parser"><i class="fa fa-link" aria-hidden="true"></i></a>HTML Parser</h4>
<p>DTD is context-sensitive grammar.
Use State Machine pattern to implement a tokenizer</p>
<pre class="language-"><code class="lang-js">Data <span class="token operator">-</span><span class="token operator">&gt;</span> Tag Open <span class="token operator">-</span><span class="token operator">&gt;</span> Tag Name <span class="token operator">-</span><span class="token operator">&gt;</span> Tag Close <span class="token operator">-</span><span class="token operator">&gt;</span> Data
</code></pre>
<p>tokenizer send tokens to constructor, constructing DOM tree</p>
<pre class="language-"><code class="lang-js">initial <span class="token operator">-</span><span class="token operator">&gt;</span> before <span class="token constant">HTML</span> <span class="token operator">-</span><span class="token operator">&gt;</span> before head <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">in</span> head <span class="token operator">-</span><span class="token operator">&gt;</span> after head
<span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">in</span> body <span class="token operator">-</span><span class="token operator">&gt;</span> after body <span class="token operator">-</span><span class="token operator">&gt;</span> after after body <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token constant">EOF</span> token
</code></pre>
<h4 id="css-parser"><a name="css-parser" class="anchor-navigation-ex-anchor" href="#css-parser"><i class="fa fa-link" aria-hidden="true"></i></a><a name="css-parser" class="plugin-anchor" href="#css-parser"><i class="fa fa-link" aria-hidden="true"></i></a>CSS Parser</h4>
<p>CSS is context-free grammar.
Webkit use flex/bison (bottom-to-up), Gecko use up-to-bottom.</p>
<pre class="language-"><code class="lang-js">ruleset
  <span class="token operator">:</span> selector <span class="token punctuation">[</span> <span class="token string">&apos;,&apos;</span> <span class="token constant">S</span><span class="token operator">*</span> selector <span class="token punctuation">]</span><span class="token operator">*</span>
    <span class="token string">&apos;{&apos;</span> <span class="token constant">S</span><span class="token operator">*</span> declaration <span class="token punctuation">[</span> <span class="token string">&apos;;&apos;</span> <span class="token constant">S</span><span class="token operator">*</span> declaration <span class="token punctuation">]</span><span class="token operator">*</span> <span class="token string">&apos;}&apos;</span> <span class="token constant">S</span><span class="token operator">*</span>
  <span class="token punctuation">;</span>
selector
  <span class="token operator">:</span> simple_selector <span class="token punctuation">[</span> combinator selector <span class="token operator">|</span> <span class="token constant">S</span><span class="token operator">+</span> <span class="token punctuation">[</span> combinator<span class="token operator">?</span> selector <span class="token punctuation">]</span><span class="token operator">?</span> <span class="token punctuation">]</span><span class="token operator">?</span>
  <span class="token punctuation">;</span>
simple_selector
  <span class="token operator">:</span> element_name <span class="token punctuation">[</span> <span class="token constant">HASH</span> <span class="token operator">|</span> <span class="token keyword">class</span> <span class="token operator">|</span> attrib <span class="token operator">|</span> pseudo <span class="token punctuation">]</span><span class="token operator">*</span>
  <span class="token operator">|</span> <span class="token punctuation">[</span> <span class="token constant">HASH</span> <span class="token operator">|</span> <span class="token keyword">class</span> <span class="token operator">|</span> attrib <span class="token operator">|</span> pseudo <span class="token punctuation">]</span><span class="token operator">+</span>
  <span class="token punctuation">;</span>
<span class="token keyword">class</span>
  <span class="token operator">:</span> <span class="token string">&apos;.&apos;</span> <span class="token constant">IDENT</span>
  <span class="token punctuation">;</span>
element_name
  <span class="token operator">:</span> <span class="token constant">IDENT</span> <span class="token operator">|</span> <span class="token string">&apos;*&apos;</span>
  <span class="token punctuation">;</span>
attrib
  <span class="token operator">:</span> <span class="token string">&apos;[&apos;</span> <span class="token constant">S</span><span class="token operator">*</span> <span class="token constant">IDENT</span> <span class="token constant">S</span><span class="token operator">*</span> <span class="token punctuation">[</span> <span class="token punctuation">[</span> <span class="token string">&apos;=&apos;</span> <span class="token operator">|</span> <span class="token constant">INCLUDES</span> <span class="token operator">|</span> <span class="token constant">DASHMATCH</span> <span class="token punctuation">]</span> <span class="token constant">S</span><span class="token operator">*</span>
    <span class="token punctuation">[</span> <span class="token constant">IDENT</span> <span class="token operator">|</span> <span class="token constant">STRING</span> <span class="token punctuation">]</span> <span class="token constant">S</span><span class="token operator">*</span> <span class="token punctuation">]</span> <span class="token string">&apos;]&apos;</span>
  <span class="token punctuation">;</span>
pseudo
  <span class="token operator">:</span> <span class="token string">&apos;:&apos;</span> <span class="token punctuation">[</span> <span class="token constant">IDENT</span> <span class="token operator">|</span> <span class="token constant">FUNCTION</span> <span class="token constant">S</span><span class="token operator">*</span> <span class="token punctuation">[</span><span class="token constant">IDENT</span> <span class="token constant">S</span><span class="token operator">*</span><span class="token punctuation">]</span> <span class="token string">&apos;)&apos;</span> <span class="token punctuation">]</span>
  <span class="token punctuation">;</span>
</code></pre>
<h4 id="layout"><a name="layout" class="anchor-navigation-ex-anchor" href="#layout"><i class="fa fa-link" aria-hidden="true"></i></a><a name="layout" class="plugin-anchor" href="#layout"><i class="fa fa-link" aria-hidden="true"></i></a>Layout</h4>
<p>&#x4E3A;&#x907F;&#x514D;&#x5BF9;&#x6240;&#x6709;&#x7EC6;&#x5C0F;&#x66F4;&#x6539;&#x90FD;&#x8FDB;&#x884C;&#x6574;&#x4F53;&#x5E03;&#x5C40;&#xFF0C;&#x6D4F;&#x89C8;&#x5668;&#x91C7;&#x7528;&#x4E86;&#x4E00;&#x79CD;&#x201C;dirty &#x4F4D;&#x201D;&#x7CFB;&#x7EDF;&#x3002;
&#x5982;&#x679C;&#x67D0;&#x4E2A;&#x5448;&#x73B0;&#x5668;&#x53D1;&#x751F;&#x4E86;&#x66F4;&#x6539;&#xFF0C;&#x6216;&#x8005;&#x5C06;&#x81EA;&#x8EAB;&#x53CA;&#x5176;&#x5B50;&#x4EE3;&#x6807;&#x6CE8;&#x4E3A;&#x201C;dirty&#x201D;&#xFF0C;&#x5219;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x5E03;&#x5C40;:</p>
<ul>
<li>&#x7236;&#x5448;&#x73B0;&#x5668;&#x786E;&#x5B9A;&#x81EA;&#x5DF1;&#x7684;&#x5BBD;&#x5EA6;</li>
<li>&#x7236;&#x5448;&#x73B0;&#x5668;&#x4F9D;&#x6B21;&#x5904;&#x7406;&#x5B50;&#x5448;&#x73B0;&#x5668;&#xFF0C;&#x5E76;&#x4E14;&#xFF1A;<ul>
<li>&#x653E;&#x7F6E;&#x5B50;&#x5448;&#x73B0;&#x5668;&#xFF08;&#x8BBE;&#x7F6E; x,y &#x5750;&#x6807;&#xFF09;</li>
<li>&#x5982;&#x679C;&#x6709;&#x5FC5;&#x8981;&#xFF0C;&#x8C03;&#x7528;&#x5B50;&#x5448;&#x73B0;&#x5668;&#x7684;&#x5E03;&#x5C40;&#xFF08;&#x5982;&#x679C;&#x5B50;&#x5448;&#x73B0;&#x5668;&#x662F; dirty &#x7684;&#xFF0C;&#x6216;&#x8005;&#x8FD9;&#x662F;&#x5168;&#x5C40;&#x5E03;&#x5C40;&#xFF0C;&#x6216;&#x51FA;&#x4E8E;&#x5176;&#x4ED6;&#x67D0;&#x4E9B;&#x539F;&#x56E0;&#xFF09;&#xFF0C;
&#x8FD9;&#x4F1A;&#x8BA1;&#x7B97;&#x5B50;&#x5448;&#x73B0;&#x5668;&#x7684;&#x9AD8;&#x5EA6;</li>
</ul>
</li>
<li>&#x7236;&#x5448;&#x73B0;&#x5668;&#x6839;&#x636E;&#x5B50;&#x5448;&#x73B0;&#x5668;&#x7684;&#x7D2F;&#x52A0;&#x9AD8;&#x5EA6;&#x4EE5;&#x53CA;&#x8FB9;&#x8DDD;&#x548C;&#x8865;&#x767D;&#x7684;&#x9AD8;&#x5EA6;&#x6765;&#x8BBE;&#x7F6E;&#x81EA;&#x8EAB;&#x9AD8;&#x5EA6;&#xFF0C;&#x6B64;&#x503C;&#x4E5F;&#x53EF;&#x4F9B;&#x7236;&#x5448;&#x73B0;&#x5668;&#x7684;&#x7236;&#x5448;&#x73B0;&#x5668;&#x4F7F;&#x7528;</li>
<li>&#x5C06;&#x5176; dirty &#x4F4D;&#x8BBE;&#x7F6E;&#x4E3A; false</li>
</ul>
<h4 id="paint"><a name="paint" class="anchor-navigation-ex-anchor" href="#paint"><i class="fa fa-link" aria-hidden="true"></i></a><a name="paint" class="plugin-anchor" href="#paint"><i class="fa fa-link" aria-hidden="true"></i></a>Paint</h4>
<p>Paint Order:</p>
<ul>
<li>&#x80CC;&#x666F;&#x989C;&#x8272;</li>
<li>&#x80CC;&#x666F;&#x56FE;&#x7247;</li>
<li>&#x8FB9;&#x6846;</li>
<li>&#x5B50;&#x4EE3;</li>
<li>&#x8F6E;&#x5ED3;</li>
</ul>
<h2 id="effective-javascript"><a name="effective-javascript" class="anchor-navigation-ex-anchor" href="#effective-javascript"><i class="fa fa-link" aria-hidden="true"></i></a>5. Effective JavaScript</h2>
<h3 id="memory-leak"><a name="memory-leak" class="anchor-navigation-ex-anchor" href="#memory-leak"><i class="fa fa-link" aria-hidden="true"></i></a>5.1. Memory Leak</h3>
<ul>
<li>useless global vars (bind to window or document)</li>
<li>useless callback functions (e.g setInterval/setTimeout)</li>
<li>useless DOM reference</li>
<li>closure</li>
<li>circular reference</li>
</ul>
<h3 id="&#x7981;&#x7528;&#x7279;&#x6027;"><a name="&#x7981;&#x7528;&#x7279;&#x6027;" class="anchor-navigation-ex-anchor" href="#&#x7981;&#x7528;&#x7279;&#x6027;"><i class="fa fa-link" aria-hidden="true"></i></a>5.2. &#x7981;&#x7528;&#x7279;&#x6027;</h3>
<ul>
<li>with () {}</li>
<li>eval()</li>
<li>&#x5C11;&#x7528; new</li>
<li>&#x5C11;&#x7528; cotinue</li>
<li>&#x5C11;&#x7528; forEach()</li>
</ul>
<h3 id="&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x51FD;&#x6570;&#x53C2;&#x6570;"><a name="&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x51FD;&#x6570;&#x53C2;&#x6570;" class="anchor-navigation-ex-anchor" href="#&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x51FD;&#x6570;&#x53C2;&#x6570;"><i class="fa fa-link" aria-hidden="true"></i></a>5.3. &#x5C40;&#x90E8;&#x53D8;&#x91CF;/&#x51FD;&#x6570;&#x53C2;&#x6570;</h3>
<ul>
<li>&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x5F15;&#x7528;&#x5168;&#x5C40;&#x53D8;&#x91CF;/&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x4F20;&#x5165;&#x51FD;&#x6570;: &#x52A0;&#x5FEB;&#x7B26;&#x53F7;&#x89E3;&#x6790;</li>
<li>&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x7F13;&#x5B58; DOM &#x5143;&#x7D20;</li>
<li>&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x7F13;&#x5B58;&#x5E03;&#x5C40;&#x4FE1;&#x606F;</li>
<li>&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x5F15;&#x7528;&#x5D4C;&#x5957;&#x6210;&#x5458;: &#x52A0;&#x5FEB;&#x539F;&#x578B;&#x94FE;&#x67E5;&#x627E;</li>
<li>&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x5F15;&#x7528;&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x5E94;&#x6CE8;&#x610F;&#x4F1A;&#x52A8;&#x6001;&#x6539;&#x53D8; this &#x6307;&#x9488;</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> <span class="token constant">DOM</span> <span class="token operator">=</span> tazimi<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Dom<span class="token punctuation">;</span>

<span class="token constant">DOM</span><span class="token punctuation">.</span><span class="token function">method</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token comment">/* &#x5173;&#x6CE8; this &#x6307;&#x9488;*/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="&#x5B57;&#x7B26;&#x4E32;"><a name="&#x5B57;&#x7B26;&#x4E32;" class="anchor-navigation-ex-anchor" href="#&#x5B57;&#x7B26;&#x4E32;"><i class="fa fa-link" aria-hidden="true"></i></a>5.4. &#x5B57;&#x7B26;&#x4E32;</h3>
<pre class="language-"><code class="lang-js">str <span class="token operator">=</span> str <span class="token operator">+</span> <span class="token string">&apos;one&apos;</span> <span class="token operator">+</span> <span class="token string">&apos;two&apos;</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="&#x51FD;&#x6570;"><a name="&#x51FD;&#x6570;" class="anchor-navigation-ex-anchor" href="#&#x51FD;&#x6570;"><i class="fa fa-link" aria-hidden="true"></i></a>5.5. &#x51FD;&#x6570;</h3>
<h4 id="&#x4F5C;&#x7528;&#x57DF;&#x94FE;"><a name="&#x4F5C;&#x7528;&#x57DF;&#x94FE;" class="anchor-navigation-ex-anchor" href="#&#x4F5C;&#x7528;&#x57DF;&#x94FE;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x4F5C;&#x7528;&#x57DF;&#x94FE;" class="plugin-anchor" href="#&#x4F5C;&#x7528;&#x57DF;&#x94FE;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x4F5C;&#x7528;&#x57DF;&#x94FE;</h4>
<p>&#x7531;&#x4E8E;&#x4F5C;&#x7528;&#x57DF;&#x94FE;&#x7684;&#x5173;&#x7CFB;&#xFF0C;&#x6807;&#x8BC6;&#x7B26;&#x89E3;&#x6790;&#x65F6;&#xFF0C;&#x5BFB;&#x627E;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x901F;&#x5EA6;&#x8FDC;&#x5FEB;&#x4E8E;&#x5BFB;&#x627E;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x901F;&#x5EA6;.&#x6545;&#x5E94;&#x5C06;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x4F20;&#x5165;&#x51FD;&#x6570;&#x8FDB;&#x884C;&#x8C03;&#x7528;&#xFF0C;&#x4E0D;&#x4F46;&#x6548;&#x7387;&#x9AD8;&#xFF0C;&#x800C;&#x4E14;&#x6613;&#x4E8E;&#x7EF4;&#x62A4;&#x4E0E;&#x6D4B;&#x8BD5;.
&#x5373; &#x5229;&#x7528;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x5F15;&#x7528;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#xFF0C;&#x52A0;&#x5FEB;&#x6807;&#x8BC6;&#x7B26;&#x89E3;&#x6790;</p>
<h3 id="&#x5FAA;&#x73AF;"><a name="&#x5FAA;&#x73AF;" class="anchor-navigation-ex-anchor" href="#&#x5FAA;&#x73AF;"><i class="fa fa-link" aria-hidden="true"></i></a>5.6. &#x5FAA;&#x73AF;</h3>
<h4 id="&#x5012;&#x5E8F;&#x5FAA;&#x73AF;&#x53EF;&#x63D0;&#x5347;&#x6027;&#x80FD;"><a name="&#x5012;&#x5E8F;&#x5FAA;&#x73AF;&#x53EF;&#x63D0;&#x5347;&#x6027;&#x80FD;" class="anchor-navigation-ex-anchor" href="#&#x5012;&#x5E8F;&#x5FAA;&#x73AF;&#x53EF;&#x63D0;&#x5347;&#x6027;&#x80FD;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x5012;&#x5E8F;&#x5FAA;&#x73AF;&#x53EF;&#x63D0;&#x5347;&#x6027;&#x80FD;" class="plugin-anchor" href="#&#x5012;&#x5E8F;&#x5FAA;&#x73AF;&#x53EF;&#x63D0;&#x5347;&#x6027;&#x80FD;"><i class="fa fa-link" aria-hidden="true"></i></a><strong>&#x5012;&#x5E8F;</strong>&#x5FAA;&#x73AF;&#x53EF;&#x63D0;&#x5347;&#x6027;&#x80FD;</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> item<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">;</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">process</span><span class="token punctuation">(</span>items<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> j <span class="token operator">=</span> items<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>j<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">process</span><span class="token punctuation">(</span>items<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> k <span class="token operator">=</span> items<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
<span class="token keyword">do</span> <span class="token punctuation">{</span>
  <span class="token function">process</span><span class="token punctuation">(</span>items<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>k<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="duffs-device&#x8FBE;&#x592B;&#x8BBE;&#x5907;"><a name="duffs-device&#x8FBE;&#x592B;&#x8BBE;&#x5907;" class="anchor-navigation-ex-anchor" href="#duffs-device&#x8FBE;&#x592B;&#x8BBE;&#x5907;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="duffs-device&#x8FBE;&#x592B;&#x8BBE;&#x5907;" class="plugin-anchor" href="#duffs-device&#x8FBE;&#x592B;&#x8BBE;&#x5907;"><i class="fa fa-link" aria-hidden="true"></i></a>Duff&apos;s Device(&#x8FBE;&#x592B;&#x8BBE;&#x5907;)</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">let</span> i <span class="token operator">=</span> items<span class="token punctuation">.</span>length <span class="token operator">%</span> <span class="token number">8</span><span class="token punctuation">;</span>

<span class="token keyword">while</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">process</span><span class="token punctuation">(</span>items<span class="token punctuation">[</span>i<span class="token operator">--</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

i <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>items<span class="token punctuation">.</span>length <span class="token operator">/</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">while</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">process</span><span class="token punctuation">(</span>items<span class="token punctuation">[</span>i<span class="token operator">--</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">process</span><span class="token punctuation">(</span>items<span class="token punctuation">[</span>i<span class="token operator">--</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">process</span><span class="token punctuation">(</span>items<span class="token punctuation">[</span>i<span class="token operator">--</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">process</span><span class="token punctuation">(</span>items<span class="token punctuation">[</span>i<span class="token operator">--</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">process</span><span class="token punctuation">(</span>items<span class="token punctuation">[</span>i<span class="token operator">--</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">process</span><span class="token punctuation">(</span>items<span class="token punctuation">[</span>i<span class="token operator">--</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">process</span><span class="token punctuation">(</span>items<span class="token punctuation">[</span>i<span class="token operator">--</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">process</span><span class="token punctuation">(</span>items<span class="token punctuation">[</span>i<span class="token operator">--</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="exception"><a name="exception" class="anchor-navigation-ex-anchor" href="#exception"><i class="fa fa-link" aria-hidden="true"></i></a>5.7. Exception</h3>
<h4 id="call-stack-overflow"><a name="call-stack-overflow" class="anchor-navigation-ex-anchor" href="#call-stack-overflow"><i class="fa fa-link" aria-hidden="true"></i></a><a name="call-stack-overflow" class="plugin-anchor" href="#call-stack-overflow"><i class="fa fa-link" aria-hidden="true"></i></a>Call Stack Overflow</h4>
<p>&#x8C03;&#x7528;&#x6808;&#x5C3A;&#x5BF8;&#x9650;&#x5236;&#x5F02;&#x5E38;&#xFF0C;&#x5E94;&#x7ACB;&#x5373;&#x5B9A;&#x4F4D;&#x5728;&#x4EE3;&#x7801;&#x4E2D;&#x7684;&#x9012;&#x5F52;&#x5B9E;&#x4F8B;&#x4E0A;</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token function">recursion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&apos;error info&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="event-delegate&#x4E8B;&#x4EF6;&#x59D4;&#x6258;"><a name="event-delegate&#x4E8B;&#x4EF6;&#x59D4;&#x6258;" class="anchor-navigation-ex-anchor" href="#event-delegate&#x4E8B;&#x4EF6;&#x59D4;&#x6258;"><i class="fa fa-link" aria-hidden="true"></i></a>5.8. Event Delegate(&#x4E8B;&#x4EF6;&#x59D4;&#x6258;)</h3>
<ul>
<li>&#x4E8B;&#x4EF6;&#x59D4;&#x6258;&#x5229;&#x7528;&#x7684;&#x662F;&#x4E8B;&#x4EF6;&#x5192;&#x6CE1;&#x673A;&#x5236;&#xFF0C;&#x53EA;&#x5236;&#x5B9A;&#x4E00;&#x4E8B;&#x4EF6;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x7BA1;&#x7406;&#x67D0;&#x4E00;&#x7C7B;&#x578B;&#x7684;&#x6240;&#x6709;&#x4E8B;&#x4EF6;</li>
<li>&#x4F7F;&#x7528;&#x4E8B;&#x4EF6;&#x59D4;&#x6258;&#xFF0C;&#x53EA;&#x9700;&#x5728; DOM &#x6811;&#x4E2D;&#x5C3D;&#x91CF;&#x6700;&#x9AD8;&#x7684;&#x5C42;&#x6B21;&#x4E0A;&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x4E8B;&#x4EF6;&#x5904;&#x7406;&#x7A0B;&#x5E8F;</li>
<li>increases performance and reduces memory consumption</li>
<li>no need to register new event listeners for newer children</li>
</ul>
<pre class="language-"><code class="lang-js">window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> oUl <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&apos;ul&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> aLi <span class="token operator">=</span> oUl<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">&apos;li&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  oUl<span class="token punctuation">.</span><span class="token function-variable function">onmouseover</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> e <span class="token operator">=</span> e <span class="token operator">||</span> window<span class="token punctuation">.</span>event<span class="token punctuation">;</span>
    <span class="token keyword">const</span> target <span class="token operator">=</span> e<span class="token punctuation">.</span>target <span class="token operator">||</span> e<span class="token punctuation">.</span>srcElement<span class="token punctuation">;</span>

    <span class="token comment">//alert(target.innerHTML);</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">.</span>nodeName<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&apos;li&apos;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      target<span class="token punctuation">.</span>style<span class="token punctuation">.</span>background <span class="token operator">=</span> <span class="token string">&apos;red&apos;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// &#x963B;&#x6B62;&#x9ED8;&#x8BA4;&#x884C;&#x4E3A;&#x5E76;&#x53D6;&#x6D88;&#x5192;&#x6CE1;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> e<span class="token punctuation">.</span>preventDefault <span class="token operator">===</span> <span class="token string">&apos;function&apos;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      e<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      e<span class="token punctuation">.</span>returnValue <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      e<span class="token punctuation">.</span>cancelBubble <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  oUl<span class="token punctuation">.</span><span class="token function-variable function">onmouseout</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> e <span class="token operator">=</span> e <span class="token operator">||</span> window<span class="token punctuation">.</span>event<span class="token punctuation">;</span>
    <span class="token keyword">const</span> target <span class="token operator">=</span> e<span class="token punctuation">.</span>target <span class="token operator">||</span> e<span class="token punctuation">.</span>srcElement<span class="token punctuation">;</span>

    <span class="token comment">//alert(target.innerHTML);</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">.</span>nodeName<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&apos;li&apos;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      target<span class="token punctuation">.</span>style<span class="token punctuation">.</span>background <span class="token operator">=</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// &#x963B;&#x6B62;&#x9ED8;&#x8BA4;&#x884C;&#x4E3A;&#x5E76;&#x53D6;&#x6D88;&#x5192;&#x6CE1;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> e<span class="token punctuation">.</span>preventDefault <span class="token operator">===</span> <span class="token string">&apos;function&apos;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      e<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      e<span class="token punctuation">.</span>returnValue <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      e<span class="token punctuation">.</span>cancelBubble <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="&#x7F13;&#x5B58;&#x6A21;&#x5F0F;"><a name="&#x7F13;&#x5B58;&#x6A21;&#x5F0F;" class="anchor-navigation-ex-anchor" href="#&#x7F13;&#x5B58;&#x6A21;&#x5F0F;"><i class="fa fa-link" aria-hidden="true"></i></a>5.9. &#x7F13;&#x5B58;&#x6A21;&#x5F0F;</h3>
<p>&#x7F13;&#x5B58;&#x5BF9;&#x8C61;&#x5C5E;&#x6027;&#x4E0E; DOM &#x5BF9;&#x8C61;</p>
<h3 id="&#x52A0;&#x8F7D;&#x811A;&#x672C;"><a name="&#x52A0;&#x8F7D;&#x811A;&#x672C;" class="anchor-navigation-ex-anchor" href="#&#x52A0;&#x8F7D;&#x811A;&#x672C;"><i class="fa fa-link" aria-hidden="true"></i></a>5.10. &#x52A0;&#x8F7D;&#x811A;&#x672C;</h3>
<p>&#x5408;&#x5E76;&#x811A;&#x672C;&#x540E;&#x518D;&#x8FDB;&#x884C;&#x9AD8;&#x7EA7;&#x52A0;&#x8F7D;&#x6280;&#x672F;</p>
<h4 id="&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;"><a name="&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;" class="anchor-navigation-ex-anchor" href="#&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;" class="plugin-anchor" href="#&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;</h4>
<pre class="language-"><code class="lang-html">... The full body of the page ...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span>
window.onload = function () {
  const script = document.createElement(&quot;script&quot;);
  script.src = &quot;all_lazy_20100426.js&quot;;
  document.documentElement.firstChild.appendChild(script);
};
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h4 id="&#x52A8;&#x6001;&#x52A0;&#x8F7D;"><a name="&#x52A8;&#x6001;&#x52A0;&#x8F7D;" class="anchor-navigation-ex-anchor" href="#&#x52A8;&#x6001;&#x52A0;&#x8F7D;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x52A8;&#x6001;&#x52A0;&#x8F7D;" class="plugin-anchor" href="#&#x52A8;&#x6001;&#x52A0;&#x8F7D;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x52A8;&#x6001;&#x52A0;&#x8F7D;</h4>
<pre class="language-"><code class="lang-javascript"><span class="token keyword">function</span> <span class="token function">requireScript</span><span class="token punctuation">(</span><span class="token parameter">file<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">&apos;script&apos;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> newjs <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&apos;script&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// IE</span>
  newjs<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>newjs<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token string">&apos;loaded&apos;</span> <span class="token operator">||</span> newjs<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token string">&apos;complete&apos;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      newjs<span class="token punctuation">.</span>onreadystatechange <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token comment">// others</span>
  newjs<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">// &#x6DFB;&#x52A0;&#x81F3;html&#x9875;&#x9762;</span>
  newjs<span class="token punctuation">.</span>src <span class="token operator">=</span> file<span class="token punctuation">;</span>
  script<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>newjs<span class="token punctuation">,</span> script<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">requireScript</span><span class="token punctuation">(</span><span class="token string">&apos;the_rest.js&apos;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Application<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="dom-performance"><a name="dom-performance" class="anchor-navigation-ex-anchor" href="#dom-performance"><i class="fa fa-link" aria-hidden="true"></i></a>5.11. DOM Performance</h3>
<ul>
<li>&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x7F13;&#x5B58; DOM &#x5143;&#x7D20;</li>
<li>&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x7F13;&#x5B58;&#x5E03;&#x5C40;&#x4FE1;&#x606F;</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&apos;btn&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<ul>
<li>HTML Collection &#x8F6C;&#x5316;&#x6210;&#x6570;&#x7EC4;&#x518D;&#x64CD;&#x4F5C;</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span> <span class="token function">toArray</span><span class="token punctuation">(</span><span class="token parameter">coll</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> len <span class="token operator">=</span> coll<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> coll<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> a<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<ul>
<li>children &#x4F18;&#x4E8E; childNodes</li>
<li>childElementCount &#x4F18;&#x4E8E; childNodes.length</li>
<li>firstElementChild &#x4F18;&#x4E8E; firstChild</li>
<li>lastElementChild &#x4F18;&#x4E8E; lastChild</li>
<li>nextElementSibling &#x4F18;&#x4E8E; nextSibling &#x4F18;&#x4E8E; <code>childNodes[next]</code></li>
<li>previousElementSibling &#x4F18;&#x4E8E; previousSibling</li>
</ul>
<h4 id="&#x91CD;&#x6392;&#x4E0E;&#x91CD;&#x7ED8;"><a name="&#x91CD;&#x6392;&#x4E0E;&#x91CD;&#x7ED8;" class="anchor-navigation-ex-anchor" href="#&#x91CD;&#x6392;&#x4E0E;&#x91CD;&#x7ED8;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x91CD;&#x6392;&#x4E0E;&#x91CD;&#x7ED8;" class="plugin-anchor" href="#&#x91CD;&#x6392;&#x4E0E;&#x91CD;&#x7ED8;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x91CD;&#x6392;&#x4E0E;&#x91CD;&#x7ED8;</h4>
<ul>
<li>&#x91CD;&#x6392;: &#x91CD;&#x65B0;&#x6784;&#x9020;&#x6E32;&#x67D3;&#x6811;</li>
<li>&#x91CD;&#x7ED8;: &#x91CD;&#x65B0;&#x7ED8;&#x5236;&#x53D7;&#x5F71;&#x54CD;&#x90E8;&#x5206;</li>
</ul>
<p><strong>&#x83B7;&#x53D6;</strong>&#x6216;&#x6539;&#x53D8;&#x5E03;&#x5C40;&#x7684;&#x64CD;&#x4F5C;&#x4F1A;&#x5BFC;&#x81F4;&#x6E32;&#x67D3;&#x6811;<strong>&#x53D8;&#x5316;&#x961F;&#x5217;</strong>&#x5237;&#x65B0;,&#x6267;&#x884C;&#x6E32;&#x67D3;&#x961F;&#x5217;&#x4E2D;&#x7684;&quot;&#x5F85;&#x5904;&#x7406;&#x53D8;&#x5316;&quot;,&#x91CD;&#x6392; DOM &#x5143;&#x7D20;</p>
<pre class="language-"><code class="lang-js">offsetTop <span class="token operator">/</span> Left <span class="token operator">/</span> Width <span class="token operator">/</span> Height<span class="token punctuation">;</span>
scrollTop <span class="token operator">/</span> Left <span class="token operator">/</span> Width <span class="token operator">/</span> Height<span class="token punctuation">;</span>
clientTop <span class="token operator">/</span> Left <span class="token operator">/</span> Width <span class="token operator">/</span> Height<span class="token punctuation">;</span>
<span class="token function">getComputedStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="&#x6279;&#x91CF;&#x4FEE;&#x6539;-dom"><a name="&#x6279;&#x91CF;&#x4FEE;&#x6539;-dom" class="anchor-navigation-ex-anchor" href="#&#x6279;&#x91CF;&#x4FEE;&#x6539;-dom"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x6279;&#x91CF;&#x4FEE;&#x6539;-dom" class="plugin-anchor" href="#&#x6279;&#x91CF;&#x4FEE;&#x6539;-dom"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6279;&#x91CF;&#x4FEE;&#x6539; DOM</h4>
<ul>
<li>&#x5148; display=&quot;none&quot;, &#x4FEE;&#x6539;&#x5B8C;&#x6210;&#x540E;&#xFF0C;display=&quot;&quot;</li>
<li>&#x4F7F;&#x5F85;&#x4FEE;&#x6539; DOM &#x5143;&#x7D20;&#x8131;&#x79BB;&#x6807;&#x51C6;&#x6587;&#x6863;&#x6D41;(&#x6539;&#x53D8;&#x5E03;&#x5C40;&#xFF0F;&#x5B9A;&#x4F4D;&#x65B9;&#x5F0F;)&#xFF0C;&#x53EF;&#x51CF;&#x5C11;&#x5176;&#x4ED6;&#x5143;&#x7D20;&#x7684;&#x91CD;&#x7ED8;&#x6B21;&#x6570;</li>
<li>document.createDocumentFragment()</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> fragment <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createDocumentFragment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">appendDataToElement</span><span class="token punctuation">(</span>fragment<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&apos;mylist&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>fragment<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<ul>
<li>oldNode.cloneNode(true);</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> old <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&apos;mylist&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> clone <span class="token operator">=</span> old<span class="token punctuation">.</span><span class="token function">cloneNode</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">appendDataToElement</span><span class="token punctuation">(</span>clone<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
old<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">replaceChild</span><span class="token punctuation">(</span>clone<span class="token punctuation">,</span> old<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="requestanimationframe"><a name="requestanimationframe" class="anchor-navigation-ex-anchor" href="#requestanimationframe"><i class="fa fa-link" aria-hidden="true"></i></a><a name="requestanimationframe" class="plugin-anchor" href="#requestanimationframe"><i class="fa fa-link" aria-hidden="true"></i></a>requestAnimationFrame</h4>
<p>run scripts as early as possible:
<code>requestAnimationFrame()</code> runs after the CPU work is done (UI events and JS scripts),
and just before the frame is rendered (layout, paint, composite etc.).</p>
<h3 id="css"><a name="css" class="anchor-navigation-ex-anchor" href="#css"><i class="fa fa-link" aria-hidden="true"></i></a>5.12. CSS</h3>
<p>&#x5728; js &#x4E2D;(&#x9664;&#x5B9A;&#x4F4D;&#x5C5E;&#x6027;) &#x5916;&#xFF0C;&#x4E0D;&#x76F4;&#x63A5;&#x64CD;&#x4F5C; element.style.attr/element.cssText:</p>
<pre class="language-"><code class="lang-js">element<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&apos;className&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
element<span class="token punctuation">.</span>className <span class="token operator">+=</span> <span class="token string">&apos; className&apos;</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js">script <span class="token operator">-</span><span class="token operator">&gt;</span> style <span class="token operator">-</span><span class="token operator">&gt;</span> layout <span class="token operator">-</span><span class="token operator">&gt;</span> paint <span class="token operator">-</span><span class="token operator">&gt;</span> composite
</code></pre>
<p>Make <code>script</code> stage become: read then write.
Interleaved read and write will triger multiple times
of relayout/repaint/recomposite.</p>
<pre class="language-"><code class="lang-js"><span class="token comment">// bad</span>
<span class="token comment">// Forced Synchronous Layout</span>
read css <span class="token operator">-</span><span class="token operator">&gt;</span> write <span class="token function">css</span> <span class="token punctuation">(</span>re<span class="token operator">-</span>layout<span class="token operator">/</span>paint<span class="token operator">/</span>composite<span class="token punctuation">)</span>
<span class="token operator">-</span><span class="token operator">&gt;</span> read css <span class="token operator">-</span><span class="token operator">&gt;</span> write <span class="token function">css</span> <span class="token punctuation">(</span>re<span class="token operator">-</span>layout<span class="token operator">/</span>paint<span class="token operator">/</span>composite<span class="token punctuation">)</span>
<span class="token operator">-</span><span class="token operator">&gt;</span> read css <span class="token operator">-</span><span class="token operator">&gt;</span> write <span class="token function">css</span> <span class="token punctuation">(</span>re<span class="token operator">-</span>layout<span class="token operator">/</span>paint<span class="token operator">/</span>composite<span class="token punctuation">)</span>

<span class="token comment">// good</span>
read css <span class="token operator">-</span><span class="token operator">&gt;</span> write <span class="token function">css</span> <span class="token punctuation">(</span>only re<span class="token operator">-</span>layout<span class="token operator">/</span>paint<span class="token operator">/</span>composite once<span class="token punctuation">)</span>
</code></pre>
<h3 id="&#x5B9A;&#x65F6;&#x5668;&#x9632;&#x6B62;&#x811A;&#x672C;&#x963B;&#x585E;"><a name="&#x5B9A;&#x65F6;&#x5668;&#x9632;&#x6B62;&#x811A;&#x672C;&#x963B;&#x585E;" class="anchor-navigation-ex-anchor" href="#&#x5B9A;&#x65F6;&#x5668;&#x9632;&#x6B62;&#x811A;&#x672C;&#x963B;&#x585E;"><i class="fa fa-link" aria-hidden="true"></i></a>5.13. &#x5B9A;&#x65F6;&#x5668;(&#x9632;&#x6B62;&#x811A;&#x672C;&#x963B;&#x585E;)</h3>
<p>JavaScript &#x3000;&#x4EE3;&#x7801;&#x4E0E; UI &#x5171;&#x4EAB;&#x7EBF;&#x7A0B;</p>
<p>setTimeout()/setInterval()</p>
<ul>
<li>&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;: &#x4E0D;&#x662F;&#x6267;&#x884C;&#x65F6;&#x95F4;, &#x662F;&#x52A0;&#x5165;&#x6267;&#x884C;&#x961F;&#x5217;&#x65F6;&#x95F4;</li>
<li>&#x82E5;&#x5176;&#x4ED6;&#x4F4D;&#x4E8E;&#x6267;&#x884C;&#x961F;&#x5217;&#x4E2D;&#x7684;&#x51FD;&#x6570;&#x6267;&#x884C;&#x65F6;&#x95F4;&#x8D85;&#x8FC7;&#x5EF6;&#x65F6;&#xFF0C;&#x5219;&#x7528;&#x6237;&#x611F;&#x89C9;&#x4E0D;&#x5230;&#x5EF6;&#x65F6;&#x7684;&#x5B58;&#x5728;</li>
<li>&#x6A21;&#x62DF;&#x6709;&#x95F4;&#x9699;&#x7684;&#x5FAA;&#x73AF;&#xFF0C;&#x4F7F;&#x5F97; UI &#x66F4;&#x65B0;&#x5F97;&#x4EE5;&#x8FDB;&#x5165;&#x6D4F;&#x89C8;&#x5668;&#x7EBF;&#x7A0B;&#x7684;&#x6267;&#x884C;&#x961F;&#x5217;&#x4E2D;</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> button <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&apos;myButton&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

button<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">oneMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&apos;notice&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">&apos;red&apos;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<ul>
<li>&#x5206;&#x89E3;&#x4EFB;&#x52A1;</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span> <span class="token function">saveDocument</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// &#x5229;&#x7528;&#x95ED;&#x5305;&#x5C01;&#x88C5;&#x5F85;&#x6267;&#x884C;&#x4EFB;&#x52A1;</span>
  <span class="token keyword">const</span> tasks <span class="token operator">=</span> <span class="token punctuation">[</span>openDocument<span class="token punctuation">,</span> writeText<span class="token punctuation">,</span> closeDocument<span class="token punctuation">,</span> updateUI<span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// &#x6267;&#x884C;&#x4E0B;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;</span>
    <span class="token keyword">const</span> task <span class="token operator">=</span> tasks<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">task</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// &#x68C0;&#x67E5;&#x662F;&#x5426;&#x8FD8;&#x6709;&#x5176;&#x4ED6;&#x4EFB;&#x52A1;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tasks<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// &#x9012;&#x5F52;&#x8C03;&#x7528;(&#x6BCF;&#x6B21;&#x53C2;&#x6570;&#x4E0D;&#x540C;)</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>callee<span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span> <span class="token function">processArray</span><span class="token punctuation">(</span><span class="token parameter">items<span class="token punctuation">,</span> process<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// &#x514B;&#x9686;&#x539F;&#x6570;&#x7EC4;</span>
  <span class="token keyword">const</span> todo <span class="token operator">=</span> items<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">process</span><span class="token punctuation">(</span>todo<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>todo<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>callee<span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">callback</span><span class="token punctuation">(</span>items<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<ul>
<li>&#x6279;&#x5904;&#x7406;&#x4EFB;&#x52A1;</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span> <span class="token function">timedProcessArray</span><span class="token punctuation">(</span><span class="token parameter">items<span class="token punctuation">,</span> process<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// &#x514B;&#x9686;&#x539F;&#x59CB;&#x6570;&#x7EC4;</span>
  <span class="token keyword">const</span> todo <span class="token operator">=</span> items<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> start <span class="token operator">=</span> <span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// &#x4E00;&#x6B21;&#x6279;&#x5904;&#x7406;&#x4EFB;&#x52A1;&#x6301;&#x7EED; 0.05s</span>
    <span class="token keyword">do</span> <span class="token punctuation">{</span>
      <span class="token function">process</span><span class="token punctuation">(</span>todo<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>todo<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start <span class="token operator">&lt;</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>todo<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>callee<span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">callback</span><span class="token punctuation">(</span>items<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x8BA1;&#x65F6;&#x5668;"><a name="&#x8BA1;&#x65F6;&#x5668;" class="anchor-navigation-ex-anchor" href="#&#x8BA1;&#x65F6;&#x5668;"><i class="fa fa-link" aria-hidden="true"></i></a>5.14. &#x8BA1;&#x65F6;&#x5668;</h3>
<pre class="language-"><code class="lang-js"><span class="token comment">/*
 * usage: start -&gt; stop -&gt; getTime
 */</span>
<span class="token keyword">const</span> Timer <span class="token operator">=</span> <span class="token punctuation">{</span>
  _data<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function-variable function">start</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Timer<span class="token punctuation">.</span>_data<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">stop</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> time <span class="token operator">=</span> Timer<span class="token punctuation">.</span>_data<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>time<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      Timer<span class="token punctuation">.</span>_data<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> time<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">getTime</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Timer<span class="token punctuation">.</span>_data<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="web-worker"><a name="web-worker" class="anchor-navigation-ex-anchor" href="#web-worker"><i class="fa fa-link" aria-hidden="true"></i></a>5.15. Web Worker</h3>
<h4 id="&#x8FD0;&#x884C;&#x73AF;&#x5883;"><a name="&#x8FD0;&#x884C;&#x73AF;&#x5883;" class="anchor-navigation-ex-anchor" href="#&#x8FD0;&#x884C;&#x73AF;&#x5883;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x8FD0;&#x884C;&#x73AF;&#x5883;" class="plugin-anchor" href="#&#x8FD0;&#x884C;&#x73AF;&#x5883;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x8FD0;&#x884C;&#x73AF;&#x5883;</h4>
<ul>
<li>navigation &#x5BF9;&#x8C61;: appName, appVersion, userAgent, platform</li>
<li>location &#x5BF9;&#x8C61;: &#x6240;&#x6709;&#x5C5E;&#x6027;&#x53EA;&#x8BFB;</li>
<li>ECMAScript &#x5BF9;&#x8C61;: Object/Array/Date</li>
<li>XMLHttpRequest &#x65B9;&#x6CD5;</li>
<li>setTimeout/setInterval &#x65B9;&#x6CD5;</li>
<li>self &#x5BF9;&#x8C61;: &#x6307;&#x5411;&#x5168;&#x5C40; worker &#x5BF9;&#x8C61;</li>
<li>importScripts &#x65B9;&#x6CD5;: &#x52A0;&#x8F7D;&#x5916;&#x90E8;&#x4F9D;&#x8D56;</li>
<li>close &#x65B9;&#x6CD5;: &#x505C;&#x6B62; worker</li>
</ul>
<h4 id="web-worker-loader"><a name="web-worker-loader" class="anchor-navigation-ex-anchor" href="#web-worker-loader"><i class="fa fa-link" aria-hidden="true"></i></a><a name="web-worker-loader" class="plugin-anchor" href="#web-worker-loader"><i class="fa fa-link" aria-hidden="true"></i></a>Web Worker Loader</h4>
<pre class="language-"><code class="lang-js"><span class="token comment">// &#x6587;&#x4EF6;&#x540D;&#x4E3A;index.js</span>
<span class="token keyword">function</span> <span class="token function">work</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data<span class="token operator">:</span> <span class="token punctuation">{</span> jobId<span class="token punctuation">,</span> message <span class="token punctuation">}</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;i am worker, receive:-----&apos;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span> jobId<span class="token punctuation">,</span> result<span class="token operator">:</span> <span class="token string">&apos;message from worker&apos;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">makeWorker</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">f</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> pendingJobs <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> worker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Worker</span><span class="token punctuation">(</span>
    <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>f<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)()</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  worker<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data<span class="token operator">:</span> <span class="token punctuation">{</span> result<span class="token punctuation">,</span> jobId <span class="token punctuation">}</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// &#x8C03;&#x7528; resolve, &#x6539;&#x53D8; Promise &#x72B6;&#x6001;</span>
    pendingJobs<span class="token punctuation">[</span>jobId<span class="token punctuation">]</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">delete</span> pendingJobs<span class="token punctuation">[</span>jobId<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>message</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> jobId <span class="token operator">=</span> <span class="token function">String</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      pendingJobs<span class="token punctuation">[</span>jobId<span class="token punctuation">]</span> <span class="token operator">=</span> resolve<span class="token punctuation">;</span>
      worker<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span> jobId<span class="token punctuation">,</span> message <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> testWorker <span class="token operator">=</span> <span class="token function">makeWorker</span><span class="token punctuation">(</span>work<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">testWorker</span><span class="token punctuation">(</span><span class="token string">&apos;message from main thread&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;i am main thread, i receive:-----&apos;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="worker-&#x5B9E;&#x4F8B;"><a name="worker-&#x5B9E;&#x4F8B;" class="anchor-navigation-ex-anchor" href="#worker-&#x5B9E;&#x4F8B;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="worker-&#x5B9E;&#x4F8B;" class="plugin-anchor" href="#worker-&#x5B9E;&#x4F8B;"><i class="fa fa-link" aria-hidden="true"></i></a>worker &#x5B9E;&#x4F8B;</h4>
<ul>
<li>&#x5148; on ,&#x540E; post</li>
<li>main.js/worker.js &#x7684; onmessage &#x4E0E; postMessage &#x76F8;&#x4E92;&#x89E6;&#x53D1;</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">/*
 * jsonparser.js
 */</span>
self<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> jsonText <span class="token operator">=</span> event<span class="token punctuation">.</span>data<span class="token punctuation">,</span>
    jsonData <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>jsonText<span class="token punctuation">)</span><span class="token punctuation">;</span>

  self<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>jsonData<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token comment">/*
 * main.js
 */</span>
<span class="token keyword">const</span> worker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Worker</span><span class="token punctuation">(</span><span class="token string">&apos;jsonparse.js&apos;</span><span class="token punctuation">;</span>

worker<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> jsonData <span class="token operator">=</span> event<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
  <span class="token function">evaluateData</span><span class="token punctuation">(</span>jsonData<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

worker<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>jsonText<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="ajax"><a name="ajax" class="anchor-navigation-ex-anchor" href="#ajax"><i class="fa fa-link" aria-hidden="true"></i></a>5.16. Ajax</h3>
<h4 id="&#x6570;&#x636E;&#x683C;&#x5F0F;"><a name="&#x6570;&#x636E;&#x683C;&#x5F0F;" class="anchor-navigation-ex-anchor" href="#&#x6570;&#x636E;&#x683C;&#x5F0F;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x6570;&#x636E;&#x683C;&#x5F0F;" class="plugin-anchor" href="#&#x6570;&#x636E;&#x683C;&#x5F0F;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6570;&#x636E;&#x683C;&#x5F0F;</h4>
<table>
<thead>
<tr>
<th style="text-align:left">Format</th>
<th style="text-align:right">Size (bytes)</th>
<th style="text-align:right">Download (ms)</th>
<th style="text-align:right">Parse (ms)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Verbose XML</td>
<td style="text-align:right">582,960</td>
<td style="text-align:right">999.4</td>
<td style="text-align:right">343.1</td>
</tr>
<tr>
<td style="text-align:left">Verbose JSON-P</td>
<td style="text-align:right">487,913</td>
<td style="text-align:right">598.2</td>
<td style="text-align:right">0.0</td>
</tr>
<tr>
<td style="text-align:left">Simple XML</td>
<td style="text-align:right">437,960</td>
<td style="text-align:right">475.1</td>
<td style="text-align:right">83.1</td>
</tr>
<tr>
<td style="text-align:left">Verbose JSON</td>
<td style="text-align:right">487,895</td>
<td style="text-align:right">527.7</td>
<td style="text-align:right">26.7</td>
</tr>
<tr>
<td style="text-align:left">Simple JSON</td>
<td style="text-align:right">392,895</td>
<td style="text-align:right">498.7</td>
<td style="text-align:right">29.0</td>
</tr>
<tr>
<td style="text-align:left">Simple JSON-P</td>
<td style="text-align:right">392,913</td>
<td style="text-align:right">454.0</td>
<td style="text-align:right">3.1</td>
</tr>
<tr>
<td style="text-align:left">Array JSON</td>
<td style="text-align:right">292,895</td>
<td style="text-align:right">305.4</td>
<td style="text-align:right">18.6</td>
</tr>
<tr>
<td style="text-align:left">Array JSON-P</td>
<td style="text-align:right">292,912</td>
<td style="text-align:right">316.0</td>
<td style="text-align:right">3.4</td>
</tr>
<tr>
<td style="text-align:left">Custom Format (script insertion)</td>
<td style="text-align:right">222,912</td>
<td style="text-align:right">66.3</td>
<td style="text-align:right">11.7</td>
</tr>
<tr>
<td style="text-align:left">Custom Format (XHR)</td>
<td style="text-align:right">222,892</td>
<td style="text-align:right">63.1</td>
<td style="text-align:right">14.5</td>
</tr>
</tbody>
</table>
<h4 id="ajax-&#x7F13;&#x5B58;"><a name="ajax-&#x7F13;&#x5B58;" class="anchor-navigation-ex-anchor" href="#ajax-&#x7F13;&#x5B58;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="ajax-&#x7F13;&#x5B58;" class="plugin-anchor" href="#ajax-&#x7F13;&#x5B58;"><i class="fa fa-link" aria-hidden="true"></i></a>Ajax &#x7F13;&#x5B58;</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> localCache <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">xhrRequest</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Check the local cache for this URL.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>localCache<span class="token punctuation">[</span>url<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    callback<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>localCache<span class="token punctuation">[</span>url<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// If this URL wasn&apos;t found in the cache, make the request.</span>
  <span class="token keyword">const</span> req <span class="token operator">=</span> <span class="token function">createXhrObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  req<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    callback<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  req<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>responseText <span class="token operator">===</span> <span class="token string">&apos;&apos;</span> <span class="token operator">||</span> req<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token string">&apos;404&apos;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        callback<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// Store the response on the local cache.</span>
      localCache<span class="token punctuation">[</span>url<span class="token punctuation">]</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>responseText<span class="token punctuation">;</span>
      callback<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

req<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&apos;GET&apos;</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// req.set();</span>
req<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="reduce-repeat-manipulation"><a name="reduce-repeat-manipulation" class="anchor-navigation-ex-anchor" href="#reduce-repeat-manipulation"><i class="fa fa-link" aria-hidden="true"></i></a>5.17. Reduce Repeat Manipulation</h3>
<ul>
<li>&#x7279;&#x6027;/&#x6D4F;&#x89C8;&#x5668;&#x68C0;&#x6D4B;&#x4EE3;&#x7801;&#x53EA;&#x8FD0;&#x884C;&#x4E00;&#x6B21;</li>
<li>&#x60F0;&#x6027;&#x5B9A;&#x4E49;&#x6A21;&#x5F0F;/&#x81EA;&#x5B9A;&#x4E49;&#x6A21;&#x5F0F;</li>
</ul>
<h4 id="debounce-and-throttle"><a name="debounce-and-throttle" class="anchor-navigation-ex-anchor" href="#debounce-and-throttle"><i class="fa fa-link" aria-hidden="true"></i></a><a name="debounce-and-throttle" class="plugin-anchor" href="#debounce-and-throttle"><i class="fa fa-link" aria-hidden="true"></i></a>Debounce and Throttle</h4>
<p>&#x9632;&#x6296;&#x52A8;&#x548C;&#x8282;&#x6D41;&#x672C;&#x8D28;&#x662F;&#x4E0D;&#x4E00;&#x6837;&#x7684;:</p>
<ul>
<li>debounce: &#x9632;&#x6296;&#x52A8;&#x662F;&#x5C06;&#x591A;&#x6B21;&#x6267;&#x884C;&#x53D8;&#x4E3A;&#x6700;&#x540E;&#x4E00;&#x6B21;&#x6267;&#x884C; (&#x53EF;&#x7528;&#x4E8E;&#x68C0;&#x6D4B;&#x67D0;&#x4E2A;&#x8FDE;&#x7EED;&#x7684; DOM &#x64CD;&#x4F5C;&#x7ED3;&#x675F;, &#x5982; scroll &#x505C;&#x6B62;)</li>
<li>throttle: &#x8282;&#x6D41;&#x662F;&#x5C06;&#x591A;&#x6B21;&#x6267;&#x884C;&#x53D8;&#x6210;&#x6BCF;&#x9694;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x6267;&#x884C; (&#x4FDD;&#x8BC1;&#x4E00;&#x5B9A;&#x65F6;&#x95F4;&#x5185;&#x53EA;&#x6267;&#x884C;&#x4E00;&#x6B21;)</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// &#x8FD9;&#x4E2A;&#x662F;&#x7528;&#x6765;&#x83B7;&#x53D6;&#x5F53;&#x524D;&#x65F6;&#x95F4;&#x6233;&#x7684;</span>
<span class="token keyword">function</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * &#x9632;&#x6296;&#x51FD;&#x6570;&#xFF0C;&#x8FD4;&#x56DE;&#x51FD;&#x6570;&#x8FDE;&#x7EED;&#x8C03;&#x7528;&#x65F6;&#xFF0C;&#x7A7A;&#x95F2;&#x65F6;&#x95F4;&#x5FC5;&#x987B;&#x5927;&#x4E8E;&#x6216;&#x7B49;&#x4E8E; wait&#xFF0C;func &#x624D;&#x4F1A;&#x6267;&#x884C;
 *
 * @param  {function} func        &#x56DE;&#x8C03;&#x51FD;&#x6570;
 * @param  {number}   wait        &#x8868;&#x793A;&#x65F6;&#x95F4;&#x7A97;&#x53E3;&#x7684;&#x95F4;&#x9694;
 * @param  {boolean}  immediate   &#x8BBE;&#x7F6E;&#x4E3A;ture&#x65F6;&#xFF0C;&#x662F;&#x5426;&#x7ACB;&#x5373;&#x8C03;&#x7528;&#x51FD;&#x6570;
 * @return {function}             &#x8FD4;&#x56DE;&#x5BA2;&#x6237;&#x8C03;&#x7528;&#x51FD;&#x6570;
 */</span>
<span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token parameter">func<span class="token punctuation">,</span> wait <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> immediate <span class="token operator">=</span> <span class="token boolean">true</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> timer<span class="token punctuation">,</span> context<span class="token punctuation">,</span> args<span class="token punctuation">;</span>

  <span class="token comment">// &#x5EF6;&#x8FDF;&#x6267;&#x884C;&#x51FD;&#x6570;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">later</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// &#x5EF6;&#x8FDF;&#x51FD;&#x6570;&#x6267;&#x884C;&#x5B8C;&#x6BD5;&#xFF0C;&#x6E05;&#x7A7A;&#x7F13;&#x5B58;&#x7684;&#x5B9A;&#x65F6;&#x5668;&#x5E8F;&#x53F7;</span>
      timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token comment">// &#x5EF6;&#x8FDF;&#x6267;&#x884C;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x51FD;&#x6570;&#x4F1A;&#x5728;&#x5EF6;&#x8FDF;&#x51FD;&#x6570;&#x4E2D;&#x6267;&#x884C;</span>
      <span class="token comment">// &#x4F7F;&#x7528;&#x5230;&#x4E4B;&#x524D;&#x7F13;&#x5B58;&#x7684;&#x53C2;&#x6570;&#x548C;&#x4E0A;&#x4E0B;&#x6587;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>immediate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">func</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        context <span class="token operator">=</span> args <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> wait<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// &#x8FD9;&#x91CC;&#x8FD4;&#x56DE;&#x7684;&#x51FD;&#x6570;&#x662F;&#x6BCF;&#x6B21;&#x5B9E;&#x9645;&#x8C03;&#x7528;&#x7684;&#x51FD;&#x6570;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// &#x5982;&#x679C;&#x6CA1;&#x6709;&#x521B;&#x5EFA;&#x5EF6;&#x8FDF;&#x6267;&#x884C;&#x51FD;&#x6570;&#xFF08;later&#xFF09;&#xFF0C;&#x5C31;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      timer <span class="token operator">=</span> <span class="token function">later</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// &#x5982;&#x679C;&#x662F;&#x7ACB;&#x5373;&#x6267;&#x884C;&#xFF0C;&#x8C03;&#x7528;&#x51FD;&#x6570;</span>
      <span class="token comment">// &#x5426;&#x5219;&#x7F13;&#x5B58;&#x53C2;&#x6570;&#x548C;&#x8C03;&#x7528;&#x4E0A;&#x4E0B;&#x6587;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>immediate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">func</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        context <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        args <span class="token operator">=</span> params<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// &#x5982;&#x679C;&#x5DF2;&#x6709;&#x5EF6;&#x8FDF;&#x6267;&#x884C;&#x51FD;&#x6570;&#xFF08;later&#xFF09;&#xFF0C;&#x8C03;&#x7528;&#x7684;&#x65F6;&#x5019;&#x6E05;&#x9664;&#x539F;&#x6765;&#x7684;&#x5E76;&#x91CD;&#x65B0;&#x8BBE;&#x5B9A;&#x4E00;&#x4E2A;</span>
      <span class="token comment">// &#x8FD9;&#x6837;&#x505A;&#x5EF6;&#x8FDF;&#x51FD;&#x6570;&#x4F1A;&#x91CD;&#x65B0;&#x8BA1;&#x65F6;</span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
      timer <span class="token operator">=</span> <span class="token function">later</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token comment">// simple throttle</span>
<span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> isRunning <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isRunning<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    isRunning <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    window<span class="token punctuation">.</span><span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">action</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      isRunning <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token comment">/**
 * underscore &#x8282;&#x6D41;&#x51FD;&#x6570;&#xFF0C;&#x8FD4;&#x56DE;&#x51FD;&#x6570;&#x8FDE;&#x7EED;&#x8C03;&#x7528;&#x65F6;&#xFF0C;func &#x6267;&#x884C;&#x9891;&#x7387;&#x9650;&#x5B9A;&#x4E3A; &#x6B21; / wait
 *
 * @param  {function}   func      &#x56DE;&#x8C03;&#x51FD;&#x6570;
 * @param  {number}     wait      &#x8868;&#x793A;&#x65F6;&#x95F4;&#x7A97;&#x53E3;&#x7684;&#x95F4;&#x9694;
 * @param  {object}     options   &#x5982;&#x679C;&#x60F3;&#x5FFD;&#x7565;&#x5F00;&#x59CB;&#x51FD;&#x6570;&#x7684;&#x7684;&#x8C03;&#x7528;&#xFF0C;&#x4F20;&#x5165;{leading: false}&#x3002;
 *                                &#x5982;&#x679C;&#x60F3;&#x5FFD;&#x7565;&#x7ED3;&#x5C3E;&#x51FD;&#x6570;&#x7684;&#x8C03;&#x7528;&#xFF0C;&#x4F20;&#x5165;{trailing: false}
 *                                &#x4E24;&#x8005;&#x4E0D;&#x80FD;&#x5171;&#x5B58;&#xFF0C;&#x5426;&#x5219;&#x51FD;&#x6570;&#x4E0D;&#x80FD;&#x6267;&#x884C;
 * @return {function}             &#x8FD4;&#x56DE;&#x5BA2;&#x6237;&#x8C03;&#x7528;&#x51FD;&#x6570;
 */</span>
_<span class="token punctuation">.</span><span class="token function-variable function">throttle</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">func<span class="token punctuation">,</span> wait<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> context<span class="token punctuation">,</span> args<span class="token punctuation">,</span> result<span class="token punctuation">;</span>
  <span class="token keyword">var</span> timeout <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token comment">// &#x4E4B;&#x524D;&#x7684;&#x65F6;&#x95F4;&#x6233;</span>
  <span class="token keyword">var</span> previous <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token comment">// &#x5982;&#x679C; options &#x6CA1;&#x4F20;&#x5219;&#x8BBE;&#x4E3A;&#x7A7A;&#x5BF9;&#x8C61;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>options<span class="token punctuation">)</span> options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token comment">// &#x5B9A;&#x65F6;&#x5668;&#x56DE;&#x8C03;&#x51FD;&#x6570;</span>
  <span class="token keyword">var</span> <span class="token function-variable function">later</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// &#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x4E86; leading&#xFF0C;&#x5C31;&#x5C06; previous &#x8BBE;&#x4E3A; 0</span>
    <span class="token comment">// &#x7528;&#x4E8E;&#x4E0B;&#x9762;&#x51FD;&#x6570;&#x7684;&#x7B2C;&#x4E00;&#x4E2A; if &#x5224;&#x65AD;</span>
    previous <span class="token operator">=</span> options<span class="token punctuation">.</span>leading <span class="token operator">===</span> <span class="token boolean">false</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> _<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// &#x7F6E;&#x7A7A;&#x4E00;&#x662F;&#x4E3A;&#x4E86;&#x9632;&#x6B62;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#xFF0C;&#x4E8C;&#x662F;&#x4E3A;&#x4E86;&#x4E0B;&#x9762;&#x7684;&#x5B9A;&#x65F6;&#x5668;&#x5224;&#x65AD;</span>
    timeout <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    result <span class="token operator">=</span> <span class="token function">func</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>timeout<span class="token punctuation">)</span> context <span class="token operator">=</span> args <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// &#x83B7;&#x5F97;&#x5F53;&#x524D;&#x65F6;&#x95F4;&#x6233;</span>
    <span class="token keyword">var</span> now <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// &#x9996;&#x6B21;&#x8FDB;&#x5165;&#x524D;&#x8005;&#x80AF;&#x5B9A;&#x4E3A; true</span>
    <span class="token comment">// &#x5982;&#x679C;&#x9700;&#x8981;&#x7B2C;&#x4E00;&#x6B21;&#x4E0D;&#x6267;&#x884C;&#x51FD;&#x6570;</span>
    <span class="token comment">// &#x5C31;&#x5C06;&#x4E0A;&#x6B21;&#x65F6;&#x95F4;&#x6233;&#x8BBE;&#x4E3A;&#x5F53;&#x524D;&#x7684;</span>
    <span class="token comment">// &#x8FD9;&#x6837;&#x5728;&#x63A5;&#x4E0B;&#x6765;&#x8BA1;&#x7B97; remaining &#x7684;&#x503C;&#x65F6;&#x4F1A;&#x5927;&#x4E8E;0</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>previous <span class="token operator">&amp;&amp;</span> options<span class="token punctuation">.</span>leading <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span> previous <span class="token operator">=</span> now<span class="token punctuation">;</span>
    <span class="token comment">// &#x8BA1;&#x7B97;&#x5269;&#x4F59;&#x65F6;&#x95F4;</span>
    <span class="token keyword">var</span> remaining <span class="token operator">=</span> wait <span class="token operator">-</span> <span class="token punctuation">(</span>now <span class="token operator">-</span> previous<span class="token punctuation">)</span><span class="token punctuation">;</span>
    context <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    args <span class="token operator">=</span> arguments<span class="token punctuation">;</span>
    <span class="token comment">// &#x5982;&#x679C;&#x5F53;&#x524D;&#x8C03;&#x7528;&#x5DF2;&#x7ECF;&#x5927;&#x4E8E;&#x4E0A;&#x6B21;&#x8C03;&#x7528;&#x65F6;&#x95F4; + wait</span>
    <span class="token comment">// &#x6216;&#x8005;&#x7528;&#x6237;&#x624B;&#x52A8;&#x8C03;&#x4E86;&#x65F6;&#x95F4;</span>
    <span class="token comment">// &#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x4E86; trailing&#xFF0C;&#x53EA;&#x4F1A;&#x8FDB;&#x5165;&#x8FD9;&#x4E2A;&#x6761;&#x4EF6;</span>
    <span class="token comment">// &#x5982;&#x679C;&#x6CA1;&#x6709;&#x8BBE;&#x7F6E; leading&#xFF0C;&#x90A3;&#x4E48;&#x7B2C;&#x4E00;&#x6B21;&#x4F1A;&#x8FDB;&#x5165;&#x8FD9;&#x4E2A;&#x6761;&#x4EF6;</span>
    <span class="token comment">// &#x8FD8;&#x6709;&#x4E00;&#x70B9;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x89C9;&#x5F97;&#x5F00;&#x542F;&#x4E86;&#x5B9A;&#x65F6;&#x5668;&#x90A3;&#x4E48;&#x5E94;&#x8BE5;&#x4E0D;&#x4F1A;&#x8FDB;&#x5165;&#x8FD9;&#x4E2A; if &#x6761;&#x4EF6;&#x4E86;</span>
    <span class="token comment">// &#x5176;&#x5B9E;&#x8FD8;&#x662F;&#x4F1A;&#x8FDB;&#x5165;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x5B9A;&#x65F6;&#x5668;&#x7684;&#x5EF6;&#x65F6;</span>
    <span class="token comment">// &#x5E76;&#x4E0D;&#x662F;&#x51C6;&#x786E;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x5F88;&#x53EF;&#x80FD;&#x4F60;&#x8BBE;&#x7F6E;&#x4E86;2&#x79D2;</span>
    <span class="token comment">// &#x4F46;&#x662F;&#x4ED6;&#x9700;&#x8981;2.2&#x79D2;&#x624D;&#x89E6;&#x53D1;&#xFF0C;&#x8FD9;&#x65F6;&#x5019;&#x5C31;&#x4F1A;&#x8FDB;&#x5165;&#x8FD9;&#x4E2A;&#x6761;&#x4EF6;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>remaining <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span> remaining <span class="token operator">&gt;</span> wait<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// &#x5982;&#x679C;&#x5B58;&#x5728;&#x5B9A;&#x65F6;&#x5668;&#x5C31;&#x6E05;&#x7406;&#x6389;&#x5426;&#x5219;&#x4F1A;&#x8C03;&#x7528;&#x4E8C;&#x6B21;&#x56DE;&#x8C03;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>timeout<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
        timeout <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      previous <span class="token operator">=</span> now<span class="token punctuation">;</span>
      result <span class="token operator">=</span> <span class="token function">func</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>timeout<span class="token punctuation">)</span> context <span class="token operator">=</span> args <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>timeout <span class="token operator">&amp;&amp;</span> options<span class="token punctuation">.</span>trailing <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// &#x5224;&#x65AD;&#x662F;&#x5426;&#x8BBE;&#x7F6E;&#x4E86;&#x5B9A;&#x65F6;&#x5668;&#x548C; trailing</span>
      <span class="token comment">// &#x6CA1;&#x6709;&#x7684;&#x8BDD;&#x5C31;&#x5F00;&#x542F;&#x4E00;&#x4E2A;&#x5B9A;&#x65F6;&#x5668;</span>
      <span class="token comment">// &#x5E76;&#x4E14;&#x4E0D;&#x80FD;&#x4E0D;&#x80FD;&#x540C;&#x65F6;&#x8BBE;&#x7F6E; leading &#x548C; trailing</span>
      timeout <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>later<span class="token punctuation">,</span> remaining<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="requestanimationframe-throttling"><a name="requestanimationframe-throttling" class="anchor-navigation-ex-anchor" href="#requestanimationframe-throttling"><i class="fa fa-link" aria-hidden="true"></i></a><a name="requestanimationframe-throttling" class="plugin-anchor" href="#requestanimationframe-throttling"><i class="fa fa-link" aria-hidden="true"></i></a>RequestAnimationFrame Throttling</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">let</span> frameId <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> ticking <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">handleResize</span> <span class="token operator">=</span> <span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>ticking<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
  ticking <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  frameId <span class="token operator">=</span> <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">handleUpdate</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">handleUpdate</span> <span class="token operator">=</span> <span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;resize update&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token operator">...</span>

  ticking <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;resize&apos;</span><span class="token punctuation">,</span> handleResize<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">handleUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;resize&apos;</span><span class="token punctuation">,</span> handleResize<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">cancelAnimationFrame</span><span class="token punctuation">(</span>frameId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="first-paint-time"><a name="first-paint-time" class="anchor-navigation-ex-anchor" href="#first-paint-time"><i class="fa fa-link" aria-hidden="true"></i></a>5.18. First Paint Time</h3>
<pre class="language-"><code class="lang-js">document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;DOMContentLoaded&apos;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;DOM &#x6302;&#x8F7D;&#x65F6;&#x95F4;: &apos;</span><span class="token punctuation">,</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> timerStart<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// &#x6027;&#x80FD;&#x65E5;&#x5FD7;&#x4E0A;&#x62A5;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;load&apos;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;&#x6240;&#x6709;&#x8D44;&#x6E90;&#x52A0;&#x8F7D;&#x5B8C;&#x6210;&#x65F6;&#x95F4;: &apos;</span><span class="token punctuation">,</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> timerStart<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// &#x6027;&#x80FD;&#x65E5;&#x5FD7;&#x4E0A;&#x62A5;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token comment">// &#x8BA1;&#x7B97;&#x52A0;&#x8F7D;&#x65F6;&#x95F4;</span>
<span class="token keyword">function</span> <span class="token function">getPerformanceTiming</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> performance <span class="token operator">=</span> window<span class="token punctuation">.</span>performance<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>performance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// &#x5F53;&#x524D;&#x6D4F;&#x89C8;&#x5668;&#x4E0D;&#x652F;&#x6301;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;&#x4F60;&#x7684;&#x6D4F;&#x89C8;&#x5668;&#x4E0D;&#x652F;&#x6301; performance &#x63A5;&#x53E3;&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> t <span class="token operator">=</span> performance<span class="token punctuation">.</span>timing<span class="token punctuation">;</span>
  <span class="token keyword">const</span> times <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token comment">//&#x3010;&#x91CD;&#x8981;&#x3011;&#x9875;&#x9762;&#x52A0;&#x8F7D;&#x5B8C;&#x6210;&#x7684;&#x65F6;&#x95F4;</span>
  <span class="token comment">//&#x3010;&#x539F;&#x56E0;&#x3011;&#x8FD9;&#x51E0;&#x4E4E;&#x4EE3;&#x8868;&#x4E86;&#x7528;&#x6237;&#x7B49;&#x5F85;&#x9875;&#x9762;&#x53EF;&#x7528;&#x7684;&#x65F6;&#x95F4;</span>
  times<span class="token punctuation">.</span>loadPage <span class="token operator">=</span> t<span class="token punctuation">.</span>loadEventEnd <span class="token operator">-</span> t<span class="token punctuation">.</span>navigationStart<span class="token punctuation">;</span>
  <span class="token comment">//&#x3010;&#x91CD;&#x8981;&#x3011;&#x89E3;&#x6790; DOM &#x6811;&#x7ED3;&#x6784;&#x7684;&#x65F6;&#x95F4;</span>
  <span class="token comment">//&#x3010;&#x539F;&#x56E0;&#x3011;&#x53CD;&#x7701;&#x4E0B;&#x4F60;&#x7684; DOM &#x6811;&#x5D4C;&#x5957;&#x662F;&#x4E0D;&#x662F;&#x592A;&#x591A;&#x4E86;&#xFF01;</span>
  times<span class="token punctuation">.</span>domReady <span class="token operator">=</span> t<span class="token punctuation">.</span>domComplete <span class="token operator">-</span> t<span class="token punctuation">.</span>responseEnd<span class="token punctuation">;</span>
  <span class="token comment">//&#x3010;&#x91CD;&#x8981;&#x3011;&#x91CD;&#x5B9A;&#x5411;&#x7684;&#x65F6;&#x95F4;</span>
  <span class="token comment">//&#x3010;&#x539F;&#x56E0;&#x3011;&#x62D2;&#x7EDD;&#x91CD;&#x5B9A;&#x5411;&#xFF01;&#x6BD4;&#x5982;&#xFF0C;http://example.com/ &#x5C31;&#x4E0D;&#x8BE5;&#x5199;&#x6210; http://example.com</span>
  times<span class="token punctuation">.</span>redirect <span class="token operator">=</span> t<span class="token punctuation">.</span>redirectEnd <span class="token operator">-</span> t<span class="token punctuation">.</span>redirectStart<span class="token punctuation">;</span>
  <span class="token comment">//&#x3010;&#x91CD;&#x8981;&#x3011;DNS &#x67E5;&#x8BE2;&#x65F6;&#x95F4;</span>
  <span class="token comment">//&#x3010;&#x539F;&#x56E0;&#x3011;DNS &#x9884;&#x52A0;&#x8F7D;&#x505A;&#x4E86;&#x4E48;&#xFF1F;&#x9875;&#x9762;&#x5185;&#x662F;&#x4E0D;&#x662F;&#x4F7F;&#x7528;&#x4E86;&#x592A;&#x591A;&#x4E0D;&#x540C;&#x7684;&#x57DF;&#x540D;&#x5BFC;&#x81F4;&#x57DF;&#x540D;&#x67E5;&#x8BE2;&#x7684;&#x65F6;&#x95F4;&#x592A;&#x957F;&#xFF1F;</span>
  <span class="token comment">// &#x53EF;&#x4F7F;&#x7528; HTML5 Prefetch &#x9884;&#x67E5;&#x8BE2; DNS &#xFF0C;&#x89C1;&#xFF1A;[HTML5 prefetch](http://segmentfault.com/a/1190000000633364)</span>
  times<span class="token punctuation">.</span>lookupDomain <span class="token operator">=</span> t<span class="token punctuation">.</span>domainLookupEnd <span class="token operator">-</span> t<span class="token punctuation">.</span>domainLookupStart<span class="token punctuation">;</span>
  <span class="token comment">//&#x3010;&#x91CD;&#x8981;&#x3011;&#x8BFB;&#x53D6;&#x9875;&#x9762;&#x7B2C;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x7684;&#x65F6;&#x95F4;</span>
  <span class="token comment">//&#x3010;&#x539F;&#x56E0;&#x3011;&#x8FD9;&#x53EF;&#x4EE5;&#x7406;&#x89E3;&#x4E3A;&#x7528;&#x6237;&#x62FF;&#x5230;&#x4F60;&#x7684;&#x8D44;&#x6E90;&#x5360;&#x7528;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x52A0;&#x5F02;&#x5730;&#x673A;&#x623F;&#x4E86;&#x4E48;&#xFF0C;&#x52A0;CDN &#x5904;&#x7406;&#x4E86;&#x4E48;&#xFF1F;&#x52A0;&#x5E26;&#x5BBD;&#x4E86;&#x4E48;&#xFF1F;&#x52A0; CPU &#x8FD0;&#x7B97;&#x901F;&#x5EA6;&#x4E86;&#x4E48;&#xFF1F;</span>
  <span class="token comment">// TTFB &#x5373; Time To First Byte &#x7684;&#x610F;&#x601D;</span>
  <span class="token comment">// &#x7EF4;&#x57FA;&#x767E;&#x79D1;&#xFF1A;https://en.wikipedia.org/wiki/Time_To_First_Byte</span>
  times<span class="token punctuation">.</span>ttfb <span class="token operator">=</span> t<span class="token punctuation">.</span>responseStart <span class="token operator">-</span> t<span class="token punctuation">.</span>navigationStart<span class="token punctuation">;</span>
  <span class="token comment">//&#x3010;&#x91CD;&#x8981;&#x3011;&#x5185;&#x5BB9;&#x52A0;&#x8F7D;&#x5B8C;&#x6210;&#x7684;&#x65F6;&#x95F4;</span>
  <span class="token comment">//&#x3010;&#x539F;&#x56E0;&#x3011;&#x9875;&#x9762;&#x5185;&#x5BB9;&#x7ECF;&#x8FC7; gzip &#x538B;&#x7F29;&#x4E86;&#x4E48;&#xFF0C;&#x9759;&#x6001;&#x8D44;&#x6E90; css/js &#x7B49;&#x538B;&#x7F29;&#x4E86;&#x4E48;&#xFF1F;</span>
  times<span class="token punctuation">.</span>request <span class="token operator">=</span> t<span class="token punctuation">.</span>responseEnd <span class="token operator">-</span> t<span class="token punctuation">.</span>requestStart<span class="token punctuation">;</span>
  <span class="token comment">//&#x3010;&#x91CD;&#x8981;&#x3011;&#x6267;&#x884C; onload &#x56DE;&#x8C03;&#x51FD;&#x6570;&#x7684;&#x65F6;&#x95F4;</span>
  <span class="token comment">//&#x3010;&#x539F;&#x56E0;&#x3011;&#x662F;&#x5426;&#x592A;&#x591A;&#x4E0D;&#x5FC5;&#x8981;&#x7684;&#x64CD;&#x4F5C;&#x90FD;&#x653E;&#x5230; onload &#x56DE;&#x8C03;&#x51FD;&#x6570;&#x91CC;&#x6267;&#x884C;&#x4E86;&#xFF0C;&#x8003;&#x8651;&#x8FC7;&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;&#x3001;&#x6309;&#x9700;&#x52A0;&#x8F7D;&#x7684;&#x7B56;&#x7565;&#x4E48;&#xFF1F;</span>
  times<span class="token punctuation">.</span>loadEvent <span class="token operator">=</span> t<span class="token punctuation">.</span>loadEventEnd <span class="token operator">-</span> t<span class="token punctuation">.</span>loadEventStart<span class="token punctuation">;</span>
  <span class="token comment">// DNS &#x7F13;&#x5B58;&#x65F6;&#x95F4;</span>
  times<span class="token punctuation">.</span>appcache <span class="token operator">=</span> t<span class="token punctuation">.</span>domainLookupStart <span class="token operator">-</span> t<span class="token punctuation">.</span>fetchStart<span class="token punctuation">;</span>
  <span class="token comment">// &#x5378;&#x8F7D;&#x9875;&#x9762;&#x7684;&#x65F6;&#x95F4;</span>
  times<span class="token punctuation">.</span>unloadEvent <span class="token operator">=</span> t<span class="token punctuation">.</span>unloadEventEnd <span class="token operator">-</span> t<span class="token punctuation">.</span>unloadEventStart<span class="token punctuation">;</span>
  <span class="token comment">// TCP &#x5EFA;&#x7ACB;&#x8FDE;&#x63A5;&#x5B8C;&#x6210;&#x63E1;&#x624B;&#x7684;&#x65F6;&#x95F4;</span>
  times<span class="token punctuation">.</span>connect <span class="token operator">=</span> t<span class="token punctuation">.</span>connectEnd <span class="token operator">-</span> t<span class="token punctuation">.</span>connectStart<span class="token punctuation">;</span>
  <span class="token keyword">return</span> times<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x7B97;&#x6570;&#x903B;&#x8F91;&#x8FD0;&#x7B97;"><a name="&#x7B97;&#x6570;&#x903B;&#x8F91;&#x8FD0;&#x7B97;" class="anchor-navigation-ex-anchor" href="#&#x7B97;&#x6570;&#x903B;&#x8F91;&#x8FD0;&#x7B97;"><i class="fa fa-link" aria-hidden="true"></i></a>5.19. &#x7B97;&#x6570;&#x903B;&#x8F91;&#x8FD0;&#x7B97;</h3>
<h4 id="&#x4F4D;&#x64CD;&#x4F5C;"><a name="&#x4F4D;&#x64CD;&#x4F5C;" class="anchor-navigation-ex-anchor" href="#&#x4F4D;&#x64CD;&#x4F5C;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x4F4D;&#x64CD;&#x4F5C;" class="plugin-anchor" href="#&#x4F4D;&#x64CD;&#x4F5C;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x4F4D;&#x64CD;&#x4F5C;</h4>
<ul>
<li>i%2 =&gt; <code>i&amp;0x1</code></li>
<li>&#x4F4D;&#x63A9;&#x7801;</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> <span class="token constant">OPTION_A</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token constant">OPTION_B</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token constant">OPTION_C</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span>
  <span class="token constant">OPTION_D</span> <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span>
  <span class="token constant">OPTION_E</span> <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token constant">OPTION_A</span> <span class="token operator">|</span> <span class="token constant">OPTION_C</span> <span class="token operator">|</span> <span class="token constant">OPTION_D</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="math-&#x5BF9;&#x8C61;"><a name="math-&#x5BF9;&#x8C61;" class="anchor-navigation-ex-anchor" href="#math-&#x5BF9;&#x8C61;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="math-&#x5BF9;&#x8C61;" class="plugin-anchor" href="#math-&#x5BF9;&#x8C61;"><i class="fa fa-link" aria-hidden="true"></i></a>Math &#x5BF9;&#x8C61;</h4>
<pre class="language-"><code class="lang-js">Math<span class="token punctuation">.</span><span class="token constant">E</span><span class="token punctuation">;</span>
Math<span class="token punctuation">.</span><span class="token constant">LN10</span><span class="token punctuation">;</span>
Math<span class="token punctuation">.</span><span class="token constant">LN2</span><span class="token punctuation">;</span>
Math<span class="token punctuation">.</span><span class="token constant">LOG2E</span><span class="token punctuation">;</span>
Math<span class="token punctuation">.</span><span class="token constant">LOG10E</span><span class="token punctuation">;</span>
Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">;</span>
Math<span class="token punctuation">.</span><span class="token constant">SQRT1_2</span><span class="token punctuation">;</span>
Math<span class="token punctuation">.</span><span class="token constant">SQRT2</span><span class="token punctuation">;</span>

Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
Math<span class="token punctuation">.</span><span class="token function">exp</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
Math<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> power<span class="token punctuation">)</span><span class="token punctuation">;</span>
Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
Math<span class="token punctuation">.</span><span class="token function">acos</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
Math<span class="token punctuation">.</span><span class="token function">asin</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
Math<span class="token punctuation">.</span><span class="token function">atan</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
Math<span class="token punctuation">.</span><span class="token function">atan2</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
Math<span class="token punctuation">.</span><span class="token function">tan</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="browser-performance"><a name="browser-performance" class="anchor-navigation-ex-anchor" href="#browser-performance"><i class="fa fa-link" aria-hidden="true"></i></a>6. Browser Performance</h2>
<ul>
<li><a href="https://zhuanlan.zhihu.com/p/41017888" target="_blank">Performance &#x5DE5;&#x5177;&#x6307;&#x5317;</a></li>
</ul>
<h3 id="browser-caches"><a name="browser-caches" class="anchor-navigation-ex-anchor" href="#browser-caches"><i class="fa fa-link" aria-hidden="true"></i></a>6.1. Browser Caches</h3>
<ul>
<li><a href="https://github.com/ljianshu/Blog/issues/23" target="_blank">Dive into Browser Caches</a></li>
</ul>
<p>&#x4ECE;&#x7F13;&#x5B58;&#x4F4D;&#x7F6E;&#x4E0A;&#x6765;&#x8BF4;&#x5206;&#x4E3A;&#x56DB;&#x79CD;, &#x5E76;&#x4E14;&#x5404;&#x81EA;&#x6709;&#x4F18;&#x5148;&#x7EA7;,
&#x5F53;&#x4F9D;&#x6B21;&#x67E5;&#x627E;&#x7F13;&#x5B58;&#x4E14;&#x90FD;&#x6CA1;&#x6709;&#x547D;&#x4E2D;&#x7684;&#x65F6;&#x5019;, &#x624D;&#x4F1A;&#x53BB;&#x8BF7;&#x6C42;&#x7F51;&#x7EDC;:</p>
<ul>
<li>Service Worker: PWA</li>
<li>(In-) Memory Cache: reload Tab page</li>
<li>(On-) Disk Cache: big files</li>
<li>Push Cache: HTTP/2</li>
</ul>
<pre class="language-"><code class="lang-js">self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;install&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">buildCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token keyword">await</span> caches<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>cacheName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> cache<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&apos;/main.css&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;/main.mjs&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;/offline.html&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  event<span class="token punctuation">.</span><span class="token function">waitUntil</span><span class="token punctuation">(</span><span class="token function">buildCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;fetch&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">cachedFetch</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token keyword">await</span> caches<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>cacheName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> response <span class="token operator">=</span> <span class="token keyword">await</span> cache<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token keyword">return</span> response<span class="token punctuation">;</span>
    response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>request<span class="token punctuation">,</span> response<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> response<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  event<span class="token punctuation">.</span><span class="token function">respondWith</span><span class="token punctuation">(</span><span class="token function">cachedFetch</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="http-cache"><a name="http-cache" class="anchor-navigation-ex-anchor" href="#http-cache"><i class="fa fa-link" aria-hidden="true"></i></a><a name="http-cache" class="plugin-anchor" href="#http-cache"><i class="fa fa-link" aria-hidden="true"></i></a>HTTP Cache</h4>
<p>&#x6D4F;&#x89C8;&#x5668;&#x7F13;&#x5B58;&#xFF0C;&#x4E5F;&#x79F0; HTTP &#x7F13;&#x5B58;,
&#x5206;&#x4E3A;&#x5F3A;&#x7F13;&#x5B58;&#x548C;&#x534F;&#x5546;&#x7F13;&#x5B58;.
&#x4F18;&#x5148;&#x7EA7;&#x8F83;&#x9AD8;&#x7684;&#x662F;&#x5F3A;&#x7F13;&#x5B58;,
&#x5728;&#x547D;&#x4E2D;&#x5F3A;&#x7F13;&#x5B58;&#x5931;&#x8D25;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x6216;&#x8005;<code>Cache-Control: no-cache</code>&#x65F6;,
&#x624D;&#x4F1A;&#x8D70;&#x534F;&#x5546;&#x7F13;&#x5B58;.</p>
<p>&#x5F3A;&#x7F13;&#x5B58;&#x662F;&#x5229;&#x7528; HTTP &#x5934;&#x4E2D;&#x7684; Expires &#x548C; Cache-Control &#x4E24;&#x4E2A;&#x5B57;&#x6BB5;&#x6765;&#x63A7;&#x5236;&#x7684;.
&#x5F3A;&#x7F13;&#x5B58;&#x4E2D;, &#x5F53;&#x8BF7;&#x6C42;&#x518D;&#x6B21;&#x53D1;&#x51FA;&#x65F6;, &#x6D4F;&#x89C8;&#x5668;&#x4F1A;&#x6839;&#x636E;&#x5176;&#x4E2D;&#x7684; expires &#x548C; cache-control &#x5224;&#x65AD;&#x76EE;&#x6807;&#x8D44;&#x6E90;&#x662F;&#x5426; <code>&#x547D;&#x4E2D;</code> &#x5F3A;&#x7F13;&#x5B58;,
&#x82E5;&#x547D;&#x4E2D;&#x5219;&#x76F4;&#x63A5;&#x4ECE;&#x7F13;&#x5B58;&#x4E2D;&#x83B7;&#x53D6;&#x8D44;&#x6E90;, &#x4E0D;&#x4F1A;&#x518D;&#x4E0E;&#x670D;&#x52A1;&#x7AEF;&#x53D1;&#x751F;&#x901A;&#x4FE1;.
Cache-Control &#x76F8;&#x5BF9;&#x4E8E; expires &#x66F4;&#x52A0;&#x51C6;&#x786E;&#xFF0C;&#x5B83;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x4E5F;&#x66F4;&#x9AD8;.
&#x5F53; Cache-Control &#x4E0E; expires &#x540C;&#x65F6;&#x51FA;&#x73B0;&#x65F6;&#xFF0C;&#x4EE5; Cache-Control &#x4E3A;&#x51C6;.</p>
<pre class="language-"><code class="lang-bash">expires: Wed, <span class="token number">12</span> Sep <span class="token number">2019</span> 06:12:18 GMT
cache-control: max-age<span class="token operator">=</span><span class="token number">31536000</span>
</code></pre>
<p>&#x534F;&#x5546;&#x7F13;&#x5B58;&#x673A;&#x5236;&#x4E0B;,
&#x6D4F;&#x89C8;&#x5668;&#x9700;&#x8981;&#x5411;&#x670D;&#x52A1;&#x5668;&#x53BB;&#x8BE2;&#x95EE;&#x7F13;&#x5B58;&#x7684;&#x76F8;&#x5173;&#x4FE1;&#x606F;,
&#x8FDB;&#x800C;&#x5224;&#x65AD;&#x662F;&#x91CD;&#x65B0;&#x53D1;&#x8D77;&#x8BF7;&#x6C42;&#x3001;&#x4E0B;&#x8F7D;&#x5B8C;&#x6574;&#x7684;&#x54CD;&#x5E94;,
&#x8FD8;&#x662F;&#x4ECE;&#x672C;&#x5730;&#x83B7;&#x53D6;&#x7F13;&#x5B58;&#x7684;&#x8D44;&#x6E90;.
&#x5982;&#x679C;&#x670D;&#x52A1;&#x7AEF;&#x63D0;&#x793A;&#x7F13;&#x5B58;&#x8D44;&#x6E90;&#x672A;&#x6539;&#x52A8; (Not Modified),
&#x8D44;&#x6E90;&#x4F1A;&#x88AB;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x6D4F;&#x89C8;&#x5668;&#x7F13;&#x5B58;,
&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x5BF9;&#x5E94;&#x7684;&#x72B6;&#x6001;&#x7801;&#x662F; <code>304</code>.</p>
<p>Last-Modified &#x662F;&#x4E00;&#x4E2A;&#x65F6;&#x95F4;&#x6233;,
&#x5982;&#x679C;&#x542F;&#x7528;&#x4E86;&#x534F;&#x5546;&#x7F13;&#x5B58;,
&#x5B83;&#x4F1A;&#x5728;&#x9996;&#x6B21;&#x8BF7;&#x6C42;&#x65F6;&#x968F;&#x7740; Response Headers &#x8FD4;&#x56DE;:</p>
<pre class="language-"><code class="lang-bash">Last-Modified: Fri, <span class="token number">27</span> Oct <span class="token number">2017</span> 06:35:57 GMT
</code></pre>
<p>&#x968F;&#x540E;&#x6BCF;&#x6B21;&#x8BF7;&#x6C42;&#x65F6;, &#x4F1A;&#x5E26;&#x4E0A;&#x4E00;&#x4E2A;&#x53EB; If-Modified-Since &#x7684;&#x65F6;&#x95F4;&#x6233;&#x5B57;&#x6BB5;,
&#x5B83;&#x7684;&#x503C;&#x6B63;&#x662F;&#x4E0A;&#x4E00;&#x6B21; response &#x8FD4;&#x56DE;&#x7ED9;&#x5B83;&#x7684; last-modified &#x503C;:</p>
<pre class="language-"><code class="lang-bash">If-Modified-Since: Fri, <span class="token number">27</span> Oct <span class="token number">2017</span> 06:35:57 GMT
</code></pre>
<p>&#x670D;&#x52A1;&#x5668;&#x53EF;&#x80FD;&#x65E0;&#x6CD5;&#x6B63;&#x786E;&#x611F;&#x77E5;&#x6587;&#x4EF6;&#x7684;&#x53D8;&#x5316; (&#x672A;&#x5B9E;&#x9645;&#x6539;&#x52A8;&#x6216;&#x6539;&#x52A8;&#x8FC7;&#x5FEB;),
&#x4E3A;&#x4E86;&#x89E3;&#x51B3;&#x8FD9;&#x6837;&#x7684;&#x95EE;&#x9898;, Etag &#x4F5C;&#x4E3A; Last-Modified &#x7684;&#x8865;&#x5145;&#x51FA;&#x73B0;&#x4E86;.
Etag &#x662F;&#x7531;&#x670D;&#x52A1;&#x5668;&#x4E3A;&#x6BCF;&#x4E2A;&#x8D44;&#x6E90;&#x751F;&#x6210;&#x7684;&#x552F;&#x4E00;&#x7684;&#x6807;&#x8BC6;&#x5B57;&#x7B26;&#x4E32;,
&#x8FD9;&#x4E2A;&#x6807;&#x8BC6;&#x5B57;&#x7B26;&#x4E32;&#x53EF;&#x4EE5;&#x662F;&#x57FA;&#x4E8E;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x7F16;&#x7801;&#x7684;,
&#x56E0;&#x6B64; Etag &#x80FD;&#x591F;&#x7CBE;&#x51C6;&#x5730;&#x611F;&#x77E5;&#x6587;&#x4EF6;&#x7684;&#x53D8;&#x5316;.</p>
<h4 id="code-caching"><a name="code-caching" class="anchor-navigation-ex-anchor" href="#code-caching"><i class="fa fa-link" aria-hidden="true"></i></a><a name="code-caching" class="plugin-anchor" href="#code-caching"><i class="fa fa-link" aria-hidden="true"></i></a>Code Caching</h4>
<ul>
<li>cold run: <code>download -&gt; compile -&gt; store into on-disk cache</code></li>
<li>warm run: <code>fetch from browser cache -&gt; compile -&gt; store metadata</code></li>
<li>hot run: <code>fetch scripts and metadata from browser cache -&gt; skip compile</code></li>
<li>positive case: IIFE function heuristics</li>
<li>passive case: too small (<code>&lt; 1KB</code>) and inline scripts</li>
</ul>
<h3 id="browser-pefermance-monitoring"><a name="browser-pefermance-monitoring" class="anchor-navigation-ex-anchor" href="#browser-pefermance-monitoring"><i class="fa fa-link" aria-hidden="true"></i></a>6.2. Browser Pefermance Monitoring</h3>
<p>&#x524D;&#x7AEF;&#x6027;&#x80FD;&#x76D1;&#x63A7;&#x5206;&#x4E3A;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#xFF0C;&#x4E00;&#x79CD;&#x53EB;&#x505A;&#x5408;&#x6210;&#x76D1;&#x63A7;&#xFF08;Synthetic Monitoring&#xFF0C;SYN&#xFF09;&#xFF0C;&#x53E6;&#x4E00;&#x79CD;&#x662F;&#x771F;&#x5B9E;&#x7528;&#x6237;&#x76D1;&#x63A7;&#xFF08;Real User Monitoring&#xFF0C;RUM&#xFF09;&#x3002;</p>
<h4 id="&#x5408;&#x6210;&#x76D1;&#x63A7;"><a name="&#x5408;&#x6210;&#x76D1;&#x63A7;" class="anchor-navigation-ex-anchor" href="#&#x5408;&#x6210;&#x76D1;&#x63A7;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x5408;&#x6210;&#x76D1;&#x63A7;" class="plugin-anchor" href="#&#x5408;&#x6210;&#x76D1;&#x63A7;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5408;&#x6210;&#x76D1;&#x63A7;</h4>
<p>&#x5728;&#x4E00;&#x4E2A;&#x6A21;&#x62DF;&#x573A;&#x666F;&#x91CC;, &#x53BB;&#x63D0;&#x4EA4;&#x4E00;&#x4E2A;&#x9700;&#x8981;&#x505A;&#x6027;&#x80FD;&#x5BA1;&#x8BA1;&#x7684;&#x9875;&#x9762;,
&#x901A;&#x8FC7;&#x4E00;&#x7CFB;&#x5217;&#x7684;&#x5DE5;&#x5177;&#x3001;&#x89C4;&#x5219;&#x53BB;&#x8FD0;&#x884C;&#x4F60;&#x7684;&#x9875;&#x9762;, &#x63D0;&#x53D6;&#x4E00;&#x4E9B;&#x6027;&#x80FD;&#x6307;&#x6807;, &#x5F97;&#x51FA;&#x4E00;&#x4E2A;&#x5BA1;&#x8BA1;&#x62A5;&#x544A;.</p>
<p>&#x5E38;&#x89C1;&#x7684;&#x5DE5;&#x5177;&#x6709; Google &#x7684; Lighthouse&#xFF0C;webpagetest&#xFF0C;pagespeed &#x7B49;</p>
<table>
<thead>
<tr>
<th style="text-align:left">&#x4F18;&#x70B9;</th>
<th style="text-align:center">&#x7F3A;&#x70B9;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">&#x5B9E;&#x73B0;&#x7B80;&#x5355;</td>
<td style="text-align:center">&#x65E0;&#x6CD5;&#x8FD8;&#x539F;&#x5168;&#x90E8;&#x771F;&#x5B9E;&#x573A;&#x666F;</td>
</tr>
<tr>
<td style="text-align:left">&#x80FD;&#x91C7;&#x96C6;&#x5230;&#x4E30;&#x5BCC;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x5982;&#x786C;&#x4EF6;&#x6307;&#x6807;&#x6216;&#x7011;&#x5E03;&#x56FE;</td>
<td style="text-align:center">&#x767B;&#x5F55;&#x7B49;&#x573A;&#x666F;&#x9700;&#x8981;&#x989D;&#x5916;&#x89E3;&#x51B3;</td>
</tr>
<tr>
<td style="text-align:left">&#x4E0D;&#x5F71;&#x54CD;&#x771F;&#x5B9E;&#x7528;&#x6237;&#x7684;&#x8BBF;&#x95EE;&#x6027;&#x80FD;</td>
<td style="text-align:center">&#x5355;&#x6B21;&#x6570;&#x636E;&#x4E0D;&#x591F;&#x7A33;&#x5B9A;</td>
</tr>
<tr>
<td style="text-align:left">&#x53EF;&#x4EE5;&#x63D0;&#x4F9B;&#x9875;&#x9762;&#x52A0;&#x8F7D;&#x5E7B;&#x706F;&#x7247;&#x7B49;&#x53EF;&#x89C6;&#x5316;&#x5206;&#x6790;&#x9014;&#x5F84;</td>
<td style="text-align:center">&#x6570;&#x636E;&#x91CF;&#x8F83;&#x5C0F;&#xFF0C;&#x65E0;&#x6CD5;&#x53D1;&#x6325;&#x66F4;&#x5927;&#x4EF7;&#x503C;</td>
</tr>
</tbody>
</table>
<h4 id="&#x771F;&#x5B9E;&#x7528;&#x6237;&#x76D1;&#x63A7;"><a name="&#x771F;&#x5B9E;&#x7528;&#x6237;&#x76D1;&#x63A7;" class="anchor-navigation-ex-anchor" href="#&#x771F;&#x5B9E;&#x7528;&#x6237;&#x76D1;&#x63A7;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x771F;&#x5B9E;&#x7528;&#x6237;&#x76D1;&#x63A7;" class="plugin-anchor" href="#&#x771F;&#x5B9E;&#x7528;&#x6237;&#x76D1;&#x63A7;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x771F;&#x5B9E;&#x7528;&#x6237;&#x76D1;&#x63A7;</h4>
<p>&#x7528;&#x6237;&#x5728;&#x9875;&#x9762;&#x8BBF;&#x95EE;&#x4E4B;&#x540E;&#x5C31;&#x4F1A;&#x4EA7;&#x751F;&#x5404;&#x79CD;&#x5404;&#x6837;&#x7684;&#x6027;&#x80FD;&#x6307;&#x6807;,
&#x4E4B;&#x540E;&#x4F1A;&#x5C06;&#x8FD9;&#x4E9B;&#x6027;&#x80FD;&#x6307;&#x6807;&#x4E0A;&#x4F20;&#x7684;&#x6211;&#x4EEC;&#x7684;&#x65E5;&#x5FD7;&#x670D;&#x52A1;&#x5668;&#x4E0A;,
&#x8FDB;&#x884C;&#x6570;&#x636E;&#x7684;&#x63D0;&#x8D77;&#x6E05;&#x6D17;&#x52A0;&#x5DE5;,
&#x6700;&#x540E;&#x5728;&#x76D1;&#x63A7;&#x5E73;&#x53F0;&#x4E0A;&#x8FDB;&#x884C;&#x5C55;&#x793A;&#x548C;&#x5206;&#x6790;&#x7684;&#x4E00;&#x4E2A;&#x8FC7;&#x7A0B;.</p>
<ul>
<li>&#x771F;&#x5B9E;&#x7528;&#x6237;&#x76D1;&#x63A7;&#x7684;&#x4F18;&#x7F3A;&#x70B9;</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">&#x4F18;&#x70B9;</th>
<th style="text-align:left">&#x7F3A;&#x70B9;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">&#x65E0;&#x9700;&#x914D;&#x7F6E;&#x6A21;&#x62DF;&#x6761;&#x4EF6;&#xFF0C;&#x5B8C;&#x5168;&#x8FD8;&#x539F;&#x771F;&#x5B9E;&#x573A;&#x666F;</td>
<td style="text-align:left">&#x5F71;&#x54CD;&#x771F;&#x5B9E;&#x7528;&#x6237;&#x7684;&#x8BBF;&#x95EE;&#x6027;&#x80FD;&#x53CA;&#x6D41;&#x91CF;&#x6D88;&#x8017;</td>
</tr>
<tr>
<td style="text-align:left">&#x4E0D;&#x5B58;&#x5728;&#x767B;&#x5F55;&#x7B49;&#x9700;&#x8981;&#x989D;&#x5916;&#x89E3;&#x51B3;&#x7684;&#x573A;&#x666F;</td>
<td style="text-align:left">&#x65E0;&#x6CD5;&#x91C7;&#x96C6;&#x786C;&#x4EF6;&#x76F8;&#x5173;&#x6307;&#x6807;</td>
</tr>
<tr>
<td style="text-align:left">&#x6570;&#x636E;&#x6837;&#x672C;&#x8DB3;&#x591F;&#x5E9E;&#x5927;&#xFF0C;&#x53EF;&#x4EE5;&#x51CF;&#x5C11;&#x7EDF;&#x8BA1;&#x8BEF;&#x5DEE;</td>
<td style="text-align:left">&#x65E0;&#x6CD5;&#x91C7;&#x96C6;&#x5B8C;&#x6574;&#x7684;&#x8D44;&#x6E90;&#x52A0;&#x8F7D;&#x7011;&#x5E03;&#x56FE;</td>
</tr>
<tr>
<td style="text-align:left">&#x65B0;&#x5E74;&#x6570;&#x636E;&#x53EF;&#x4E0E;&#x5176;&#x5B83;&#x6570;&#x636E;&#x5173;&#x8054;&#xFF0C;&#x4EA7;&#x751F;&#x66F4;&#x5927;&#x4EF7;&#x503C;</td>
<td style="text-align:left">&#x65E0;&#x6CD5;&#x53EF;&#x89C6;&#x5316;&#x5C55;&#x793A;&#x52A0;&#x8F7D;&#x8FC7;&#x7A0B;</td>
</tr>
</tbody>
</table>
<h4 id="&#x5BF9;&#x6BD4;"><a name="&#x5BF9;&#x6BD4;" class="anchor-navigation-ex-anchor" href="#&#x5BF9;&#x6BD4;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x5BF9;&#x6BD4;" class="plugin-anchor" href="#&#x5BF9;&#x6BD4;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5BF9;&#x6BD4;</h4>
<table>
<thead>
<tr>
<th style="text-align:left">&#x5BF9;&#x6BD4;&#x9879;</th>
<th style="text-align:left">&#x5408;&#x6210;&#x76D1;&#x63A7;</th>
<th style="text-align:left">&#x771F;&#x5B9E;&#x7528;&#x6237;&#x76D1;&#x63A7;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">&#x5B9E;&#x73B0;&#x96BE;&#x5EA6;&#x53CA;&#x6210;&#x672C;</td>
<td style="text-align:left">&#x8F83;&#x4F4E;</td>
<td style="text-align:left">&#x8F83;&#x9AD8;</td>
</tr>
<tr>
<td style="text-align:left">&#x91C7;&#x96C6;&#x6570;&#x636E;&#x4E30;&#x5BCC;&#x5EA6;</td>
<td style="text-align:left">&#x4E30;&#x5BCC;</td>
<td style="text-align:left">&#x57FA;&#x7840;</td>
</tr>
<tr>
<td style="text-align:left">&#x6570;&#x636E;&#x6837;&#x672C;&#x91CF;</td>
<td style="text-align:left">&#x8F83;&#x5C0F;</td>
<td style="text-align:left">&#x5927;(&#x89C6;&#x4E1A;&#x52A1;&#x4F53;&#x91CF;)</td>
</tr>
<tr>
<td style="text-align:left">&#x9002;&#x5408;&#x573A;&#x666F;</td>
<td style="text-align:left">&#x5B9A;&#x6027;&#x5206;&#x6790;, &#x5C0F;&#x6570;&#x636E;&#x91CF;&#x5206;&#x6790;</td>
<td style="text-align:left">&#x5B9A;&#x91CF;&#x5206;&#x6790;, &#x4E1A;&#x52A1;&#x6570;&#x636E;&#x6DF1;&#x5EA6;&#x6316;&#x6398;</td>
</tr>
</tbody>
</table>
<h4 id="&#x65B9;&#x6848;"><a name="&#x65B9;&#x6848;" class="anchor-navigation-ex-anchor" href="#&#x65B9;&#x6848;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x65B9;&#x6848;" class="plugin-anchor" href="#&#x65B9;&#x6848;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x65B9;&#x6848;</h4>
<p>&#x5728;&#x771F;&#x5B9E;&#x7528;&#x6237;&#x6027;&#x80FD;&#x6570;&#x636E;&#x91C7;&#x96C6;&#x65F6;, &#x8981;&#x5173;&#x6CE8;&#x56DB;&#x4E2A;&#x65B9;&#x9762;&#x7684;&#x4E1C;&#x897F;:</p>
<ul>
<li>&#x4F7F;&#x7528;&#x6807;&#x51C6;&#x7684; API</li>
<li>&#x5B9A;&#x4E49;&#x5408;&#x9002;&#x7684;&#x6307;&#x6807;</li>
<li>&#x91C7;&#x96C6;&#x6B63;&#x786E;&#x7684;&#x6570;&#x636E;</li>
<li>&#x4E0A;&#x62A5;&#x5173;&#x8054;&#x7684;&#x7EF4;&#x5EA6;</li>
</ul>
<h4 id="&#x4F7F;&#x7528;&#x6807;&#x51C6;&#x7684;-api"><a name="&#x4F7F;&#x7528;&#x6807;&#x51C6;&#x7684;-api" class="anchor-navigation-ex-anchor" href="#&#x4F7F;&#x7528;&#x6807;&#x51C6;&#x7684;-api"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x4F7F;&#x7528;&#x6807;&#x51C6;&#x7684;-api" class="plugin-anchor" href="#&#x4F7F;&#x7528;&#x6807;&#x51C6;&#x7684;-api"><i class="fa fa-link" aria-hidden="true"></i></a>&#x4F7F;&#x7528;&#x6807;&#x51C6;&#x7684; API</h4>
<p>&#x91C7;&#x96C6;&#x6027;&#x80FD;&#x6570;&#x636E;&#x65F6;&#x5148;&#x62B9;&#x5E73; Navigation Timing spec &#x5DEE;&#x5F02;
&#x4F18;&#x5148;&#x4F7F;&#x7528; PerformanceTimeline API
(&#x5728;&#x590D;&#x6742;&#x573A;&#x666F;&#xFF0C;&#x4EA6;&#x53EF;&#x8003;&#x8651;&#x4F18;&#x5148;&#x4F7F;&#x7528; PerformanceObserver)</p>
<h4 id="&#x5B9A;&#x4E49;&#x5408;&#x9002;&#x7684;&#x6307;&#x6807;"><a name="&#x5B9A;&#x4E49;&#x5408;&#x9002;&#x7684;&#x6307;&#x6807;" class="anchor-navigation-ex-anchor" href="#&#x5B9A;&#x4E49;&#x5408;&#x9002;&#x7684;&#x6307;&#x6807;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x5B9A;&#x4E49;&#x5408;&#x9002;&#x7684;&#x6307;&#x6807;" class="plugin-anchor" href="#&#x5B9A;&#x4E49;&#x5408;&#x9002;&#x7684;&#x6307;&#x6807;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5B9A;&#x4E49;&#x5408;&#x9002;&#x7684;&#x6307;&#x6807;</h4>
<p>First Meaningful Paint: &#x9996;&#x6B21;&#x6709;&#x6548;&#x6E32;&#x67D3;&#x65F6;&#x957F;,
&#x5B83;&#x7684;&#x4E00;&#x4E2A;&#x6838;&#x5FC3;&#x7684;&#x60F3;&#x6CD5;&#x662F;&#x6E32;&#x67D3;&#x5E76;&#x4E0D;&#x4E00;&#x5B9A;&#x4EE3;&#x8868;&#x7740;&#x7528;&#x6237;&#x770B;&#x5230;&#x4E86;&#x4E3B;&#x8981;&#x5185;&#x5BB9;,
Load &#x4E5F;&#x4E0D;&#x4E00;&#x5B9A;&#x4EE3;&#x8868;&#x7528;&#x6237;&#x770B;&#x5230;&#x4E3B;&#x8981;&#x5185;&#x5BB9;.
&#x5047;&#x8BBE;&#x5F53;&#x4E00;&#x4E2A;&#x7F51;&#x9875;&#x7684; DOM &#x7ED3;&#x6784;&#x53D1;&#x751F;&#x5267;&#x70C8;&#x7684;&#x53D8;&#x5316;&#x7684;&#x65F6;&#x5019;,
&#x5C31;&#x662F;&#x8FD9;&#x4E2A;&#x7F51;&#x9875;&#x4E3B;&#x8981;&#x5185;&#x5BB9;&#x51FA;&#x73B0;&#x7684;&#x65F6;&#x5019;,
&#x90A3;&#x4E48;&#x5728;&#x8FD9;&#x6837;&#x7684;&#x4E00;&#x4E2A;&#x65F6;&#x95F4;&#x70B9;&#x4E0A;,
&#x5C31;&#x662F;&#x7528;&#x6237;&#x770B;&#x5230;&#x4E3B;&#x8981;&#x5185;&#x5BB9;&#x7684;&#x4E00;&#x4E2A;&#x65F6;&#x95F4;&#x70B9;.</p>
<p>&#x5B83;&#x7684;&#x4F18;&#x70B9;&#x662F;&#x76F8;&#x5BF9;&#x6821;&#x51C6;&#x7684;&#x4F30;&#x7B97;&#x51FA;&#x5185;&#x5BB9;&#x6E32;&#x67D3;&#x65F6;&#x95F4;, &#x8D34;&#x8FD1;&#x7528;&#x6237;&#x611F;&#x77E5;.
&#x4F46;&#x7F3A;&#x70B9;&#x662F;&#x65E0;&#x539F;&#x751F; API &#x652F;&#x6301;, &#x7B97;&#x6CD5;&#x63A8;&#x5BFC;&#x65F6; DOM &#x8282;&#x70B9;&#xF967;&#x542B;&#x6743;&#x91CD;.</p>
<ul>
<li>First Contentful Paint</li>
<li>First Meaningful Paint</li>
<li>First Ipnut Delay</li>
<li>Time to Interactive</li>
</ul>
<h4 id="&#x4E0A;&#x62A5;&#x5173;&#x8054;&#x7684;&#x7EF4;&#x5EA6;"><a name="&#x4E0A;&#x62A5;&#x5173;&#x8054;&#x7684;&#x7EF4;&#x5EA6;" class="anchor-navigation-ex-anchor" href="#&#x4E0A;&#x62A5;&#x5173;&#x8054;&#x7684;&#x7EF4;&#x5EA6;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x4E0A;&#x62A5;&#x5173;&#x8054;&#x7684;&#x7EF4;&#x5EA6;" class="plugin-anchor" href="#&#x4E0A;&#x62A5;&#x5173;&#x8054;&#x7684;&#x7EF4;&#x5EA6;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x4E0A;&#x62A5;&#x5173;&#x8054;&#x7684;&#x7EF4;&#x5EA6;</h4>
<p>&#x4E0D;&#x540C;&#x7684;&#x9875;&#x9762;&#x64CD;&#x4F5C;/&#x9875;&#x9762;&#x6253;&#x5F00;&#x65B9;&#x5F0F;/&#x6D4F;&#x89C8;&#x5668;&#x73AF;&#x5883;&#x90FD;&#x4F1A;&#x5BF9;&#x6211;&#x4EEC;&#x9875;&#x9762;&#x52A0;&#x8F7D;&#x7684;&#x6027;&#x80FD;&#x4F1A;&#x6709;&#x5F71;&#x54CD;,
&#x9700;&#x8981;&#x4E0A;&#x62A5;&#x8FD9;&#x4E9B;&#x7EF4;&#x5EA6;&#x7684;&#x6570;&#x636E;, &#x4EE5;&#x4FBF;&#x6DF1;&#x5165;&#x6027;&#x80FD;&#x5206;&#x6790;:</p>
<ul>
<li>&#x5F53;&#x524D;&#x9875;&#x9762;&#x662F;&#x5426;&#x53EF;&#x89C1;</li>
<li>&#x9875;&#x9762;&#x52A0;&#x8F7D;&#x65B9;&#x5F0F;: &#x76F4;&#x63A5;&#x6253;&#x5F00;/&#x5237;&#x65B0;&#x6253;&#x5F00;/&#x524D;&#x8FDB;&#x540E;&#x9000;&#x6253;&#x5F00;</li>
<li>&#x662F;&#x5426;&#x542F;&#x7528; HTTP2</li>
<li>&#x662F;&#x5426;&#x542F;&#x7528; Service Worker</li>
</ul>
<h4 id="speed-tools"><a name="speed-tools" class="anchor-navigation-ex-anchor" href="#speed-tools"><i class="fa fa-link" aria-hidden="true"></i></a><a name="speed-tools" class="plugin-anchor" href="#speed-tools"><i class="fa fa-link" aria-hidden="true"></i></a>Speed Tools</h4>
<ul>
<li><a href="https://developers.google.com/web/fundamentals/performance/speed-tools" target="_blank">Speedup Tools</a></li>
<li><a href="https://github.com/GoogleChromeLabs/first-input-delay" target="_blank">FID Tracking</a></li>
<li><a href="https://developers.google.com/speed/pagespeed/insights" target="_blank">PageSpeed Insights</a></li>
<li><a href="https://github.com/GoogleChrome/lighthouse" target="_blank">Lighthouse (<code>audit</code> tab)</a></li>
</ul>
<h3 id="data-format-and-size"><a name="data-format-and-size" class="anchor-navigation-ex-anchor" href="#data-format-and-size"><i class="fa fa-link" aria-hidden="true"></i></a>6.3. Data Format and Size</h3>
<ul>
<li><a href="https://www.keycdn.com/blog/optimize-images-for-web" target="_blank">optimize images for web</a></li>
<li><a href="https://evilmartians.com/chronicles/images-done-right-web-graphics-good-to-the-last-byte-optimization-techniques" target="_blank">Images Optimization Techniques</a></li>
</ul>
<h4 id="images-format"><a name="images-format" class="anchor-navigation-ex-anchor" href="#images-format"><i class="fa fa-link" aria-hidden="true"></i></a><a name="images-format" class="plugin-anchor" href="#images-format"><i class="fa fa-link" aria-hidden="true"></i></a>Images Format</h4>
<p>mp4 smaller than gif (<code>ffmpeg</code>)</p>
<pre class="language-"><code class="lang-html"><span class="token comment">&lt;!-- ffmpeg -i dog.gif dog.mp4 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>video</span> <span class="token attr-name">autoplay</span> <span class="token attr-name">loop</span> <span class="token attr-name">muted</span> <span class="token attr-name">playsinline</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dog.mp4<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>video/mp4<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>video</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<p>WebP 25-35% smaller than jpg/png</p>
<pre class="language-"><code class="lang-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>picture</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image/webp<span class="token punctuation">&quot;</span></span> <span class="token attr-name">srcset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flower.webp<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image/jpeg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">srcset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flower.jpg<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flower.jpg<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>picture</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h4 id="images-compression"><a name="images-compression" class="anchor-navigation-ex-anchor" href="#images-compression"><i class="fa fa-link" aria-hidden="true"></i></a><a name="images-compression" class="plugin-anchor" href="#images-compression"><i class="fa fa-link" aria-hidden="true"></i></a>Images Compression</h4>
<ul>
<li><a href="https://github.com/Klathmon/imagemin-webpack-plugin" target="_blank">Imagemin</a></li>
</ul>
<h4 id="images-scaling"><a name="images-scaling" class="anchor-navigation-ex-anchor" href="#images-scaling"><i class="fa fa-link" aria-hidden="true"></i></a><a name="images-scaling" class="plugin-anchor" href="#images-scaling"><i class="fa fa-link" aria-hidden="true"></i></a>Images Scaling</h4>
<p>responsive images: provide 3~5 different sizes
reduce image transfer sizes by average of ~20%</p>
<ul>
<li><a href="https://github.com/lovell/sharp" target="_blank">Sharp</a></li>
<li><a href="https://github.com/oliver-moran/jimp" target="_blank">Jimp</a></li>
</ul>
<pre class="language-"><code class="lang-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span>
  <span class="token attr-name">srcset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flower-small.jpg 480w, flower-large.jpg 1080w<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">sizes</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50vw<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flower-large.jpg<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">/&gt;</span></span>
</code></pre>
<h3 id="data-loading"><a name="data-loading" class="anchor-navigation-ex-anchor" href="#data-loading"><i class="fa fa-link" aria-hidden="true"></i></a>6.4. Data Loading</h3>
<ul>
<li><a href="https://developers.google.com/web/fundamentals/performance/resource-prioritization" target="_blank">Resources Priority</a></li>
</ul>
<h4 id="data-preloading"><a name="data-preloading" class="anchor-navigation-ex-anchor" href="#data-preloading"><i class="fa fa-link" aria-hidden="true"></i></a><a name="data-preloading" class="plugin-anchor" href="#data-preloading"><i class="fa fa-link" aria-hidden="true"></i></a>Data Preloading</h4>
<pre class="language-"><code class="lang-js"><span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">&quot;preload&quot;</span> <span class="token keyword">as</span><span class="token operator">=</span><span class="token string">&quot;script&quot;</span> href<span class="token operator">=</span><span class="token string">&quot;critical.js&quot;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">&quot;modulepreload&quot;</span> href<span class="token operator">=</span><span class="token string">&quot;critical-module.mjs&quot;</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">&quot;preload&quot;</span> <span class="token keyword">as</span><span class="token operator">=</span><span class="token string">&quot;image&quot;</span> href<span class="token operator">=</span><span class="token string">&quot;...&quot;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">&quot;preload&quot;</span> <span class="token keyword">as</span><span class="token operator">=</span><span class="token string">&quot;font&quot;</span> href<span class="token operator">=</span><span class="token string">&quot;...&quot;</span> crossorigin<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">&quot;preload&quot;</span> <span class="token keyword">as</span><span class="token operator">=</span><span class="token string">&quot;fetch&quot;</span> href<span class="token operator">=</span><span class="token string">&quot;...&quot;</span> crossorigin<span class="token operator">&gt;</span>
</code></pre>
<h4 id="images-lazy-loading"><a name="images-lazy-loading" class="anchor-navigation-ex-anchor" href="#images-lazy-loading"><i class="fa fa-link" aria-hidden="true"></i></a><a name="images-lazy-loading" class="plugin-anchor" href="#images-lazy-loading"><i class="fa fa-link" aria-hidden="true"></i></a>Images Lazy Loading</h4>
<p>Lazy Loading Polyfill:</p>
<pre class="language-"><code class="lang-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flower.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>lazyload<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre>
<pre class="language-"><code class="lang-js">window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;scroll&apos;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">&apos;.lazyload&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">image</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>image<span class="token punctuation">.</span><span class="token function">slideIntoView</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      image<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&apos;src&apos;</span><span class="token punctuation">,</span> image<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Observer Lazy Loading:</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IntersectionObserver</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">nodes</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  nodes<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>v<span class="token punctuation">.</span>isIntersecting<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      v<span class="token punctuation">.</span>target<span class="token punctuation">.</span>src <span class="token operator">=</span> v<span class="token punctuation">.</span>target<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>src<span class="token punctuation">;</span>
      observer<span class="token punctuation">.</span><span class="token function">unobserve</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> imgs <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">&apos;img.lazyload&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
imgs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Native Lazy Loading:</p>
<pre class="language-"><code class="lang-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flower.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">lazyload</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>auto<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flower.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">lazyload</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>on<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flower.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">lazyload</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>off<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre>
<h4 id="javascript-lazy-loading"><a name="javascript-lazy-loading" class="anchor-navigation-ex-anchor" href="#javascript-lazy-loading"><i class="fa fa-link" aria-hidden="true"></i></a><a name="javascript-lazy-loading" class="plugin-anchor" href="#javascript-lazy-loading"><i class="fa fa-link" aria-hidden="true"></i></a>JavaScript Lazy Loading</h4>
<ul>
<li><a href="https://addyosmani.com/blog/script-priorities" target="_blank">Script Priorities</a></li>
<li><code>defer</code>: downloads the script while the document is still parsing,
but waits until the document has finished parsing before executing it
(<strong>in order</strong>)</li>
<li><code>async</code>: downloads the script during parsing the document,
but will <strong>pause</strong> the parser to execute the script</li>
<li>If the scripts rely on each other, use defer</li>
<li>If the script is independent, use async</li>
<li>If put JavaScript in <code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span></code>, in such script can&apos;t access DOM directly
(DOM haven&apos;t get parsed)</li>
</ul>
<p>Best practice: lazy loading scripts not execute immediately
(<strong>Chrome Coverage Devtools</strong>)</p>
<pre class="language-"><code class="lang-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myscript.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myscript.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">async</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myscript.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">defer</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<pre class="language-"><code class="lang-jsx"><span class="token keyword">const</span> DetailsComponent <span class="token operator">=</span> <span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&apos;./details&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">PageComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Suspense</span></span> <span class="token attr-name">fallback</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>Loading<span class="token operator">...</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">DetailsComponent</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Suspense</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="prefetch"><a name="prefetch" class="anchor-navigation-ex-anchor" href="#prefetch"><i class="fa fa-link" aria-hidden="true"></i></a><a name="prefetch" class="plugin-anchor" href="#prefetch"><i class="fa fa-link" aria-hidden="true"></i></a>Prefetch</h4>
<pre class="language-"><code class="lang-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>preload<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>prefetch<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre>
<p><a href="https://addyosmani.com/blog/what-not-to-prefetch-prerender" target="_blank">Why not to prefetch prerender</a>:</p>
<ul>
<li>avoid prefetching pages for authentication</li>
<li>avoid over-prefetching to limit accidental DOS</li>
<li>avoid prefetching pages key to checkout</li>
<li>avoid prefetching large resources</li>
<li>avoid prefetching cross-origin resources</li>
</ul>
<h4 id="babel-config-for-javascript"><a name="babel-config-for-javascript" class="anchor-navigation-ex-anchor" href="#babel-config-for-javascript"><i class="fa fa-link" aria-hidden="true"></i></a><a name="babel-config-for-javascript" class="plugin-anchor" href="#babel-config-for-javascript"><i class="fa fa-link" aria-hidden="true"></i></a>Babel Config for JavaScript</h4>
<pre class="language-"><code class="lang-json"><span class="token punctuation">{</span>
  <span class="token property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;targets&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;esmodules&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          <span class="token property">&quot;node&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&gt;= 8&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;browsers&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&gt; 0.25%&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;useBuiltIns&quot;</span><span class="token operator">:</span> <span class="token string">&quot;usage&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">&quot;module&quot;</span> src<span class="token operator">=</span><span class="token string">&quot;main.mjs&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script nomodule src<span class="token operator">=</span><span class="token string">&quot;legacy.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre>
<h3 id="v8-good-parts"><a name="v8-good-parts" class="anchor-navigation-ex-anchor" href="#v8-good-parts"><i class="fa fa-link" aria-hidden="true"></i></a>6.5. V8 Good Parts</h3>
<ul>
<li>source code (parser) AST (interpreter) bytecode</li>
<li>send profilling data from bytecode to optimizing compiler, generate optimized code</li>
<li><strong>Ignition</strong> interpreter</li>
<li><strong>TurboFan</strong> optimizing compiler (2 for SpiderMonkey/Edge, 3 for Safari)</li>
</ul>
<h4 id="object-shape"><a name="object-shape" class="anchor-navigation-ex-anchor" href="#object-shape"><i class="fa fa-link" aria-hidden="true"></i></a><a name="object-shape" class="plugin-anchor" href="#object-shape"><i class="fa fa-link" aria-hidden="true"></i></a>Object Shape</h4>
<ul>
<li><a href="https://mathiasbynens.be/notes/shapes-ics" target="_blank">Shapes ICS</a></li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// o1 and o2 have the same shape</span>
<span class="token comment">// JSObject(1, 2) =&gt; Shape(&apos;x&apos;, &apos;y&apos;)</span>
<span class="token comment">// JSObject(3, 4) =&gt; Shape(&apos;x&apos;, &apos;y&apos;)</span>
<span class="token comment">// &apos;x&apos; =&gt; 0 Offset, Writable, Enumerable, Configurable</span>
<span class="token comment">// &apos;y&apos; =&gt; 1 Offset, Writable, Enumerable, Configurable</span>
<span class="token keyword">const</span> o1 <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> o2 <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>Shape Transform</p>
<pre class="language-"><code class="lang-js"><span class="token comment">// Shape chain: Shape(empty) =&gt; Shape(x) =&gt; Shape(x, y)</span>
<span class="token keyword">const</span> o <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
o<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
o<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

<span class="token comment">// Shape chain: Shape(empty) =&gt; Shape(y) =&gt; Shape(y, x)</span>
<span class="token keyword">const</span> o <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
o<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
o<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">// Shape chain: Shape(x)</span>
<span class="token keyword">const</span> o <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>array shape: Shape(&apos;length&apos;), &apos;length&apos; =&gt; 0 Offset, Writable</p>
<h4 id="inline-cache"><a name="inline-cache" class="anchor-navigation-ex-anchor" href="#inline-cache"><i class="fa fa-link" aria-hidden="true"></i></a><a name="inline-cache" class="plugin-anchor" href="#inline-cache"><i class="fa fa-link" aria-hidden="true"></i></a>Inline Cache</h4>
<p>V8 use ICs to memorize information (same shape) where to find properties on objects:</p>
<ul>
<li>always initialize objects in the same way (generate the same shape)</li>
<li>don&apos;t add property to objects dynamically (invalid inline cache)</li>
<li>don&apos;t mess with property attributes of array elements</li>
</ul>
<h4 id="v8-perf-tools"><a name="v8-perf-tools" class="anchor-navigation-ex-anchor" href="#v8-perf-tools"><i class="fa fa-link" aria-hidden="true"></i></a><a name="v8-perf-tools" class="plugin-anchor" href="#v8-perf-tools"><i class="fa fa-link" aria-hidden="true"></i></a>V8 Perf Tools</h4>
<ul>
<li><a href="https://github.com/thlorenz/deoptigate" target="_blank">deoptigate</a></li>
<li><a href="https://github.com/thlorenz/turbolizer" target="_blank">turbolizer</a></li>
<li><a href="https://github.com/thlorenz/v8-map-processor" target="_blank">v8 map processor</a></li>
</ul>
<h4 id="awesome-v8-performance-tutorial"><a name="awesome-v8-performance-tutorial" class="anchor-navigation-ex-anchor" href="#awesome-v8-performance-tutorial"><i class="fa fa-link" aria-hidden="true"></i></a><a name="awesome-v8-performance-tutorial" class="plugin-anchor" href="#awesome-v8-performance-tutorial"><i class="fa fa-link" aria-hidden="true"></i></a>Awesome V8 Performance Tutorial</h4>
<ul>
<li><a href="https://github.com/thlorenz/v8-perf" target="_blank">v8 perf</a></li>
</ul>
<h3 id="perf-and-analysis-tools"><a name="perf-and-analysis-tools" class="anchor-navigation-ex-anchor" href="#perf-and-analysis-tools"><i class="fa fa-link" aria-hidden="true"></i></a>6.6. Perf and Analysis Tools</h3>
<ul>
<li><a href="https://developers.google.com/web/tools/chrome-devtools/evaluate-performance/reference" target="_blank">Chrome DevTools</a></li>
<li><a href="https://developers.google.com/web/tools/chrome-user-experience-report" target="_blank">Chrome UX Report</a></li>
</ul>
<p>Audits of Chrome: PWA, best practices, SEO, performance, device simulator</p>
<h4 id="inspect-android-device"><a name="inspect-android-device" class="anchor-navigation-ex-anchor" href="#inspect-android-device"><i class="fa fa-link" aria-hidden="true"></i></a><a name="inspect-android-device" class="plugin-anchor" href="#inspect-android-device"><i class="fa fa-link" aria-hidden="true"></i></a>Inspect Android Device</h4>
<ul>
<li>enable developmemnt mode and USB debugging in Android Device</li>
<li>link Android and PC with USB cable</li>
<li>open <code>chrome://inspect/#devices</code> to start inspecting</li>
</ul>
<h3 id="performance-best-practice"><a name="performance-best-practice" class="anchor-navigation-ex-anchor" href="#performance-best-practice"><i class="fa fa-link" aria-hidden="true"></i></a>6.7. Performance Best Practice</h3>
<ul>
<li>use monomorphic objects due to shape and inline caches</li>
<li>use monomorphic fucntion in hot code paths</li>
<li>resource optimization</li>
<li>code splitting</li>
<li>lazy loading</li>
<li>offline caching (PWA)</li>
</ul>
<h2 id="testing-and-debugging"><a name="testing-and-debugging" class="anchor-navigation-ex-anchor" href="#testing-and-debugging"><i class="fa fa-link" aria-hidden="true"></i></a>7. Testing and Debugging</h2>
<h3 id="log"><a name="log" class="anchor-navigation-ex-anchor" href="#log"><i class="fa fa-link" aria-hidden="true"></i></a>7.1. Log</h3>
<ul>
<li>&#x65F6;&#x95F4;&#xFF0C;&#x5305;&#x542B;&#x65F6;&#x533A;&#x4FE1;&#x606F;&#x548C;&#x6BEB;&#x79D2;</li>
<li>&#x65E5;&#x5FD7;&#x7EA7;&#x522B;</li>
<li>&#x4F1A;&#x8BDD;&#x6807;&#x8BC6;</li>
<li>&#x529F;&#x80FD;&#x6807;&#x8BC6;</li>
<li>&#x7CBE;&#x70BC;&#x7684;&#x5185;&#x5BB9;: &#x573A;&#x666F;&#x4FE1;&#x606F;&#xFF08;&#x8C01;&#xFF0C;&#x4EC0;&#x4E48;&#x529F;&#x80FD;&#x7B49;&#xFF09;&#xFF0C;&#x72B6;&#x6001;&#x4FE1;&#x606F;(&#x5F00;&#x59CB;&#xFF0C;&#x4E2D;&#x65AD;&#xFF0C;&#x7ED3;&#x675F;)&#x4EE5;&#x53CA;&#x91CD;&#x8981;&#x53C2;&#x6570;</li>
<li>&#x5176;&#x4ED6;&#x4FE1;&#x606F;&#xFF1A;&#x7248;&#x672C;&#x53F7;&#xFF0C;&#x7EBF;&#x7A0B;&#x53F7;</li>
</ul>
<h4 id="log-clock"><a name="log-clock" class="anchor-navigation-ex-anchor" href="#log-clock"><i class="fa fa-link" aria-hidden="true"></i></a><a name="log-clock" class="plugin-anchor" href="#log-clock"><i class="fa fa-link" aria-hidden="true"></i></a>Log Clock</h4>
<ul>
<li><code>performance.now()</code> is more precise (100 us)</li>
<li><code>performance.now()</code> is strictly monotonic (unaffected by changes of machine time)</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">let</span> lastVisibilityChange <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;visibilitychange&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  lastVisibilityChange <span class="token operator">=</span> performance<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// don&#x2019;t log any metrics started before the last visibility change</span>
<span class="token comment">// don&apos;t log any metrics if the page is hidden</span>
<span class="token comment">// discard perf data from when the machine was not running app at full speed</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>metric<span class="token punctuation">.</span>start <span class="token operator">&lt;</span> lastVisibilityChange <span class="token operator">||</span> document<span class="token punctuation">.</span>hidden<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">timestamp</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    metric<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span>timestamp<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="headless-testing"><a name="headless-testing" class="anchor-navigation-ex-anchor" href="#headless-testing"><i class="fa fa-link" aria-hidden="true"></i></a>7.2. Headless Testing</h3>
<ul>
<li><a href="https://pptr.dev/#?product=Puppeteer&amp;version=v1.16.0&amp;show=api-class-page" target="_blank">Puppeteer</a></li>
<li><a href="https://addyosmani.com/blog/puppeteer-recipes" target="_blank">Puppeteer Recipes</a></li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> puppeteer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;puppeteer&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> browser <span class="token operator">=</span> <span class="token keyword">await</span> puppeteer<span class="token punctuation">.</span><span class="token function">launch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> page <span class="token operator">=</span> <span class="token keyword">await</span> browser<span class="token punctuation">.</span><span class="token function">newPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">goto</span><span class="token punctuation">(</span><span class="token string">&apos;https://example.com&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">screenshot</span><span class="token punctuation">(</span><span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">&apos;example.png&apos;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> browser<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="browser-context"><a name="browser-context" class="anchor-navigation-ex-anchor" href="#browser-context"><i class="fa fa-link" aria-hidden="true"></i></a><a name="browser-context" class="plugin-anchor" href="#browser-context"><i class="fa fa-link" aria-hidden="true"></i></a>Browser Context</h4>
<pre class="language-"><code class="lang-js"><span class="token comment">// Create a new incognito browser context</span>
<span class="token keyword">const</span> context <span class="token operator">=</span> <span class="token keyword">await</span> browser<span class="token punctuation">.</span><span class="token function">createIncognitoBrowserContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Create a new page inside context.</span>
<span class="token keyword">const</span> page <span class="token operator">=</span> <span class="token keyword">await</span> context<span class="token punctuation">.</span><span class="token function">newPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ... do stuff with page ...</span>
<span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">goto</span><span class="token punctuation">(</span><span class="token string">&apos;https://example.com&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Dispose context once it&apos;s no longer needed.</span>
<span class="token keyword">await</span> context<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="dom-testing"><a name="dom-testing" class="anchor-navigation-ex-anchor" href="#dom-testing"><i class="fa fa-link" aria-hidden="true"></i></a><a name="dom-testing" class="plugin-anchor" href="#dom-testing"><i class="fa fa-link" aria-hidden="true"></i></a>DOM Testing</h4>
<p><code>page.$(selector)</code> same to <code>querySelector</code></p>
<h4 id="event-testing"><a name="event-testing" class="anchor-navigation-ex-anchor" href="#event-testing"><i class="fa fa-link" aria-hidden="true"></i></a><a name="event-testing" class="plugin-anchor" href="#event-testing"><i class="fa fa-link" aria-hidden="true"></i></a>Event Testing</h4>
<pre class="language-"><code class="lang-js"><span class="token comment">// wait for selector</span>
<span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">waitFor</span><span class="token punctuation">(</span><span class="token string">&apos;.foo&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// wait for 1 second</span>
<span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">waitFor</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// wait for predicate</span>
<span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">waitFor</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span><span class="token operator">!</span>document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&apos;.foo&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> puppeteer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;puppeteer&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

puppeteer<span class="token punctuation">.</span><span class="token function">launch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">browser</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> page <span class="token operator">=</span> <span class="token keyword">await</span> browser<span class="token punctuation">.</span><span class="token function">newPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> watchDog <span class="token operator">=</span> page<span class="token punctuation">.</span><span class="token function">waitForFunction</span><span class="token punctuation">(</span><span class="token string">&apos;window.innerWidth &lt; 100&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">setViewport</span><span class="token punctuation">(</span><span class="token punctuation">{</span> width<span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span> height<span class="token operator">:</span> <span class="token number">50</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> watchDog<span class="token punctuation">;</span>
  <span class="token keyword">await</span> browser<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> <span class="token punctuation">[</span>response<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  page<span class="token punctuation">.</span><span class="token function">waitForNavigation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// The promise resolves after navigation has finished</span>
  page<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string">&apos;a.my-link&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Clicking the link will indirectly cause a navigation</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> firstRequest <span class="token operator">=</span> <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">waitForRequest</span><span class="token punctuation">(</span><span class="token string">&apos;http://example.com/resource&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> finalRequest <span class="token operator">=</span> <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">waitForRequest</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token parameter">request</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    request<span class="token punctuation">.</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&apos;http://example.com&apos;</span> <span class="token operator">&amp;&amp;</span> request<span class="token punctuation">.</span><span class="token function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&apos;GET&apos;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> firstRequest<span class="token punctuation">.</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> firstResponse <span class="token operator">=</span> <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">waitForResponse</span><span class="token punctuation">(</span>
  <span class="token string">&apos;https://example.com/resource&apos;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> finalResponse <span class="token operator">=</span> <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">waitForResponse</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    response<span class="token punctuation">.</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&apos;https://example.com&apos;</span> <span class="token operator">&amp;&amp;</span> response<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">200</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> finalResponse<span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">evaluate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> window<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&apos;https://www.example.com/&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> newWindowTarget <span class="token operator">=</span> <span class="token keyword">await</span> browserContext<span class="token punctuation">.</span><span class="token function">waitForTarget</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> target<span class="token punctuation">.</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&apos;https://www.example.com/&apos;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="operation-simulation-testing"><a name="operation-simulation-testing" class="anchor-navigation-ex-anchor" href="#operation-simulation-testing"><i class="fa fa-link" aria-hidden="true"></i></a><a name="operation-simulation-testing" class="plugin-anchor" href="#operation-simulation-testing"><i class="fa fa-link" aria-hidden="true"></i></a>Operation Simulation Testing</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> <span class="token punctuation">[</span>response<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  page<span class="token punctuation">.</span><span class="token function">waitForNavigation</span><span class="token punctuation">(</span>waitOptions<span class="token punctuation">)</span><span class="token punctuation">,</span>
  page<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span>selector<span class="token punctuation">,</span> clickOptions<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token comment">// Using &#x2018;page.mouse&#x2019; to trace a 100x100 square.</span>
<span class="token keyword">await</span> page<span class="token punctuation">.</span>mouse<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> page<span class="token punctuation">.</span>mouse<span class="token punctuation">.</span><span class="token function">down</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> page<span class="token punctuation">.</span>mouse<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> page<span class="token punctuation">.</span>mouse<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> page<span class="token punctuation">.</span>mouse<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> page<span class="token punctuation">.</span>mouse<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> page<span class="token punctuation">.</span>mouse<span class="token punctuation">.</span><span class="token function">up</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token keyword">await</span> page<span class="token punctuation">.</span>keyboard<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">&apos;Hello World!&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> page<span class="token punctuation">.</span>keyboard<span class="token punctuation">.</span><span class="token function">press</span><span class="token punctuation">(</span><span class="token string">&apos;ArrowLeft&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">await</span> page<span class="token punctuation">.</span>keyboard<span class="token punctuation">.</span><span class="token function">down</span><span class="token punctuation">(</span><span class="token string">&apos;Shift&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token string">&apos; World&apos;</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span>keyboard<span class="token punctuation">.</span><span class="token function">press</span><span class="token punctuation">(</span><span class="token string">&apos;ArrowLeft&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> page<span class="token punctuation">.</span>keyboard<span class="token punctuation">.</span><span class="token function">up</span><span class="token punctuation">(</span><span class="token string">&apos;Shift&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">await</span> page<span class="token punctuation">.</span>keyboard<span class="token punctuation">.</span><span class="token function">press</span><span class="token punctuation">(</span><span class="token string">&apos;Backspace&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Result text will end up saying &apos;Hello!&apos;</span>
</code></pre>
<h4 id="tracing-testing"><a name="tracing-testing" class="anchor-navigation-ex-anchor" href="#tracing-testing"><i class="fa fa-link" aria-hidden="true"></i></a><a name="tracing-testing" class="plugin-anchor" href="#tracing-testing"><i class="fa fa-link" aria-hidden="true"></i></a>Tracing Testing</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">await</span> page<span class="token punctuation">.</span>tracing<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">&apos;trace.json&apos;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">goto</span><span class="token punctuation">(</span><span class="token string">&apos;https://www.google.com&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> page<span class="token punctuation">.</span>tracing<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="other-puppeterr-testing-api"><a name="other-puppeterr-testing-api" class="anchor-navigation-ex-anchor" href="#other-puppeterr-testing-api"><i class="fa fa-link" aria-hidden="true"></i></a><a name="other-puppeterr-testing-api" class="plugin-anchor" href="#other-puppeterr-testing-api"><i class="fa fa-link" aria-hidden="true"></i></a>Other Puppeterr Testing API</h4>
<ul>
<li><code>page.setOfflineMode</code></li>
<li><code>page.setGeolocation</code></li>
<li><code>page.metrics</code></li>
<li><code>page.accessibility</code></li>
<li><code>page.coverage</code></li>
</ul>
<h3 id="frameworks"><a name="frameworks" class="anchor-navigation-ex-anchor" href="#frameworks"><i class="fa fa-link" aria-hidden="true"></i></a>7.3. Frameworks</h3>
<h4 id="unit-&#x6D4B;&#x8BD5;"><a name="unit-&#x6D4B;&#x8BD5;" class="anchor-navigation-ex-anchor" href="#unit-&#x6D4B;&#x8BD5;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="unit-&#x6D4B;&#x8BD5;" class="plugin-anchor" href="#unit-&#x6D4B;&#x8BD5;"><i class="fa fa-link" aria-hidden="true"></i></a>Unit &#x6D4B;&#x8BD5;</h4>
<ul>
<li>Jasmine</li>
<li>Mocha</li>
</ul>
<h4 id="ui-&#x6D4B;&#x8BD5;"><a name="ui-&#x6D4B;&#x8BD5;" class="anchor-navigation-ex-anchor" href="#ui-&#x6D4B;&#x8BD5;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="ui-&#x6D4B;&#x8BD5;" class="plugin-anchor" href="#ui-&#x6D4B;&#x8BD5;"><i class="fa fa-link" aria-hidden="true"></i></a>UI &#x6D4B;&#x8BD5;</h4>
<ul>
<li>&#x7528;&#x6237;&#x884C;&#x4E3A;: Karma/Selenium</li>
<li>&#x529F;&#x80FD;&#x6D4B;&#x8BD5;: Phantomjs/Slimerjs/Karma</li>
</ul>
<h3 id="&#x53EF;&#x6D4B;&#x8BD5;&#x4EE3;&#x7801;"><a name="&#x53EF;&#x6D4B;&#x8BD5;&#x4EE3;&#x7801;" class="anchor-navigation-ex-anchor" href="#&#x53EF;&#x6D4B;&#x8BD5;&#x4EE3;&#x7801;"><i class="fa fa-link" aria-hidden="true"></i></a>7.4. &#x53EF;&#x6D4B;&#x8BD5;&#x4EE3;&#x7801;</h3>
<ul>
<li>&#x5B8C;&#x6574;&#x6CE8;&#x91CA;</li>
<li>&#x6700;&#x5C0F;&#x590D;&#x6742;&#x5EA6; = (&#x6247;&#x5165; * &#x6247;&#x51FA;) ^ 2</li>
<li>&#x53EF;&#x9694;&#x79BB;&#x6027;: &#x6700;&#x5C0F;&#x4F9D;&#x8D56;&#x6027; + &#x677E;&#x8026;&#x5408;&#x6027;</li>
</ul>
<h4 id="&#x8303;&#x4F8B;"><a name="&#x8303;&#x4F8B;" class="anchor-navigation-ex-anchor" href="#&#x8303;&#x4F8B;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x8303;&#x4F8B;" class="plugin-anchor" href="#&#x8303;&#x4F8B;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x8303;&#x4F8B;</h4>
<ul>
<li>&#x4F7F;&#x7528;&#x4F9D;&#x8D56;&#x6CE8;&#x5165;&#xFF0C;&#x5C06;&#x5916;&#x90E8;&#x5BF9;&#x8C61;&#x79FB;&#x81F3;&#x51FD;&#x6570;&#x53C2;&#x6570;&#x5904;(&#x4E0D;&#x5728;&#x51FD;&#x6570;&#x5185;&#x90E8;&#x8C03;&#x7528;&#x6784;&#x9020;&#x5668;): &#x6613;&#x4E8E;&#x6784;&#x9020; mock/stub, &#x964D;&#x4F4E;&#x6247;&#x51FA;(&#x51FD;&#x6570;&#x590D;&#x6742;&#x5EA6;)</li>
</ul>
<h3 id="&#x5708;&#x590D;&#x6742;&#x5EA6;"><a name="&#x5708;&#x590D;&#x6742;&#x5EA6;" class="anchor-navigation-ex-anchor" href="#&#x5708;&#x590D;&#x6742;&#x5EA6;"><i class="fa fa-link" aria-hidden="true"></i></a>7.5. &#x5708;&#x590D;&#x6742;&#x5EA6;</h3>
<p>V(G) = e - n + 2 <strong>&lt;10</strong></p>
<h3 id="&#x51FD;&#x6570;&#x590D;&#x6742;&#x5EA6;"><a name="&#x51FD;&#x6570;&#x590D;&#x6742;&#x5EA6;" class="anchor-navigation-ex-anchor" href="#&#x51FD;&#x6570;&#x590D;&#x6742;&#x5EA6;"><i class="fa fa-link" aria-hidden="true"></i></a>7.6. &#x51FD;&#x6570;&#x590D;&#x6742;&#x5EA6;</h3>
<p>&#x51FD;&#x6570;&#x590D;&#x6742;&#x5EA6; = (&#x6247;&#x5165; * &#x6247;&#x51FA;) ^ 2</p>
<h4 id="&#x6247;&#x51FA;&#x5F15;&#x7528;-7"><a name="&#x6247;&#x51FA;&#x5F15;&#x7528;-7" class="anchor-navigation-ex-anchor" href="#&#x6247;&#x51FA;&#x5F15;&#x7528;-7"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x6247;&#x51FA;&#x5F15;&#x7528;-7" class="plugin-anchor" href="#&#x6247;&#x51FA;&#x5F15;&#x7528;-7"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6247;&#x51FA;(&#x5F15;&#x7528;) <strong>&lt;7</strong></h4>
<ul>
<li>&#x6240;&#x5F15;&#x7528;&#x5916;&#x90E8;&#x5BF9;&#x8C61;/&#x65B9;&#x6CD5;&#x4E4B;&#x548C;</li>
<li>&#x9AD8;&#x6247;&#x51FA;: &#x9AD8;&#x590D;&#x6742;&#x5EA6;/&#x9AD8;&#x4F9D;&#x8D56;&#x6027;/&#x9AD8;&#x8026;&#x5408;&#x5EA6;</li>
</ul>
<h4 id="&#x6247;&#x5165;&#x88AB;&#x5F15;&#x7528;"><a name="&#x6247;&#x5165;&#x88AB;&#x5F15;&#x7528;" class="anchor-navigation-ex-anchor" href="#&#x6247;&#x5165;&#x88AB;&#x5F15;&#x7528;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x6247;&#x5165;&#x88AB;&#x5F15;&#x7528;" class="plugin-anchor" href="#&#x6247;&#x5165;&#x88AB;&#x5F15;&#x7528;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6247;&#x5165;(&#x88AB;&#x5F15;&#x7528;)</h4>
<ul>
<li>&#x5176;&#x4ED6;&#x5BF9;&#x8C61;/&#x65B9;&#x6CD5;&#x5F15;&#x7528;&#x6B64;&#x51FD;&#x6570;&#x7684;&#x6B21;&#x6570;&#x4E4B;&#x548C;</li>
<li>&#x9876;&#x5C42;&#x62BD;&#x8C61;&#x4EE3;&#x7801; &#x4E0E; &#x4E0D;&#x5E38;&#x7528;&#x529F;&#x80FD; &#x5E94;&#x4FDD;&#x6301;&#x4F4E;&#x6247;&#x5165;</li>
</ul>
<h3 id="&#x8026;&#x5408;&#x5EA6;"><a name="&#x8026;&#x5408;&#x5EA6;" class="anchor-navigation-ex-anchor" href="#&#x8026;&#x5408;&#x5EA6;"><i class="fa fa-link" aria-hidden="true"></i></a>7.7. &#x8026;&#x5408;&#x5EA6;</h3>
<h4 id="&#x5185;&#x5BB9;&#x8026;&#x5408;5"><a name="&#x5185;&#x5BB9;&#x8026;&#x5408;5" class="anchor-navigation-ex-anchor" href="#&#x5185;&#x5BB9;&#x8026;&#x5408;5"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x5185;&#x5BB9;&#x8026;&#x5408;5" class="plugin-anchor" href="#&#x5185;&#x5BB9;&#x8026;&#x5408;5"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5185;&#x5BB9;&#x8026;&#x5408;(5)</h4>
<pre class="language-"><code class="lang-js"><span class="token constant">O</span><span class="token punctuation">.</span>property <span class="token operator">=</span> <span class="token string">&apos;tazimi&apos;</span><span class="token punctuation">;</span>
<span class="token constant">O</span><span class="token punctuation">.</span><span class="token function-variable function">method</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">O</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">method</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="&#x516C;&#x5171;&#x8026;&#x5408;4"><a name="&#x516C;&#x5171;&#x8026;&#x5408;4" class="anchor-navigation-ex-anchor" href="#&#x516C;&#x5171;&#x8026;&#x5408;4"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x516C;&#x5171;&#x8026;&#x5408;4" class="plugin-anchor" href="#&#x516C;&#x5171;&#x8026;&#x5408;4"><i class="fa fa-link" aria-hidden="true"></i></a>&#x516C;&#x5171;&#x8026;&#x5408;(4)</h4>
<p>&#x5171;&#x4EAB;&#x5168;&#x5C40;&#x53D8;&#x91CF;</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> Global <span class="token operator">=</span> <span class="token string">&apos;global&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token constant">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Global <span class="token operator">=</span> <span class="token string">&apos;A&apos;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token constant">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Global <span class="token operator">=</span> <span class="token string">&apos;B&apos;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h4 id="&#x63A7;&#x5236;&#x8026;&#x5408;3"><a name="&#x63A7;&#x5236;&#x8026;&#x5408;3" class="anchor-navigation-ex-anchor" href="#&#x63A7;&#x5236;&#x8026;&#x5408;3"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x63A7;&#x5236;&#x8026;&#x5408;3" class="plugin-anchor" href="#&#x63A7;&#x5236;&#x8026;&#x5408;3"><i class="fa fa-link" aria-hidden="true"></i></a>&#x63A7;&#x5236;&#x8026;&#x5408;(3)</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> absFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AbstractFactory</span><span class="token punctuation">(</span><span class="token punctuation">{</span> env<span class="token operator">:</span> <span class="token string">&apos;TEST&apos;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="&#x5370;&#x8BB0;&#x8026;&#x5408;2"><a name="&#x5370;&#x8BB0;&#x8026;&#x5408;2" class="anchor-navigation-ex-anchor" href="#&#x5370;&#x8BB0;&#x8026;&#x5408;2"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x5370;&#x8BB0;&#x8026;&#x5408;2" class="plugin-anchor" href="#&#x5370;&#x8BB0;&#x8026;&#x5408;2"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5370;&#x8BB0;&#x8026;&#x5408;(2)</h4>
<pre class="language-"><code class="lang-js"><span class="token class-name">O</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">makeBread</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Bread</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>type<span class="token punctuation">,</span> args<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token constant">O</span><span class="token punctuation">.</span><span class="token function">makeBread</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> wheat<span class="token punctuation">,</span> size<span class="token operator">:</span> <span class="token number">99</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&apos;foo&apos;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="&#x6570;&#x636E;&#x8026;&#x5408;1"><a name="&#x6570;&#x636E;&#x8026;&#x5408;1" class="anchor-navigation-ex-anchor" href="#&#x6570;&#x636E;&#x8026;&#x5408;1"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x6570;&#x636E;&#x8026;&#x5408;1" class="plugin-anchor" href="#&#x6570;&#x636E;&#x8026;&#x5408;1"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6570;&#x636E;&#x8026;&#x5408;(1)</h4>
<h4 id="&#x65E0;&#x8026;&#x5408;0"><a name="&#x65E0;&#x8026;&#x5408;0" class="anchor-navigation-ex-anchor" href="#&#x65E0;&#x8026;&#x5408;0"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x65E0;&#x8026;&#x5408;0" class="plugin-anchor" href="#&#x65E0;&#x8026;&#x5408;0"><i class="fa fa-link" aria-hidden="true"></i></a>&#x65E0;&#x8026;&#x5408;(0)</h4>
<h3 id="&#x5355;&#x5143;&#x6D4B;&#x8BD5;"><a name="&#x5355;&#x5143;&#x6D4B;&#x8BD5;" class="anchor-navigation-ex-anchor" href="#&#x5355;&#x5143;&#x6D4B;&#x8BD5;"><i class="fa fa-link" aria-hidden="true"></i></a>7.8. &#x5355;&#x5143;&#x6D4B;&#x8BD5;</h3>
<h4 id="&#x6D4B;&#x8BD5;&#x539F;&#x5219;"><a name="&#x6D4B;&#x8BD5;&#x539F;&#x5219;" class="anchor-navigation-ex-anchor" href="#&#x6D4B;&#x8BD5;&#x539F;&#x5219;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x6D4B;&#x8BD5;&#x539F;&#x5219;" class="plugin-anchor" href="#&#x6D4B;&#x8BD5;&#x539F;&#x5219;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6D4B;&#x8BD5;&#x539F;&#x5219;</h4>
<ul>
<li>&#x4EE3;&#x7801;&#x8986;&#x76D6;&#x7387;</li>
<li>&#x975E;&#x6CD5;&#x503C;&#x6D4B;&#x8BD5;</li>
<li>&#x8FB9;&#x754C;&#x6D4B;&#x8BD5;</li>
<li>&#x975E;&#x8FB9;&#x754C;&#x6D4B;&#x8BD5;</li>
</ul>
<h4 id="&#x9694;&#x79BB;&#x88AB;&#x6D4B;&#x4EE3;&#x7801;"><a name="&#x9694;&#x79BB;&#x88AB;&#x6D4B;&#x4EE3;&#x7801;" class="anchor-navigation-ex-anchor" href="#&#x9694;&#x79BB;&#x88AB;&#x6D4B;&#x4EE3;&#x7801;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x9694;&#x79BB;&#x88AB;&#x6D4B;&#x4EE3;&#x7801;" class="plugin-anchor" href="#&#x9694;&#x79BB;&#x88AB;&#x6D4B;&#x4EE3;&#x7801;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x9694;&#x79BB;&#x88AB;&#x6D4B;&#x4EE3;&#x7801;</h4>
<ul>
<li>&#x7F16;&#x5199;&#x4EE3;&#x7801;&#x65F6;&#xFF0C;&#x4FDD;&#x6301;&#x6700;&#x5C0F;&#x590D;&#x6742;&#x5EA6;(&#x6700;&#x5C0F;&#x4F9D;&#x8D56;&#xFF0C;&#x6700;&#x4F4E;&#x8026;&#x5408;)</li>
<li>&#x5229;&#x7528; mock/stub &#x6A21;&#x62DF;&#x5916;&#x90E8;&#x4F9D;&#x8D56;/&#x6D4B;&#x8BD5;&#x6570;&#x636E;</li>
</ul>
<h4 id="mockstubspy"><a name="mockstubspy" class="anchor-navigation-ex-anchor" href="#mockstubspy"><i class="fa fa-link" aria-hidden="true"></i></a><a name="mockstubspy" class="plugin-anchor" href="#mockstubspy"><i class="fa fa-link" aria-hidden="true"></i></a>mock/stub/spy</h4>
<ul>
<li>mock: &#x6A21;&#x62DF;&#x5BF9;&#x8C61;&#x4E2D;&#x7684;&#x65B9;&#x6CD5;/&#x63A5;&#x53E3;</li>
<li>stub: &#x6A21;&#x62DF;&#x5BF9;&#x8C61;&#x4E2D;&#x7684;&#x8FD4;&#x56DE;&#x503C;</li>
<li>spy: &#x5728;&#x539F;&#x6709;&#x5BF9;&#x8C61;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#xFF0C;&#x589E;&#x52A0;&#x76D1;&#x89C6;&#x7528;&#x53D8;&#x91CF;/&#x65B9;&#x6CD5; e.g assert/&#x8C03;&#x7528;&#x6B21;&#x6570;/&#x53C2;&#x6570;&#x9650;&#x5236;</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> mockery <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;mockery&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mockery<span class="token punctuation">.</span><span class="token function">enable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&apos;Sum suite File&apos;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    mockery<span class="token punctuation">.</span><span class="token function">registerAllowable</span><span class="token punctuation">(</span><span class="token string">&apos;./mySumFS&apos;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    mockery<span class="token punctuation">.</span><span class="token function">deregisterAllowable</span><span class="token punctuation">(</span><span class="token string">&apos;./mySumFS&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&apos;Adds Integers!&apos;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> filename <span class="token operator">=</span> <span class="token string">&apos;numbers&apos;</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> fsMock <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">readFileSync</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">path<span class="token punctuation">,</span> encoding</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">expect</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">expect</span><span class="token punctuation">(</span>encoding<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token string">&apos;utf8&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">9</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    mockery<span class="token punctuation">.</span><span class="token function">registerMock</span><span class="token punctuation">(</span><span class="token string">&apos;fs&apos;</span><span class="token punctuation">,</span> fsMock<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> mySum <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;./mySumFS&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>mySum<span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    mockery<span class="token punctuation">.</span><span class="token function">deregisterMock</span><span class="token punctuation">(</span><span class="token string">&apos;fs&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="monkey-patch"><a name="monkey-patch" class="anchor-navigation-ex-anchor" href="#monkey-patch"><i class="fa fa-link" aria-hidden="true"></i></a>7.9. Monkey Patch</h3>
<pre class="language-"><code class="lang-js"><span class="token keyword">let</span> <span class="token function-variable function">_wr</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> orig <span class="token operator">=</span> window<span class="token punctuation">.</span>history<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> rv <span class="token operator">=</span> <span class="token function">orig</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> e <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Event</span><span class="token punctuation">(</span>type<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    e<span class="token punctuation">.</span>arguments <span class="token operator">=</span> arguments<span class="token punctuation">;</span>
    window<span class="token punctuation">.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> rv<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

window<span class="token punctuation">.</span>history<span class="token punctuation">.</span>pushState <span class="token operator">=</span> <span class="token function">_wr</span><span class="token punctuation">(</span><span class="token string">&apos;pushState&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
window<span class="token punctuation">.</span>history<span class="token punctuation">.</span>replaceState <span class="token operator">=</span> <span class="token function">_wr</span><span class="token punctuation">(</span><span class="token string">&apos;replaceState&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;pushstate&apos;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// doing something</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;replacestate&apos;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// doing something</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="tools-api"><a name="tools-api" class="anchor-navigation-ex-anchor" href="#tools-api"><i class="fa fa-link" aria-hidden="true"></i></a>7.10. Tools API</h3>
<h4 id="console-api"><a name="console-api" class="anchor-navigation-ex-anchor" href="#console-api"><i class="fa fa-link" aria-hidden="true"></i></a><a name="console-api" class="plugin-anchor" href="#console-api"><i class="fa fa-link" aria-hidden="true"></i></a>console API</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">var</span> devtools <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
devtools<span class="token punctuation">.</span><span class="token function-variable function">toString</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>opened <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;%c&apos;</span><span class="token punctuation">,</span> devtools<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// devtools.opened will become true if/when the console is opened</span>
</code></pre>
<pre class="language-"><code class="lang-js">console<span class="token punctuation">.</span>log <span class="token operator">/</span> info <span class="token operator">/</span> warn <span class="token operator">/</span> error<span class="token punctuation">;</span>
console<span class="token punctuation">.</span>dir <span class="token operator">/</span> dirxml <span class="token operator">/</span> table<span class="token punctuation">;</span> <span class="token comment">// different output style</span>
console<span class="token punctuation">.</span>assert<span class="token punctuation">;</span>
console<span class="token punctuation">.</span>group <span class="token operator">/</span> groupEnd<span class="token punctuation">;</span>
console<span class="token punctuation">.</span>time <span class="token operator">/</span> timeEnd<span class="token punctuation">;</span>
console<span class="token punctuation">.</span>profile <span class="token operator">/</span> profileEnd<span class="token punctuation">;</span>
console<span class="token punctuation">.</span>count<span class="token punctuation">;</span>
console<span class="token punctuation">.</span>trace<span class="token punctuation">;</span>
</code></pre>
<p><code>console.log</code></p>
<pre class="language-"><code class="lang-js"><span class="token comment">// `sprinf` style log</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;%d %o %s&apos;</span><span class="token punctuation">,</span> integer<span class="token punctuation">,</span> object<span class="token punctuation">,</span> string<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;%c ...&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;css style&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p><code>console.table</code></p>
<pre class="language-"><code class="lang-js"><span class="token comment">// display array of object (tabular data)</span>
<span class="token keyword">const</span> transactions <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token string">&apos;7cb1-e041b126-f3b8&apos;</span><span class="token punctuation">,</span>
    seller<span class="token operator">:</span> <span class="token string">&apos;WAL0412&apos;</span><span class="token punctuation">,</span>
    buyer<span class="token operator">:</span> <span class="token string">&apos;WAL3023&apos;</span><span class="token punctuation">,</span>
    price<span class="token operator">:</span> <span class="token number">203450</span><span class="token punctuation">,</span>
    time<span class="token operator">:</span> <span class="token number">1539688433</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token string">&apos;1d4c-31f8f14b-1571&apos;</span><span class="token punctuation">,</span>
    seller<span class="token operator">:</span> <span class="token string">&apos;WAL0452&apos;</span><span class="token punctuation">,</span>
    buyer<span class="token operator">:</span> <span class="token string">&apos;WAL3023&apos;</span><span class="token punctuation">,</span>
    price<span class="token operator">:</span> <span class="token number">348299</span><span class="token punctuation">,</span>
    time<span class="token operator">:</span> <span class="token number">1539688433</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token string">&apos;b12c-b3adf58f-809f&apos;</span><span class="token punctuation">,</span>
    seller<span class="token operator">:</span> <span class="token string">&apos;WAL0012&apos;</span><span class="token punctuation">,</span>
    buyer<span class="token operator">:</span> <span class="token string">&apos;WAL2025&apos;</span><span class="token punctuation">,</span>
    price<span class="token operator">:</span> <span class="token number">59240</span><span class="token punctuation">,</span>
    time<span class="token operator">:</span> <span class="token number">1539688433</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">table</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&apos;id&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;price&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="js-api"><a name="js-api" class="anchor-navigation-ex-anchor" href="#js-api"><i class="fa fa-link" aria-hidden="true"></i></a><a name="js-api" class="plugin-anchor" href="#js-api"><i class="fa fa-link" aria-hidden="true"></i></a>JS API</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">debugger</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token function">copy</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// to clipborad</span>
</code></pre>
<pre class="language-"><code class="lang-js">window<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">errorMessage<span class="token punctuation">,</span> scriptURI<span class="token punctuation">,</span> lineNo<span class="token punctuation">,</span> columnNo<span class="token punctuation">,</span> error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;errorMessage: &apos;</span> <span class="token operator">+</span> errorMessage<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#x5F02;&#x5E38;&#x4FE1;&#x606F;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;scriptURI: &apos;</span> <span class="token operator">+</span> scriptURI<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#x5F02;&#x5E38;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;lineNo: &apos;</span> <span class="token operator">+</span> lineNo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#x5F02;&#x5E38;&#x884C;&#x53F7;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;columnNo: &apos;</span> <span class="token operator">+</span> columnNo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#x5F02;&#x5E38;&#x5217;&#x53F7;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;error: &apos;</span> <span class="token operator">+</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#x5F02;&#x5E38;&#x5806;&#x6808;&#x4FE1;&#x606F;</span>
  <span class="token comment">// ...</span>
  <span class="token comment">// &#x5F02;&#x5E38;&#x4E0A;&#x62A5;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;error&apos;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
  <span class="token comment">// &#x5F02;&#x5E38;&#x4E0A;&#x62A5;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h5 id="trace-property-vue-internal"><a name="trace-property-vue-internal" class="anchor-navigation-ex-anchor" href="#trace-property-vue-internal"><i class="fa fa-link" aria-hidden="true"></i></a><a name="trace-property-vue-internal" class="plugin-anchor" href="#trace-property-vue-internal"><i class="fa fa-link" aria-hidden="true"></i></a>Trace Property (Vue Internal)</h5>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> <span class="token function-variable function">traceProperty</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">object<span class="token punctuation">,</span> property</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> value <span class="token operator">=</span> object<span class="token punctuation">[</span>property<span class="token punctuation">]</span><span class="token punctuation">;</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> property<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">trace</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>property<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> requested</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">set</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">trace</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">setting </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>property<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> to </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> newValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
      value <span class="token operator">=</span> newValue<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="node-api"><a name="node-api" class="anchor-navigation-ex-anchor" href="#node-api"><i class="fa fa-link" aria-hidden="true"></i></a><a name="node-api" class="plugin-anchor" href="#node-api"><i class="fa fa-link" aria-hidden="true"></i></a>Node API</h4>
<ul>
<li>node --inspect</li>
<li><a href="https://github.com/GoogleChromeLabs/ndb" target="_blank">ndb</a></li>
</ul>
<pre class="language-"><code class="lang-bash">node --inspect
ndb index.js
</code></pre>
<h3 id="browser-compatibility"><a name="browser-compatibility" class="anchor-navigation-ex-anchor" href="#browser-compatibility"><i class="fa fa-link" aria-hidden="true"></i></a>7.11. Browser Compatibility</h3>
<h4 id="&#x7279;&#x6027;&#x68C0;&#x6D4B;"><a name="&#x7279;&#x6027;&#x68C0;&#x6D4B;" class="anchor-navigation-ex-anchor" href="#&#x7279;&#x6027;&#x68C0;&#x6D4B;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x7279;&#x6027;&#x68C0;&#x6D4B;" class="plugin-anchor" href="#&#x7279;&#x6027;&#x68C0;&#x6D4B;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x7279;&#x6027;&#x68C0;&#x6D4B;</h4>
<p><strong>&#x4E0D;&#x4F7F;&#x7528;&#x7279;&#x6027;/&#x6D4F;&#x89C8;&#x5668;&#x63A8;&#x65AD;</strong>&#xFF0C;&#x5F80;&#x5F80;&#x5BB9;&#x6613;&#x63A8;&#x65AD;&#x9519;&#x8BEF;(&#x4E14;&#x4F1A;&#x968F;&#x7740;&#x6D4F;&#x89C8;&#x5668;&#x66F4;&#x65B0;&#x4EA7;&#x751F;&#x65B0;&#x7684;&#x9519;&#x8BEF;)</p>
<pre class="language-"><code class="lang-js"><span class="token comment">// &#x7279;&#x6027;&#x68C0;&#x6D4B;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>getElementById<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="chrome-dev-tools"><a name="chrome-dev-tools" class="anchor-navigation-ex-anchor" href="#chrome-dev-tools"><i class="fa fa-link" aria-hidden="true"></i></a>8. Chrome Dev Tools</h2>
<h3 id="shortcuts"><a name="shortcuts" class="anchor-navigation-ex-anchor" href="#shortcuts"><i class="fa fa-link" aria-hidden="true"></i></a>8.1. Shortcuts</h3>
<ul>
<li>c-d: go to next word</li>
<li>c-f in <code>Elements</code> panel: search DOM node</li>
<li>c-m: go to next bracket</li>
<li>c-p: go to files</li>
<li>cs-p: go to anywhere</li>
<li>cs-o: go to functions</li>
</ul>
<p>long click reload: multiple reload options e.g clean cache</p>
<h3 id="elements-panel"><a name="elements-panel" class="anchor-navigation-ex-anchor" href="#elements-panel"><i class="fa fa-link" aria-hidden="true"></i></a>8.2. Elements Panel</h3>
<ul>
<li>break on elements</li>
</ul>
<h4 id="style-tab"><a name="style-tab" class="anchor-navigation-ex-anchor" href="#style-tab"><i class="fa fa-link" aria-hidden="true"></i></a><a name="style-tab" class="plugin-anchor" href="#style-tab"><i class="fa fa-link" aria-hidden="true"></i></a>Style Tab</h4>
<ul>
<li>color picker</li>
<li>filter: class filter, pseudo filter, css style filter</li>
</ul>
<h3 id="console-panel"><a name="console-panel" class="anchor-navigation-ex-anchor" href="#console-panel"><i class="fa fa-link" aria-hidden="true"></i></a>8.3. Console Panel</h3>
<ul>
<li>getEventListeners(dom)</li>
<li>monitorEvents(dom, events)</li>
<li>unmonitorEvents(dom)</li>
<li>debug(fn)</li>
<li>undebug(fn)</li>
<li>monitor(fn)</li>
<li>unmonitor(fn)</li>
</ul>
<h4 id="console-settings"><a name="console-settings" class="anchor-navigation-ex-anchor" href="#console-settings"><i class="fa fa-link" aria-hidden="true"></i></a><a name="console-settings" class="plugin-anchor" href="#console-settings"><i class="fa fa-link" aria-hidden="true"></i></a>Console Settings</h4>
<ul>
<li>preserve log</li>
<li>show timestamps</li>
<li>Verbose: additional performance log</li>
<li>click filename, filter error messages</li>
<li>add folder to workspace</li>
</ul>
<h4 id="capture-default-eventlistener"><a name="capture-default-eventlistener" class="anchor-navigation-ex-anchor" href="#capture-default-eventlistener"><i class="fa fa-link" aria-hidden="true"></i></a><a name="capture-default-eventlistener" class="plugin-anchor" href="#capture-default-eventlistener"><i class="fa fa-link" aria-hidden="true"></i></a>capture default eventListener</h4>
<blockquote>
<p>$0: the reference to the currently selected element in the Elements panel</p>
</blockquote>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> listener <span class="token operator">=</span> <span class="token function">getEventListeners</span><span class="token punctuation">(</span>$<span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>listener<span class="token punctuation">;</span>
$<span class="token number">0.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;click&apos;</span><span class="token punctuation">,</span> listener<span class="token punctuation">)</span><span class="token punctuation">;</span>
$<span class="token number">0.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;click&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// do something</span>
  <span class="token comment">// ...</span>

  <span class="token comment">// then</span>
  <span class="token function">listener</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="source-panel"><a name="source-panel" class="anchor-navigation-ex-anchor" href="#source-panel"><i class="fa fa-link" aria-hidden="true"></i></a>8.4. Source Panel</h3>
<ul>
<li>add log points</li>
<li>multiple breakpoints: source, XHR/fetch, DOM, global/event listeners</li>
<li>open a source file, right click code, <code>Blackbox script</code> item</li>
<li><a href="https://developers.google.com/web/updates/2018/01/devtools#overrides" target="_blank">Local Overrides</a>
for persistent changes to css styles</li>
</ul>
<h3 id="network-panel"><a name="network-panel" class="anchor-navigation-ex-anchor" href="#network-panel"><i class="fa fa-link" aria-hidden="true"></i></a>8.5. Network Panel</h3>
<ul>
<li>throtting: simulate different network environment</li>
<li>initiator&#xFF1A;go to files</li>
</ul>
<h3 id="performance-panel"><a name="performance-panel" class="anchor-navigation-ex-anchor" href="#performance-panel"><i class="fa fa-link" aria-hidden="true"></i></a>8.6. Performance Panel</h3>
<ul>
<li>C+S+P: performance monitor</li>
<li>C+S+P: FPS</li>
<li>script-&gt;style-&gt;layout-&gt;paint-&gt;composite timeline</li>
<li>performance tips</li>
<li><a href="https://developers.google.com/web/tools/chrome-devtools/evaluate-performance/performance-reference" target="_blank">Timeline Events</a></li>
<li><a href="https://developers.google.com/web/tools/chrome-devtools/evaluate-performance/reference" target="_blank">Performance Analysis Reference</a></li>
</ul>
<h3 id="simulation-devtools"><a name="simulation-devtools" class="anchor-navigation-ex-anchor" href="#simulation-devtools"><i class="fa fa-link" aria-hidden="true"></i></a>8.7. Simulation DevTools</h3>
<ul>
<li>cs-p: type <code>3G</code> (slow network)</li>
<li>cs-p: type <code>sensor</code> (geolocation)</li>
</ul>
<h3 id="testing-devtools"><a name="testing-devtools" class="anchor-navigation-ex-anchor" href="#testing-devtools"><i class="fa fa-link" aria-hidden="true"></i></a>8.8. Testing DevTools</h3>
<ul>
<li>cs-p: type <code>audit</code></li>
<li>cs-p: type <code>coverage</code></li>
</ul>
<h4 id="memory-panel"><a name="memory-panel" class="anchor-navigation-ex-anchor" href="#memory-panel"><i class="fa fa-link" aria-hidden="true"></i></a><a name="memory-panel" class="plugin-anchor" href="#memory-panel"><i class="fa fa-link" aria-hidden="true"></i></a>Memory Panel</h4>
<h4 id="js-profiler-panel"><a name="js-profiler-panel" class="anchor-navigation-ex-anchor" href="#js-profiler-panel"><i class="fa fa-link" aria-hidden="true"></i></a><a name="js-profiler-panel" class="plugin-anchor" href="#js-profiler-panel"><i class="fa fa-link" aria-hidden="true"></i></a>JS Profiler Panel</h4>
<h4 id="layer-panel"><a name="layer-panel" class="anchor-navigation-ex-anchor" href="#layer-panel"><i class="fa fa-link" aria-hidden="true"></i></a><a name="layer-panel" class="plugin-anchor" href="#layer-panel"><i class="fa fa-link" aria-hidden="true"></i></a>Layer Panel</h4>
<p>tool for composite stage analysis</p>
<h3 id="rendering-panel"><a name="rendering-panel" class="anchor-navigation-ex-anchor" href="#rendering-panel"><i class="fa fa-link" aria-hidden="true"></i></a>8.9. Rendering Panel</h3>
<ul>
<li>re-paint area</li>
<li>FPS monitor</li>
<li>scroll event</li>
<li>paint flashing</li>
<li>layout/layer border</li>
</ul>
<h3 id="more-tools"><a name="more-tools" class="anchor-navigation-ex-anchor" href="#more-tools"><i class="fa fa-link" aria-hidden="true"></i></a>8.10. More Tools</h3>
<ul>
<li>layers</li>
<li>animations</li>
<li>coverage</li>
</ul>
<h2 id="javascript-style-guide"><a name="javascript-style-guide" class="anchor-navigation-ex-anchor" href="#javascript-style-guide"><i class="fa fa-link" aria-hidden="true"></i></a>9. JavaScript Style Guide</h2>
<ul>
<li><a href="https://github.com/airbnb/javascript" target="_blank">Airbnb Guide</a></li>
</ul>
<h3 id="naming-style"><a name="naming-style" class="anchor-navigation-ex-anchor" href="#naming-style"><i class="fa fa-link" aria-hidden="true"></i></a>9.1. Naming Style</h3>
<ul>
<li>&#x53D8;&#x91CF;: &#x540D;&#x8BCD;&#x524D;&#x7F00;</li>
<li>&#x65B9;&#x6CD5;/&#x51FD;&#x6570;: &#x52A8;&#x8BCD;&#x524D;&#x7F00;</li>
<li>_method: &#x8868;&#x793A;&#x79C1;&#x6709;&#x5316;&#x65B9;&#x6CD5;</li>
<li>&#x666E;&#x901A;&#x51FD;&#x6570;: &#x9A7C;&#x5CF0;&#x547D;&#x540D;&#x6CD5;(camelCase)</li>
<li>&#x6784;&#x9020;&#x51FD;&#x6570;: &#x5E15;&#x65AF;&#x5361;&#x547D;&#x540D;&#x6CD5;(PascalCase)</li>
<li>&#x7F29;&#x7565;&#x8BCD;&#x548C;&#x7F29;&#x5199;&#x90FD;&#x5FC5;&#x987B;&#x662F;&#x5168;&#x90E8;&#x5927;&#x5199;/&#x5C0F;&#x5199;</li>
<li>&#x5BF9;&#x4E8E; jQuery &#x5BF9;&#x8C61;&#x7684;&#x53D8;&#x91CF;&#x4F7F;&#x7528; $ &#x4F5C;&#x4E3A;&#x524D;&#x7F00;</li>
</ul>
<h3 id="variable-style"><a name="variable-style" class="anchor-navigation-ex-anchor" href="#variable-style"><i class="fa fa-link" aria-hidden="true"></i></a>9.2. Variable Style</h3>
<ul>
<li>no single <code>let/const</code></li>
<li>sort <code>let/const</code></li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// bad</span>
<span class="token keyword">let</span> i<span class="token punctuation">,</span>
  len<span class="token punctuation">,</span>
  dragonball<span class="token punctuation">,</span>
  items <span class="token operator">=</span> <span class="token function">getItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  goSportsTeam <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

<span class="token comment">// bad</span>
<span class="token keyword">let</span> i<span class="token punctuation">;</span>
<span class="token keyword">const</span> items <span class="token operator">=</span> <span class="token function">getItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> dragonball<span class="token punctuation">;</span>
<span class="token keyword">const</span> goSportsTeam <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> len<span class="token punctuation">;</span>

<span class="token comment">// good</span>
<span class="token keyword">const</span> goSportsTeam <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> items <span class="token operator">=</span> <span class="token function">getItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> dragonball<span class="token punctuation">;</span>
<span class="token keyword">let</span> i<span class="token punctuation">;</span>
<span class="token keyword">let</span> length<span class="token punctuation">;</span>
</code></pre>
<ul>
<li>no chains assignment (create implict global variable)</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// bad</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">example</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// JavaScript &#x628A;&#x5B83;&#x89E3;&#x91CA;&#x4E3A;</span>
  <span class="token comment">// let a = ( b = ( c = 1 ) );</span>
  <span class="token comment">// let &#x5173;&#x952E;&#x8BCD;&#x53EA;&#x9002;&#x7528;&#x4E8E;&#x53D8;&#x91CF; a &#xFF1B;&#x53D8;&#x91CF; b &#x548C;&#x53D8;&#x91CF; c &#x5219;&#x53D8;&#x6210;&#x4E86;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x3002;</span>
  <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">(</span>b <span class="token operator">=</span> c <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// throws ReferenceError</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>

<span class="token comment">// good</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">example</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> b <span class="token operator">=</span> a<span class="token punctuation">;</span>
  <span class="token keyword">let</span> c <span class="token operator">=</span> a<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// throws ReferenceError</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// throws ReferenceError</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// throws ReferenceError</span>
</code></pre>
<ul>
<li>use <code>()</code> wrap multiple line</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// bad</span>
<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token function">superLongLongLongLongLongLongLongLongFunctionName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// bad</span>
<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token string">&apos;superLongLongLongLongLongLongLongLongString&apos;</span><span class="token punctuation">;</span>

<span class="token comment">// good</span>
<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token function">superLongLongLongLongLongLongLongLongFunctionName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// good</span>
<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token string">&apos;superLongLongLongLongLongLongLongLongString&apos;</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="object-style"><a name="object-style" class="anchor-navigation-ex-anchor" href="#object-style"><i class="fa fa-link" aria-hidden="true"></i></a>9.3. Object Style</h3>
<ul>
<li>use literal</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// bad</span>
<span class="token keyword">const</span> item <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// good</span>
<span class="token keyword">const</span> item <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<ul>
<li>use object-shorthand</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// bad</span>
<span class="token keyword">const</span> atom <span class="token operator">=</span> <span class="token punctuation">{</span>
  lukeSkywalker<span class="token operator">:</span> lukeSkywalker<span class="token punctuation">,</span>
  <span class="token function-variable function">addValue</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> atom<span class="token punctuation">.</span>value <span class="token operator">+</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// good</span>
<span class="token keyword">const</span> atom <span class="token operator">=</span> <span class="token punctuation">{</span>
  lukeSkywalker<span class="token punctuation">,</span>
  <span class="token function">addValue</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> atom<span class="token punctuation">.</span>value <span class="token operator">+</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<ul>
<li>use Object.prototype.XX not object.xx</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// bad</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>object<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// good</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// best</span>
<span class="token keyword">const</span> has <span class="token operator">=</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>hasOwnProperty<span class="token punctuation">;</span> <span class="token comment">// &#x5728;&#x6A21;&#x5757;&#x8303;&#x56F4;&#x5185;&#x7684;&#x7F13;&#x5B58;&#x4E2D;&#x67E5;&#x627E;&#x4E00;&#x6B21;</span>
<span class="token comment">/* or */</span>
<span class="token keyword">import</span> has <span class="token keyword">from</span> <span class="token string">&apos;has&apos;</span><span class="token punctuation">;</span> <span class="token comment">// https://www.npmjs.com/package/has</span>
<span class="token comment">// ...</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">has</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<ul>
<li>use object spread not object.assign</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// very bad</span>
<span class="token keyword">const</span> original <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> copy <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>original<span class="token punctuation">,</span> <span class="token punctuation">{</span> c<span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#x53D8;&#x5F02;&#x7684; `original` &#xCA0;_&#xCA0;</span>
<span class="token keyword">delete</span> copy<span class="token punctuation">.</span>a<span class="token punctuation">;</span> <span class="token comment">// &#x8FD9;....</span>

<span class="token comment">// bad</span>
<span class="token keyword">const</span> original <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> copy <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> original<span class="token punctuation">,</span> <span class="token punctuation">{</span> c<span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// good</span>
<span class="token keyword">const</span> original <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> copy <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>original<span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// copy =&gt; { a: 1, b: 2, c: 3 }</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> a<span class="token punctuation">,</span> <span class="token operator">...</span>noA <span class="token punctuation">}</span> <span class="token operator">=</span> copy<span class="token punctuation">;</span> <span class="token comment">// noA =&gt; { b: 2, c: 3 }</span>
</code></pre>
<ul>
<li>use <code>.</code> for static name, use <code>[]</code> for variable name</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// good</span>
<span class="token keyword">const</span> isJedi <span class="token operator">=</span> luke<span class="token punctuation">.</span>jedi<span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">getProp</span><span class="token punctuation">(</span><span class="token parameter">prop</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> luke<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="array-style"><a name="array-style" class="anchor-navigation-ex-anchor" href="#array-style"><i class="fa fa-link" aria-hidden="true"></i></a>9.4. Array Style</h3>
<ul>
<li>use literal</li>
<li>use <code>push</code> not <code>[]</code></li>
<li>use array spread (best) or <code>Array.from</code> (good)</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> foo <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">&apos;.foo&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// good</span>
<span class="token keyword">const</span> nodes <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// best</span>
<span class="token keyword">const</span> nodes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>foo<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="destruct-style"><a name="destruct-style" class="anchor-navigation-ex-anchor" href="#destruct-style"><i class="fa fa-link" aria-hidden="true"></i></a>9.5. Destruct Style</h3>
<p>&#x5BF9;&#x4E8E;&#x591A;&#x4E2A;&#x8FD4;&#x56DE;&#x503C;&#x4F7F;&#x7528;&#x5BF9;&#x8C61;&#x89E3;&#x6784;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x6570;&#x7EC4;&#x89E3;&#x6784;</p>
<pre class="language-"><code class="lang-js"><span class="token comment">// bad</span>
<span class="token keyword">function</span> <span class="token function">processInput</span><span class="token punctuation">(</span><span class="token parameter">input</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// &#x5904;&#x7406;&#x4EE3;&#x7801;...</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span>left<span class="token punctuation">,</span> right<span class="token punctuation">,</span> top<span class="token punctuation">,</span> bottom<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// &#x8C03;&#x7528;&#x8005;&#x9700;&#x8981;&#x8003;&#x8651;&#x8FD4;&#x56DE;&#x6570;&#x636E;&#x7684;&#x987A;&#x5E8F;&#x3002;</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>left<span class="token punctuation">,</span> __<span class="token punctuation">,</span> top<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">processInput</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// good</span>
<span class="token keyword">function</span> <span class="token function">processInput</span><span class="token punctuation">(</span><span class="token parameter">input</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// &#x5904;&#x7406;&#x4EE3;&#x7801;...</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> left<span class="token punctuation">,</span> right<span class="token punctuation">,</span> top<span class="token punctuation">,</span> bottom <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// &#x8C03;&#x7528;&#x8005;&#x53EA;&#x9009;&#x62E9;&#x4ED6;&#x4EEC;&#x9700;&#x8981;&#x7684;&#x6570;&#x636E;&#x3002;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> left<span class="token punctuation">,</span> top <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">processInput</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="string-style"><a name="string-style" class="anchor-navigation-ex-anchor" href="#string-style"><i class="fa fa-link" aria-hidden="true"></i></a>9.6. String Style</h3>
<ul>
<li>use <code>&apos;</code> not <code>&quot;</code></li>
<li>use `${}` not <code>&apos;str1&apos; + &apos;str2&apos;</code></li>
</ul>
<h3 id="function-style"><a name="function-style" class="anchor-navigation-ex-anchor" href="#function-style"><i class="fa fa-link" aria-hidden="true"></i></a>9.7. Function Style</h3>
<ul>
<li>use naming function expression not function declaration</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// bad</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token comment">// bad</span>
<span class="token keyword">const</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// good</span>
<span class="token comment">// &#x4ECE;&#x53D8;&#x91CF;&#x5F15;&#x7528;&#x8C03;&#x7528;&#x4E2D;&#x533A;&#x5206;&#x7684;&#x8BCD;&#x6C47;&#x540D;&#x79F0;</span>
<span class="token keyword">const</span> <span class="token function-variable function">short</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">longUniqueMoreDescriptiveLexicalFoo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<ul>
<li>use <code>...args</code> not <code>arguments</code></li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// bad</span>
<span class="token keyword">function</span> <span class="token function">concatenateAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> args<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&apos;&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// good</span>
<span class="token keyword">function</span> <span class="token function">concatenateAll</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> args<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&apos;&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<ul>
<li>use default parameters not default expression pattern</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// bad</span>
<span class="token keyword">function</span> <span class="token function">handleThings</span><span class="token punctuation">(</span><span class="token parameter">opts</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>opts <span class="token operator">=</span> opts <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// good</span>
<span class="token keyword">function</span> <span class="token function">handleThings</span><span class="token punctuation">(</span><span class="token parameter">opts <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>opts <span class="token operator">=</span> opts<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<ul>
<li>no reassign parameters: side effect and bad performance</li>
</ul>
<h3 id="arrow-function-style"><a name="arrow-function-style" class="anchor-navigation-ex-anchor" href="#arrow-function-style"><i class="fa fa-link" aria-hidden="true"></i></a>9.8. Arrow Function Style</h3>
<ul>
<li><code>()</code> and <code>{}</code> should pair</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// bad</span>
arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x <span class="token operator">+</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> y <span class="token operator">=</span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> x <span class="token operator">*</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// good</span>
arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> x <span class="token operator">+</span> index<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> y <span class="token operator">=</span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> x <span class="token operator">*</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<ul>
<li>use <code>()</code> wrap multiple line return value</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// bad</span>
<span class="token punctuation">[</span><span class="token string">&apos;get&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;post&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;put&apos;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">httpMethod</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>
    httpMagicObjectWithAVeryLongName<span class="token punctuation">,</span>
    httpMethod
  <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// good</span>
<span class="token punctuation">[</span><span class="token string">&apos;get&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;post&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;put&apos;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">httpMethod</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>
    httpMagicObjectWithAVeryLongName<span class="token punctuation">,</span>
    httpMethod
  <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="module-style"><a name="module-style" class="anchor-navigation-ex-anchor" href="#module-style"><i class="fa fa-link" aria-hidden="true"></i></a>9.9. Module Style</h3>
<ul>
<li>import first</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// bad</span>
<span class="token keyword">import</span> foo <span class="token keyword">from</span> <span class="token string">&apos;foo&apos;</span><span class="token punctuation">;</span>
foo<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> bar <span class="token keyword">from</span> <span class="token string">&apos;bar&apos;</span><span class="token punctuation">;</span>

<span class="token comment">// good</span>
<span class="token keyword">import</span> foo <span class="token keyword">from</span> <span class="token string">&apos;foo&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> bar <span class="token keyword">from</span> <span class="token string">&apos;bar&apos;</span><span class="token punctuation">;</span>

foo<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<ul>
<li>no shorthand <code>export from</code></li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// bad</span>
<span class="token comment">// filename es6.js</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> es6 <span class="token keyword">as</span> <span class="token keyword">default</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;./AirbnbStyleGuide&apos;</span><span class="token punctuation">;</span>

<span class="token comment">// good</span>
<span class="token comment">// filename es6.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> es6 <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;./AirbnbStyleGuide&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> es6<span class="token punctuation">;</span>
</code></pre>
<ul>
<li>path occurs once</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// bad</span>
<span class="token keyword">import</span> foo <span class="token keyword">from</span> <span class="token string">&apos;foo&apos;</span><span class="token punctuation">;</span>
<span class="token comment">// &#x2026; &#x5176;&#x4ED6;&#x5BFC;&#x5165; &#x2026; //</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> named1<span class="token punctuation">,</span> named2 <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;foo&apos;</span><span class="token punctuation">;</span>

<span class="token comment">// good</span>
<span class="token keyword">import</span> foo<span class="token punctuation">,</span> <span class="token punctuation">{</span> named1<span class="token punctuation">,</span> named2 <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;foo&apos;</span><span class="token punctuation">;</span>

<span class="token comment">// best</span>
<span class="token keyword">import</span> foo<span class="token punctuation">,</span> <span class="token punctuation">{</span> named1<span class="token punctuation">,</span> named2 <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&apos;foo&apos;</span><span class="token punctuation">;</span>
</code></pre>
<ul>
<li>not export <code>let</code></li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// bad</span>
<span class="token keyword">let</span> foo <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> foo <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// good</span>
<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> foo <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="iterator-and-generator-style"><a name="iterator-and-generator-style" class="anchor-navigation-ex-anchor" href="#iterator-and-generator-style"><i class="fa fa-link" aria-hidden="true"></i></a>9.10. Iterator and Generator Style</h3>
<ul>
<li>no iterator, &#x5E94;&#x8BE5;&#x4F7F;&#x7528; JavaScript &#x7684;&#x9AD8;&#x9636;&#x51FD;&#x6570;&#x4EE3;&#x66FF; for-in &#x6216;&#x8005; for-of:<ul>
<li>&#x4F7F;&#x7528; <code>map/reduce/filter/any/every/some/find/findIndex/ ...</code> &#x904D;&#x5386;&#x6570;&#x7EC4;</li>
<li>&#x4F7F;&#x7528; <code>Object.keys() / Object.values() / Object.entries()</code> &#x8FED;&#x4EE3;&#x5BF9;&#x8C61;&#x751F;&#x6210;&#x6570;&#x7EC4;</li>
</ul>
</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> numbers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// bad</span>
<span class="token keyword">let</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> num <span class="token keyword">of</span> numbers<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  sum <span class="token operator">+=</span> num<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
sum <span class="token operator">===</span> <span class="token number">15</span><span class="token punctuation">;</span>

<span class="token comment">// good</span>
<span class="token keyword">let</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
numbers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  sum <span class="token operator">+=</span> num<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
sum <span class="token operator">===</span> <span class="token number">15</span><span class="token punctuation">;</span>

<span class="token comment">// best (use the functional force)</span>
<span class="token keyword">const</span> sum <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">total<span class="token punctuation">,</span> num</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> total <span class="token operator">+</span> num<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
sum <span class="token operator">===</span> <span class="token number">15</span><span class="token punctuation">;</span>

<span class="token comment">// bad</span>
<span class="token keyword">const</span> increasedByOne <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> numbers<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  increasedByOne<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>numbers<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// good</span>
<span class="token keyword">const</span> increasedByOne <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
numbers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  increasedByOne<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>num <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// best (keeping it functional)</span>
<span class="token keyword">const</span> increasedByOne <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> num <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<ul>
<li>use <code>function*</code> for generator</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// bad</span>
<span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token comment">// bad</span>
<span class="token keyword">const</span> <span class="token function-variable function">bar</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// good</span>
<span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token comment">// good</span>
<span class="token keyword">const</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="expression-style"><a name="expression-style" class="anchor-navigation-ex-anchor" href="#expression-style"><i class="fa fa-link" aria-hidden="true"></i></a>9.11. Expression Style</h3>
<p>if &#x8BED;&#x53E5;&#x4F7F;&#x7528; ToBoolean &#x7684;&#x62BD;&#x8C61;&#x65B9;&#x6CD5;&#x6765;&#x8BA1;&#x7B97;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x7ED3;&#x679C;:</p>
<ul>
<li>Objects &#x7684;&#x53D6;&#x503C;&#x4E3A;&#xFF1A; true</li>
<li>Undefined &#x7684;&#x53D6;&#x503C;&#x4E3A;&#xFF1A; false</li>
<li>Null &#x7684;&#x53D6;&#x503C;&#x4E3A;&#xFF1A; false</li>
<li>Booleans &#x7684;&#x53D6;&#x503C;&#x4E3A;&#xFF1A; &#x5E03;&#x5C14;&#x503C;&#x7684;&#x53D6;&#x503C;</li>
<li>Numbers &#x7684;&#x53D6;&#x503C;&#x4E3A;&#xFF1A;&#x5982;&#x679C;&#x4E3A; +0, -0, or NaN &#x503C;&#x4E3A; false &#x5426;&#x5219;&#x4E3A; true</li>
<li>Strings &#x7684;&#x53D6;&#x503C;&#x4E3A;: &#x5982;&#x679C;&#x662F;&#x4E00;&#x4E2A;&#x7A7A;&#x5B57;&#x7B26;&#x4E32; &apos;&apos; &#x503C;&#x4E3A; false &#x5426;&#x5219;&#x4E3A; true</li>
</ul>
<p>&#x5BF9;&#x4E8E;&#x5E03;&#x5C14;&#x503C;&#x4F7F;&#x7528;&#x7B80;&#x5199;&#xFF0C;&#x4F46;&#x662F;&#x5BF9;&#x4E8E;&#x5B57;&#x7B26;&#x4E32;&#x548C;&#x6570;&#x5B57;&#x8FDB;&#x884C;&#x663E;&#x5F0F;&#x6BD4;&#x8F83;</p>
<pre class="language-"><code class="lang-js"><span class="token comment">// bad</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>isValid <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token comment">// good</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>isValid<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token comment">// bad</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token comment">// good</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token operator">!==</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token comment">// bad</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>collection<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token comment">// good</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>collection<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre>
<p>use <code>{}</code> warp <code>case</code> when exists <code>const</code>/<code>let</code>/<code>function</code>/<code>class</code> declaration</p>
<pre class="language-"><code class="lang-js"><span class="token comment">// bad</span>
<span class="token keyword">switch</span> <span class="token punctuation">(</span>foo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
    <span class="token keyword">const</span> y <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>
    <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token keyword">default</span><span class="token operator">:</span>
    <span class="token keyword">class</span> <span class="token class-name">C</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// good</span>
<span class="token keyword">switch</span> <span class="token punctuation">(</span>foo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> y <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span>
    <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token keyword">default</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token keyword">class</span> <span class="token class-name">C</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x6362;&#x884C;-style"><a name="&#x6362;&#x884C;-style" class="anchor-navigation-ex-anchor" href="#&#x6362;&#x884C;-style"><i class="fa fa-link" aria-hidden="true"></i></a>9.12. &#x6362;&#x884C; Style</h3>
<ul>
<li>&#x952E;&#x5165;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x8FD0;&#x7B97;&#x7B26;&#x540E;&#x518D;&#x6362;&#x884C;, &#x8FD0;&#x7B97;&#x7B26;&#x7F6E;&#x4E8E;&#x884C;&#x5C3E;&#x53EF;&#x4F7F; automatic semicolon insertion &#x673A;&#x5236;&#x5931;&#x6548;</li>
<li>&#x6362;&#x884C;&#x540E;&#x4FDD;&#x6301; 2 &#x4E2A;&#x7F29;&#x8FDB;&#x5C42;&#x6B21;</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// bad</span>
<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> objectInArray <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> numberInArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// good</span>
<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> objectInArray <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> numberInArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
<ul>
<li>use <code>()</code> wrap multiple line assignment or arguments</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// good</span>
<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token function">superLongLongLongLongLongLongLongLongFunctionName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">[</span><span class="token string">&apos;get&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;post&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;put&apos;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">httpMethod</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>
    httpMagicObjectWithAVeryLongName<span class="token punctuation">,</span>
    httpMethod
  <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="&#x7A7A;&#x683C;-style"><a name="&#x7A7A;&#x683C;-style" class="anchor-navigation-ex-anchor" href="#&#x7A7A;&#x683C;-style"><i class="fa fa-link" aria-hidden="true"></i></a>9.13. &#x7A7A;&#x683C; Style</h3>
<p>Good places to use a white space include:</p>
<ul>
<li>,/; &#x540E;</li>
<li>+,-,*,/,&lt;,&gt;,= &#x524D;&#x540E;</li>
<li>function () {}</li>
<li>function foo() {}</li>
<li>} if/for/while () {}</li>
<li>} else {}</li>
<li>no space inner <code>()</code> <code>[]</code></li>
<li>use space inner <code>{}</code></li>
</ul>
<pre class="language-"><code class="lang-javascript"><span class="token keyword">let</span> d <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
  a <span class="token operator">=</span> b <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">&amp;&amp;</span> b <span class="token operator">&amp;&amp;</span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  d <span class="token operator">=</span> a <span class="token operator">%</span> c<span class="token punctuation">;</span>
  a <span class="token operator">+=</span> d<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// antipattern</span>
<span class="token comment">// missing or inconsistent spaces</span>
<span class="token comment">// make the code confusing</span>
<span class="token keyword">let</span> d <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
  a <span class="token operator">=</span> b <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">&amp;&amp;</span> b <span class="token operator">&amp;&amp;</span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  d <span class="token operator">=</span> a <span class="token operator">%</span> c<span class="token punctuation">;</span>
  a <span class="token operator">+=</span> d<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x6CE8;&#x91CA;-style"><a name="&#x6CE8;&#x91CA;-style" class="anchor-navigation-ex-anchor" href="#&#x6CE8;&#x91CA;-style"><i class="fa fa-link" aria-hidden="true"></i></a>9.14. &#x6CE8;&#x91CA; Style</h3>
<ul>
<li>&#x4E0A;&#x65B9;&#x63D2;&#x5165;&#x7A7A;&#x884C;</li>
<li>&#x4E0E;&#x4E0B;&#x65B9;&#x8BED;&#x53E5;&#x7EDF;&#x4E00;&#x7F29;&#x8FDB;</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">/*
 * comments
 * comments
 */</span>
</code></pre>
<h4 id="&#x6A21;&#x5757;"><a name="&#x6A21;&#x5757;" class="anchor-navigation-ex-anchor" href="#&#x6A21;&#x5757;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x6A21;&#x5757;" class="plugin-anchor" href="#&#x6A21;&#x5757;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6A21;&#x5757;</h4>
<pre class="language-"><code class="lang-js"><span class="token comment">/*
 * @module myapp
 * @namespace MYAPP
 */</span>
</code></pre>
<h4 id="&#x5BF9;&#x8C61;"><a name="&#x5BF9;&#x8C61;" class="anchor-navigation-ex-anchor" href="#&#x5BF9;&#x8C61;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x5BF9;&#x8C61;" class="plugin-anchor" href="#&#x5BF9;&#x8C61;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5BF9;&#x8C61;</h4>
<pre class="language-"><code class="lang-js"><span class="token comment">/*
 * @class mathStuff
 */</span>
</code></pre>
<h4 id="&#x5C5E;&#x6027;"><a name="&#x5C5E;&#x6027;" class="anchor-navigation-ex-anchor" href="#&#x5C5E;&#x6027;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x5C5E;&#x6027;" class="plugin-anchor" href="#&#x5C5E;&#x6027;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5C5E;&#x6027;</h4>
<pre class="language-"><code class="lang-js"><span class="token comment">/*
 * @property propertyName
 * @type Number/String
 */</span>
</code></pre>
<h4 id="&#x65B9;&#x6CD5;&#x51FD;&#x6570;"><a name="&#x65B9;&#x6CD5;&#x51FD;&#x6570;" class="anchor-navigation-ex-anchor" href="#&#x65B9;&#x6CD5;&#x51FD;&#x6570;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x65B9;&#x6CD5;&#x51FD;&#x6570;" class="plugin-anchor" href="#&#x65B9;&#x6CD5;&#x51FD;&#x6570;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x65B9;&#x6CD5;/&#x51FD;&#x6570;</h4>
<pre class="language-"><code class="lang-js"><span class="token comment">/*
 * @constructor
 * @method sum
 * @param {Number}/{String} instructions
 * @return {Number}/{String} instructions
 */</span>
</code></pre>
<h2 id="ssr"><a name="ssr" class="anchor-navigation-ex-anchor" href="#ssr"><i class="fa fa-link" aria-hidden="true"></i></a>10. SSR</h2>
<ul>
<li><a href="https://developers.google.com/web/tools/puppeteer/articles/ssr" target="_blank">Server Side Rendering with Puppeteer</a></li>
<li><a href="https://developers.google.com/web/updates/2019/02/rendering-on-the-web" target="_blank">Rendering on the Web</a></li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">if</span> <span class="token punctuation">(</span>isBotAgent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// return pre-rendering static html to search engine crawler</span>
  <span class="token comment">// like Gatsby</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token comment">// server side rendering at runtime for real interactive users</span>
  <span class="token comment">// ReactDOMServer.renderToString()</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="seo"><a name="seo" class="anchor-navigation-ex-anchor" href="#seo"><i class="fa fa-link" aria-hidden="true"></i></a>11. SEO</h2>
<h3 id="seo-tutorials"><a name="seo-tutorials" class="anchor-navigation-ex-anchor" href="#seo-tutorials"><i class="fa fa-link" aria-hidden="true"></i></a>11.1. SEO Tutorials</h3>
<ul>
<li><a href="https://developers.google.com/search/docs/guides/javascript-seo-basics" target="_blank">SEO Basics</a></li>
<li><a href="https://snipcart.com/spa-seo" target="_blank">SPA SEO Basics</a></li>
</ul>
<h3 id="seo-tips"><a name="seo-tips" class="anchor-navigation-ex-anchor" href="#seo-tips"><i class="fa fa-link" aria-hidden="true"></i></a>11.2. SEO Tips</h3>
<ul>
<li><a href="https://css-tricks.com/server-side-react-rendering" target="_blank">server-side rendering</a>
(e.g next.js)</li>
<li><a href="https://github.com/chrisvfritz/prerender-spa-plugin" target="_blank">prerendering</a></li>
<li>mobile performance optimization
(e.g minify resources, code splitting, CDN, lazy loading, minimize reflows)</li>
<li><a href="https://reacttraining.com/react-router" target="_blank">SEO-friendly routing and URL management</a></li>
<li><a href="https://www.google.com/webmasters" target="_blank">Google webmaster tools</a></li>
</ul>
<h4 id="seo-metadata"><a name="seo-metadata" class="anchor-navigation-ex-anchor" href="#seo-metadata"><i class="fa fa-link" aria-hidden="true"></i></a><a name="seo-metadata" class="plugin-anchor" href="#seo-metadata"><i class="fa fa-link" aria-hidden="true"></i></a>SEO Metadata</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> seo <span class="token operator">=</span> <span class="token punctuation">{</span>
  title<span class="token operator">:</span> <span class="token string">&apos;About&apos;</span><span class="token punctuation">,</span>
  description<span class="token operator">:</span> <span class="token string">&apos;This is an awesome site that you definitely should check out.&apos;</span><span class="token punctuation">,</span>
  url<span class="token operator">:</span> <span class="token string">&apos;https://www.mydomain.com/about&apos;</span><span class="token punctuation">,</span>
  image<span class="token operator">:</span> <span class="token string">&apos;https://mydomain.com/images/home/logo.png&apos;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token operator">&lt;</span>Helmet
  title<span class="token operator">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>seo<span class="token punctuation">.</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> | Code Mochi</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span>
  meta<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">&apos;description&apos;</span><span class="token punctuation">,</span>
      property<span class="token operator">:</span> <span class="token string">&apos;og:description&apos;</span><span class="token punctuation">,</span>
      content<span class="token operator">:</span> seo<span class="token punctuation">.</span>description<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> property<span class="token operator">:</span> <span class="token string">&apos;og:title&apos;</span><span class="token punctuation">,</span> content<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>seo<span class="token punctuation">.</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> | Code Mochi</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> property<span class="token operator">:</span> <span class="token string">&apos;og:url&apos;</span><span class="token punctuation">,</span> content<span class="token operator">:</span> seo<span class="token punctuation">.</span>url <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> property<span class="token operator">:</span> <span class="token string">&apos;og:image&apos;</span><span class="token punctuation">,</span> content<span class="token operator">:</span> seo<span class="token punctuation">.</span>image <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> property<span class="token operator">:</span> <span class="token string">&apos;og:image:type&apos;</span><span class="token punctuation">,</span> content<span class="token operator">:</span> <span class="token string">&apos;image/jpeg&apos;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> property<span class="token operator">:</span> <span class="token string">&apos;twitter:image:src&apos;</span><span class="token punctuation">,</span> content<span class="token operator">:</span> seo<span class="token punctuation">.</span>image <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> property<span class="token operator">:</span> <span class="token string">&apos;twitter:title&apos;</span><span class="token punctuation">,</span> content<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>seo<span class="token punctuation">.</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> | Code Mochi</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> property<span class="token operator">:</span> <span class="token string">&apos;twitter:description&apos;</span><span class="token punctuation">,</span> content<span class="token operator">:</span> seo<span class="token punctuation">.</span>description <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">}</span>
<span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre>
<h2 id="pwa"><a name="pwa" class="anchor-navigation-ex-anchor" href="#pwa"><i class="fa fa-link" aria-hidden="true"></i></a>12. PWA</h2>
<p>Progressive Web Apps:</p>
<ul>
<li>served over <code>HTTPS</code></li>
<li>provide a manifest</li>
<li>register a <code>ServiceWorker</code>
(web cache for offline and performance)</li>
<li>consists of website, web app manifest,
service worker, expanded capabilities
and OS integration</li>
</ul>
<h3 id="service-worker"><a name="service-worker" class="anchor-navigation-ex-anchor" href="#service-worker"><i class="fa fa-link" aria-hidden="true"></i></a>12.1. Service Worker</h3>
<h4 id="sw-pros"><a name="sw-pros" class="anchor-navigation-ex-anchor" href="#sw-pros"><i class="fa fa-link" aria-hidden="true"></i></a><a name="sw-pros" class="plugin-anchor" href="#sw-pros"><i class="fa fa-link" aria-hidden="true"></i></a>SW Pros</h4>
<ul>
<li>cache</li>
<li>offline</li>
<li>background</li>
<li>custom request to minimize network</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerRegistration/showNotification" target="_blank">Notification API</a></li>
</ul>
<h4 id="sw-costs"><a name="sw-costs" class="anchor-navigation-ex-anchor" href="#sw-costs"><i class="fa fa-link" aria-hidden="true"></i></a><a name="sw-costs" class="plugin-anchor" href="#sw-costs"><i class="fa fa-link" aria-hidden="true"></i></a>SW Costs</h4>
<ul>
<li>need startup time</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// 20~100 ms for desktop</span>
<span class="token comment">// 100 ms for mobile</span>
<span class="token keyword">const</span> entry <span class="token operator">=</span> performance<span class="token punctuation">.</span><span class="token function">getEntriesByName</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> swStartupTime <span class="token operator">=</span> entry<span class="token punctuation">.</span>requestStart <span class="token operator">-</span> entry<span class="token punctuation">.</span>workerStart<span class="token punctuation">;</span>
</code></pre>
<ul>
<li>cache reads aren&apos;t always instant:<ul>
<li>cache hit time = read time (only this case better than <code>NO SW</code>),</li>
<li>cache miss time = read time + network latency,</li>
<li>cache slow time = slow read time + network latency,</li>
<li>SW asleep = SW boot latency + read time ( + network latency),</li>
<li>NO SW = network latency.</li>
</ul>
</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> entry <span class="token operator">=</span> performance<span class="token punctuation">.</span><span class="token function">getEntriesByName</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// no remote request means this was handled by the cache</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>entry<span class="token punctuation">.</span>transferSize <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> cacheTime <span class="token operator">=</span> entry<span class="token punctuation">.</span>responseStart <span class="token operator">-</span> entry<span class="token punctuation">.</span>requestStart<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token keyword">const</span> cacheStart <span class="token operator">=</span> performance<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> caches<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cacheEnd <span class="token operator">=</span> performance<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="sw-demo"><a name="sw-demo" class="anchor-navigation-ex-anchor" href="#sw-demo"><i class="fa fa-link" aria-hidden="true"></i></a><a name="sw-demo" class="plugin-anchor" href="#sw-demo"><i class="fa fa-link" aria-hidden="true"></i></a>SW Demo</h4>
<ul>
<li>SW Serving Strategy</li>
<li>SW Caching Strategy</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// Check that service workers are registered</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&apos;serviceWorker&apos;</span> <span class="token keyword">in</span> navigator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Use the window load event to keep the page load performant</span>
  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;load&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    navigator<span class="token punctuation">.</span>serviceWorker<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">&apos;/sw.js&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h4 id="sw-for-broken-images"><a name="sw-for-broken-images" class="anchor-navigation-ex-anchor" href="#sw-for-broken-images"><i class="fa fa-link" aria-hidden="true"></i></a><a name="sw-for-broken-images" class="plugin-anchor" href="#sw-for-broken-images"><i class="fa fa-link" aria-hidden="true"></i></a>SW for Broken Images</h4>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span> <span class="token function">isImage</span><span class="token punctuation">(</span><span class="token parameter">fetchRequest</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> fetchRequest<span class="token punctuation">.</span>method <span class="token operator">===</span> <span class="token string">&apos;GET&apos;</span> <span class="token operator">&amp;&amp;</span> fetchRequest<span class="token punctuation">.</span>destination <span class="token operator">===</span> <span class="token string">&apos;image&apos;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;fetch&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  e<span class="token punctuation">.</span><span class="token function">respondWith</span><span class="token punctuation">(</span>
    <span class="token function">fetch</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>request<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token keyword">return</span> response<span class="token punctuation">;</span>

        <span class="token comment">// User is online, but response was not ok</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isImage</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>request<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// Get broken image placeholder from cache</span>
          <span class="token keyword">return</span> caches<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token string">&apos;/broken.png&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// User is probably offline</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isImage</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>request<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// Get broken image placeholder from cache</span>
          <span class="token keyword">return</span> caches<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token string">&apos;/broken.png&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;install&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  self<span class="token punctuation">.</span><span class="token function">skipWaiting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  e<span class="token punctuation">.</span><span class="token function">waitUntil</span><span class="token punctuation">(</span>
    caches<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&apos;precache&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cache</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// Add /broken.png to &quot;precache&quot;</span>
      cache<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&apos;/broken.png&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="pwa-library"><a name="pwa-library" class="anchor-navigation-ex-anchor" href="#pwa-library"><i class="fa fa-link" aria-hidden="true"></i></a>12.2. PWA Library</h3>
<ul>
<li><a href="https://github.com/GoogleChrome/workbox" target="_blank">Workbox</a></li>
</ul>
<h3 id="pwa-tutorials"><a name="pwa-tutorials" class="anchor-navigation-ex-anchor" href="#pwa-tutorials"><i class="fa fa-link" aria-hidden="true"></i></a>12.3. PWA Tutorials</h3>
<ul>
<li><a href="https://www.smashingmagazine.com/2018/11/guide-pwa-progressive-web-applications" target="_blank">Extensive Guide</a></li>
</ul>
<h2 id="http2"><a name="http2" class="anchor-navigation-ex-anchor" href="#http2"><i class="fa fa-link" aria-hidden="true"></i></a>13. HTTP/2</h2>
<p>&#x5728; HTTP/1.x &#x4E2D;&#xFF0C;&#x6BCF;&#x6B21;&#x8BF7;&#x6C42;&#x90FD;&#x4F1A;&#x5EFA;&#x7ACB;&#x4E00;&#x6B21; HTTP &#x8FDE;&#x63A5;:</p>
<ul>
<li>&#x4E32;&#x884C;&#x7684;&#x6587;&#x4EF6;&#x4F20;&#x8F93;. &#x5F53;&#x8BF7;&#x6C42; a &#x6587;&#x4EF6;&#x65F6;, b &#x6587;&#x4EF6;&#x53EA;&#x80FD;&#x7B49;&#x5F85;</li>
<li>&#x8FDE;&#x63A5;&#x6570;&#x8FC7;&#x591A;</li>
</ul>
<p>HTTP/2 &#x7684;&#x591A;&#x8DEF;&#x590D;&#x7528;&#x5C31;&#x662F;&#x4E3A;&#x4E86;&#x89E3;&#x51B3;&#x4E0A;&#x8FF0;&#x7684;&#x4E24;&#x4E2A;&#x6027;&#x80FD;&#x95EE;&#x9898;.
&#x5728; HTTP/2 &#x4E2D;, &#x6709;&#x4E24;&#x4E2A;&#x975E;&#x5E38;&#x91CD;&#x8981;&#x7684;&#x6982;&#x5FF5;, &#x5206;&#x522B;&#x662F;&#x5E27;&#xFF08;frame&#xFF09;&#x548C;&#x6D41;&#xFF08;stream&#xFF09;.
&#x5E27;&#x4EE3;&#x8868;&#x7740;&#x6700;&#x5C0F;&#x7684;&#x6570;&#x636E;&#x5355;&#x4F4D;, &#x6BCF;&#x4E2A;&#x5E27;&#x4F1A;&#x6807;&#x8BC6;&#x51FA;&#x8BE5;&#x5E27;&#x5C5E;&#x4E8E;&#x54EA;&#x4E2A;&#x6D41;, &#x6D41;&#x4E5F;&#x5C31;&#x662F;&#x591A;&#x4E2A;&#x5E27;&#x7EC4;&#x6210;&#x7684;&#x6570;&#x636E;&#x6D41;.
&#x591A;&#x8DEF;&#x590D;&#x7528;, &#x5C31;&#x662F;&#x5728;&#x4E00;&#x4E2A; TCP &#x8FDE;&#x63A5;&#x4E2D;&#x53EF;&#x4EE5;&#x5B58;&#x5728;&#x591A;&#x6761;&#x6D41;, &#x907F;&#x514D;&#x961F;&#x5934;&#x963B;&#x585E;&#x95EE;&#x9898;&#x548C;&#x8FDE;&#x63A5;&#x6570;&#x8FC7;&#x591A;&#x95EE;&#x9898;.</p>
<h2 id="security"><a name="security" class="anchor-navigation-ex-anchor" href="#security"><i class="fa fa-link" aria-hidden="true"></i></a>14. Security</h2>
<h3 id="content-security-policy-level-3"><a name="content-security-policy-level-3" class="anchor-navigation-ex-anchor" href="#content-security-policy-level-3"><i class="fa fa-link" aria-hidden="true"></i></a>14.1. Content Security Policy Level 3</h3>
<p>CSP help prevent from XSS</p>
<pre class="language-"><code class="lang-json"><span class="token punctuation">{</span>
  <span class="token property">&quot;header&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;Content-Security-Policy&quot;</span><span class="token operator">:</span> &quot;
      script-src &apos;nonce-random123&apos; &apos;strict-dynamic&apos; &apos;unsafe-eval&apos;;
      object-src &apos;none&apos;; base-uri &apos;none&apos;
    &quot;
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<pre class="language-"><code class="lang-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span>
  alert(&apos;xss&apos;);
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
// XSS injected by attacker - blocked by CSP
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">nonce</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>random123<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  alert(&apos;this is fine!)
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">nonce</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>random123<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdnjs.com/lib.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<p>nonce only CSP block 3rd lscripts and dynamic scripts generate by trusted users,
&apos;strict-dynamic&apos; can tackle it.</p>
<pre class="language-"><code class="lang-html"><span class="token comment">&lt;!-- Content-Security-Policy: script-src &apos;nonce-random123&apos; &apos;strict-dynamic&apos; --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">nonce</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>random123<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  const s = document.createElement(&apos;script)
  s.src = &apos;/path/to/script.js&apos;;
  document.head.appendChild(s); // can execute correctly
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h3 id="trusted-types"><a name="trusted-types" class="anchor-navigation-ex-anchor" href="#trusted-types"><i class="fa fa-link" aria-hidden="true"></i></a>14.2. Trusted Types</h3>
<ul>
<li>TrustedURL</li>
<li>TrustedHTML</li>
<li>TrustedScript</li>
<li>TrustedScriptURL</li>
</ul>
<pre class="language-"><code class="lang-js"><span class="token comment">// fallback policy</span>
TrustedTypes<span class="token punctuation">.</span><span class="token function">createPolicy</span><span class="token punctuation">(</span>
  <span class="token string">&apos;default&apos;</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token function">createHTML</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&apos;Please fix! Insecure string assignment detected:&apos;</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> s<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token boolean">true</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-"><code class="lang-js"><span class="token comment">// Content-Security-Policy-Report-Only: trusted-types myPolicy; report-uri /cspReport</span>
<span class="token keyword">const</span> SanitizingPolicy <span class="token operator">=</span> TrustedTypes<span class="token punctuation">.</span><span class="token function">createPolicy</span><span class="token punctuation">(</span><span class="token string">&apos;myPolicy&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">createHTML</span><span class="token punctuation">(</span><span class="token parameter">s<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">myCustomSanitizer</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> trustedHTML <span class="token operator">=</span> SanitizingPolicy<span class="token punctuation">.</span><span class="token function">createHTML</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span>
element<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> trustedHTML<span class="token punctuation">;</span>
</code></pre>
<h3 id="csrf"><a name="csrf" class="anchor-navigation-ex-anchor" href="#csrf"><i class="fa fa-link" aria-hidden="true"></i></a>14.3. CSRF</h3>
<pre class="language-"><code class="lang-python"><span class="token comment"># Reject cross-origin requests to protect from</span>
<span class="token comment"># CSRF, XSSI &amp; other bugs</span>
<span class="token keyword">def</span> <span class="token function">allow_request</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token comment"># Allow requests from browsers which don&apos;t send Fetch Metadata</span>
  <span class="token keyword">if</span> <span class="token keyword">not</span> req<span class="token punctuation">[</span><span class="token string">&apos;sec-fetch-site&apos;</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token boolean">True</span>

  <span class="token comment"># Allow same-site and browser-initiated requests</span>
  <span class="token keyword">if</span> req<span class="token punctuation">[</span><span class="token string">&apos;sec-fetch-site&apos;</span><span class="token punctuation">]</span> <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">&apos;same-origin&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;same-site&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;none&apos;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token boolean">True</span>

  <span class="token comment"># Allow simple top-lelve navigations from anywhere</span>
  <span class="token keyword">if</span> req<span class="token punctuation">[</span><span class="token string">&apos;sec-fetch-mode&apos;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&apos;navigate&apos;</span> <span class="token keyword">and</span> req<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">&apos;GET&apos;</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token boolean">True</span>

  <span class="token keyword">return</span> <span class="token boolean">False</span>
</code></pre>
<h3 id="object-property"><a name="object-property" class="anchor-navigation-ex-anchor" href="#object-property"><i class="fa fa-link" aria-hidden="true"></i></a>14.4. Object Property</h3>
<ul>
<li><code>object[constructor]</code></li>
<li><code>object.__proto__</code></li>
</ul>
<h3 id="sandbox"><a name="sandbox" class="anchor-navigation-ex-anchor" href="#sandbox"><i class="fa fa-link" aria-hidden="true"></i></a>14.5. Sandbox</h3>
<pre class="language-"><code class="lang-js"><span class="token comment">// &#x7B80;&#x5316;&#x4F2A;&#x4EE3;&#x7801;&#x793A;&#x4F8B;</span>
frame <span class="token operator">=</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&apos;iframe&apos;</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
  src<span class="token operator">:</span> <span class="token string">&apos;about:blank&apos;</span><span class="token punctuation">,</span>
  sandbox<span class="token operator">:</span> <span class="token string">&quot;allow-scripts allow-same-origin allow-popups allow-presentation allow-top-navigation&quot;</span><span class="token punctuation">,</span>
  style<span class="token operator">:</span> <span class="token string">&apos;display: none;&apos;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

window <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>frame<span class="token punctuation">.</span>contentWindow<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
document <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>document<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">...</span>


sandbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Function</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  return function ({ window, location, history, document }, code){
    with(window) {
      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>code<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
    }
}</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>

<span class="token function">sandbox</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span> <span class="token punctuation">{</span> window<span class="token punctuation">,</span> location<span class="token punctuation">,</span> history<span class="token punctuation">,</span> document <span class="token punctuation">}</span><span class="token punctuation">,</span> code<span class="token punctuation">)</span>
</code></pre>
<h3 id="user-fingerprint"><a name="user-fingerprint" class="anchor-navigation-ex-anchor" href="#user-fingerprint"><i class="fa fa-link" aria-hidden="true"></i></a>14.6. User Fingerprint</h3>
<p>Use Canvas or WebGL to generate user
<a href="https://yinzhicao.org/TrackingFree/crossbrowsertracking_NDSS17.pdf" target="_blank">fingerprint</a>.</p>
<pre class="language-"><code class="lang-js"><span class="token keyword">function</span> <span class="token function">getCanvasFingerprint</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&apos;canvas&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> context <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&apos;2d&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  context<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">&apos;18pt Arial&apos;</span><span class="token punctuation">;</span>
  context<span class="token punctuation">.</span>textBaseline <span class="token operator">=</span> <span class="token string">&apos;top&apos;</span><span class="token punctuation">;</span>
  context<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span><span class="token string">&apos;Hello, user.&apos;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">&apos;image/jpeg&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">getCanvasFingerprint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="http-protocol"><a name="http-protocol" class="anchor-navigation-ex-anchor" href="#http-protocol"><i class="fa fa-link" aria-hidden="true"></i></a>15. HTTP Protocol</h2>
<h3 id="http-2"><a name="http-2" class="anchor-navigation-ex-anchor" href="#http-2"><i class="fa fa-link" aria-hidden="true"></i></a>15.1. HTTP 2</h3>
<p>HTTP/2 = <code>HTTP</code> + <code>HPack / Strem</code> + <code>TLS 1.2+</code> + <code>TCP</code></p>
<ul>
<li>&#x4E8C;&#x8FDB;&#x5236;&#x4F20;&#x8F93; (&#x4E71;&#x5E8F;&#x4E8C;&#x8FDB;&#x5236;&#x5E27; Stream)</li>
<li>Header &#x538B;&#x7F29; (HPack)</li>
<li>&#x591A;&#x8DEF;&#x590D;&#x7528;</li>
<li>Server Push</li>
<li>&#x4E8B;&#x5B9E;&#x52A0;&#x5BC6; (Chrome/Firefox &#x53EA;&#x652F;&#x6301; HTTP/2 over TLS 1.2+)</li>
</ul>
<h3 id="http-3"><a name="http-3" class="anchor-navigation-ex-anchor" href="#http-3"><i class="fa fa-link" aria-hidden="true"></i></a>15.2. HTTP 3</h3>
<p>HTTP/3 = <code>HTTP</code> + <code>QPack / Strem</code> + <code>QUIC / TLS 1.3+</code> + <code>UDP</code></p>
<ul>
<li>&#x89E3;&#x51B3;&#x591A;&#x6B21;&#x63E1;&#x624B;&#x9AD8;&#x5EF6;&#x8FDF;&#x95EE;&#x9898;</li>
<li>&#x89E3;&#x51B3;&#x961F;&#x5934; (&#x6570;&#x636E;&#x91CD;&#x4F20;) &#x963B;&#x585E; (&#x540E;&#x7EED;&#x6570;&#x636E;) &#x95EE;&#x9898;</li>
<li>QUIC &#x534F;&#x8BAE;&#x4FDD;&#x8BC1;&#x4F20;&#x8F93;&#x53EF;&#x9760;&#x3001;&#x5B9E;&#x73B0;&#x5FEB;&#x901F;&#x63E1;&#x624B;&#x3001;&#x96C6;&#x6210; TLS &#x52A0;&#x5BC6;&#x3001;&#x5B9E;&#x73B0;&#x591A;&#x8DEF;&#x590D;&#x7528;</li>
</ul>
<h2 id="devops"><a name="devops" class="anchor-navigation-ex-anchor" href="#devops"><i class="fa fa-link" aria-hidden="true"></i></a>16. DevOps</h2>
<h3 id="static-assets"><a name="static-assets" class="anchor-navigation-ex-anchor" href="#static-assets"><i class="fa fa-link" aria-hidden="true"></i></a>16.1. Static Assets</h3>
<p>Fingerprinting is a technique that makes the name of a file,
dependent on the <strong>contents</strong> of the file,
not on the <strong>timestamp</strong> differ from servers.
When the file contents change,
the filename is also changed.
For content that is static or infrequently changed,
this provides an easy way to tell whether two versions of a file are identical,
even across different servers or deployment dates.</p>
<p>When a filename is unique and based on its content, HTTP headers
can be set to encourage <strong>caches</strong>(code: <code>200</code>) everywhere
(whether at CDNs, at ISPs, in networking equipment, or in web browsers)
to keep their own copy of the content.
When the content is updated(),
the fingerprint will change.
This will cause the remote clients to request a new copy of the content.
This is generally known as cache busting.</p>
<h3 id="ci-system"><a name="ci-system" class="anchor-navigation-ex-anchor" href="#ci-system"><i class="fa fa-link" aria-hidden="true"></i></a>16.2. CI System</h3>
<ul>
<li>Full builds upon continuous deployment.</li>
<li>Incremental builds are a product of time.</li>
</ul>
<h3 id="release-system"><a name="release-system" class="anchor-navigation-ex-anchor" href="#release-system"><i class="fa fa-link" aria-hidden="true"></i></a>16.3. Release System</h3>
<h3 id="blue-green-deployment"><a name="blue-green-deployment" class="anchor-navigation-ex-anchor" href="#blue-green-deployment"><i class="fa fa-link" aria-hidden="true"></i></a>16.4. Blue Green Deployment</h3>
<p>&#x4E24;&#x5957;&#x7CFB;&#x7EDF;, &#x4E00;&#x5957;&#x7A33;&#x5B9A;&#x7684;&#x7EFF;&#x8272;&#x7CFB;&#x7EDF;, &#x4E00;&#x5957;&#x5373;&#x5C06;&#x53D1;&#x5E03;&#x7684;&#x84DD;&#x8272;&#x7CFB;&#x7EDF;.
&#x4E0D;&#x65AD;&#x5207;&#x6362;&#x5E76;&#x8FED;&#x4EE3;&#x53D1;&#x5E03;&#x5230;&#x751F;&#x4EA7;&#x73AF;&#x5883;&#x4E2D;.</p>
<h3 id="rolling-update"><a name="rolling-update" class="anchor-navigation-ex-anchor" href="#rolling-update"><i class="fa fa-link" aria-hidden="true"></i></a>16.5. Rolling Update</h3>
<p>&#x591A;&#x4E2A;&#x96C6;&#x7FA4;&#x5B9E;&#x4F8B;&#x7684;&#x670D;&#x52A1;&#x4E2D;, &#x5728;&#x4E0D;&#x5F71;&#x54CD;&#x670D;&#x52A1;&#x7684;&#x60C5;&#x51B5;&#x4E0B;,
&#x505C;&#x6B62;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5B9E;&#x4F8B;, &#x9010;&#x6B65;&#x8FDB;&#x884C;&#x7248;&#x672C;&#x66F4;&#x65B0;.</p>
<h3 id="gray-release"><a name="gray-release" class="anchor-navigation-ex-anchor" href="#gray-release"><i class="fa fa-link" aria-hidden="true"></i></a>16.6. Gray Release</h3>
<h4 id="gray-release-introduction"><a name="gray-release-introduction" class="anchor-navigation-ex-anchor" href="#gray-release-introduction"><i class="fa fa-link" aria-hidden="true"></i></a><a name="gray-release-introduction" class="plugin-anchor" href="#gray-release-introduction"><i class="fa fa-link" aria-hidden="true"></i></a>Gray Release Introduction</h4>
<p>Canary Release: &#x5168;&#x91CF;&#x6216;&#x589E;&#x91CF;&#x90E8;&#x7F72;&#x65B0;&#x6587;&#x4EF6;, &#x5E76;&#x9010;&#x6B65;&#x628A;&#x6D41;&#x91CF;&#x5207;&#x6362;&#x81F3;&#x65B0; CDN URL.
&#x6839;&#x636E;&#x7070;&#x5EA6;&#x767D;&#x540D;&#x5355;, &#x5C06;&#x7070;&#x5EA6;&#x6D4B;&#x8BD5;&#x7528;&#x6237;&#x7684; CDN Assets
&#x66F4;&#x6362;&#x81F3;&#x4E0D;&#x540C; Version Number &#x6216;&#x8005; Fingerprint &#x7684;&#x65B0;&#x7248;&#x672C;&#x524D;&#x7AEF;&#x9875;&#x9762;&#x6587;&#x4EF6;.</p>
<h4 id="gray-release-solution"><a name="gray-release-solution" class="anchor-navigation-ex-anchor" href="#gray-release-solution"><i class="fa fa-link" aria-hidden="true"></i></a><a name="gray-release-solution" class="plugin-anchor" href="#gray-release-solution"><i class="fa fa-link" aria-hidden="true"></i></a>Gray Release Solution</h4>
<p>&#x901A;&#x8FC7;&#x7070;&#x5EA6;&#x53D1;&#x5E03;&#x6536;&#x96C6;&#x7528;&#x6237;&#x53CD;&#x9988; (&#x8F6C;&#x5316;&#x7387;&#x7B49;&#x6307;&#x6807;),
&#x51B3;&#x5B9A;&#x540E;&#x7EED;&#x662F;&#x5426;&#x5168;&#x9762;&#x5C06;&#x6240;&#x6709;&#x6D41;&#x91CF;&#x5207;&#x81F3;&#x65B0;&#x7248;&#x672C;,
&#x6216;&#x8005;&#x5B8C;&#x5168;&#x653E;&#x5F03;&#x65B0;&#x7248;&#x672C;,
&#x4EA6;&#x6216;&#x662F;&#x901A;&#x8FC7; FLAGS &#x7ED3;&#x5408;&#x7528;&#x6237;&#x7279;&#x5F81;&#x56FE;&#x50CF;,
(&#x5982;&#x7528;&#x6237;&#x7EA7;&#x522B;, UA, Cookie
Location, IP,
Feature List &#x7B49;)
&#x53EA;&#x5411;&#x90E8;&#x5206;&#x6D41;&#x91CF;&#x6295;&#x653E;&#x65B0;&#x7248;&#x672C;.
&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x5343;&#x4EBA;&#x5343;&#x9875;,
&#x6BCF;&#x4E2A;&#x7528;&#x6237;&#x83B7;&#x5F97;&#x7531;&#x4E0D;&#x540C;&#x7684;&#x529F;&#x80FD; (FLAGS &#x5F00;&#x542F;&#x5173;&#x95ED;) &#x7EC4;&#x6210;&#x7684;&#x4E0D;&#x540C;&#x9875;&#x9762;.</p>
<p>&#x4E1A;&#x754C;&#x6210;&#x719F;&#x7684;&#x7070;&#x5EA6;&#x65B9;&#x6848;:</p>
<ul>
<li>&#x7B80;&#x5355;&#x7070;&#x5EA6;&#x903B;&#x8F91;&#x901A;&#x8FC7; Nginx &#x914D;&#x7F6E;&#x505A;&#x89C4;&#x5219;&#x5224;&#x65AD;(&#x8DEF;&#x7531;, &#x53C2;&#x6570;, IP, Cookie &#x7B49;), upstream &#x5230;&#x4E0D;&#x540C;&#x7684;&#x670D;&#x52A1;&#x5668;:<ul>
<li>&#x65B0;&#x4EE3;&#x7801;&#x90E8;&#x7F72;&#x5230; A &#x8FB9;.</li>
<li>&#x7B26;&#x5408;&#x7070;&#x5EA6;&#x7B56;&#x7565;&#x7684;&#x5C0F;&#x90E8;&#x5206;&#x6D41;&#x91CF;&#x5207;&#x5230; A &#x8FB9;, &#x5269;&#x4F59;&#x5927;&#x90E8;&#x5206;&#x6D41;&#x91CF;&#x4ECD;&#x53BB;&#x5F80; B &#x8FB9;</li>
<li>&#x9A8C;&#x8BC1; A &#x8FB9;&#x529F;&#x80FD;&#x662F;&#x5426;&#x6B63;&#x5E38;&#x53EF;&#x7528;/&#x597D;&#x7528;</li>
<li>&#x9A8C;&#x8BC1;&#x65E0;&#x8BEF;&#x540E;, &#x5927;&#x90E8;&#x5206;&#x6D41;&#x91CF;&#x8F6C;&#x5230; A &#x8FB9;, &#x7070;&#x5EA6;&#x6D41;&#x91CF;&#x53BB;&#x5F80; B &#x8FB9;</li>
<li>&#x9A8C;&#x8BC1; B &#x8FB9;&#x529F;&#x80FD;&#x662F;&#x5426;&#x6B63;&#x5E38;&#x53EF;&#x7528;/&#x597D;&#x7528;</li>
<li>&#x9A8C;&#x8BC1;&#x65E0;&#x8BEF;&#x540E;, &#x6D41;&#x91CF;&#x50CF;&#x5F80;&#x5E38;&#x4E00;&#x6837;&#x5747;&#x5206;&#x5230; AB &#x8FB9;</li>
</ul>
</li>
</ul>
<pre class="language-"><code class="lang-bash"><span class="token comment"># Canary Deployment</span>
map <span class="token variable">$COOKIE</span><span class="token punctuation">\</span>_canary <span class="token variable">$group</span> <span class="token punctuation">{</span>
  <span class="token comment"># canary account</span>
  ~<span class="token punctuation">\</span>*devui$ server<span class="token punctuation">\</span>_canary<span class="token punctuation">;</span>
  default server<span class="token punctuation">\</span>_default<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment"># &#x6D41;&#x91CF;&#x5747;&#x5206;, &#x6CE8;&#x91CA;&#x6389;&#x5176;&#x4E2D;&#x67D0;&#x4E00;&#x8FB9;, &#x53E6;&#x4E00;&#x8FB9;&#x4E3A;&#x7070;&#x5EA6;&#x6D41;&#x91CF;&#x8BBF;&#x95EE;&#x8FB9;</span>
upstream server<span class="token punctuation">\</span>_canary <span class="token punctuation">{</span>
  server <span class="token number">11.11</span>.11.11:8000 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">1</span> max<span class="token punctuation">\</span>_fails<span class="token operator">=</span><span class="token number">1</span> fail<span class="token punctuation">\</span>_timeout<span class="token operator">=</span>30s<span class="token punctuation">;</span>
  server <span class="token number">22.22</span>.22.22 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">1</span> max<span class="token punctuation">\</span>_fails<span class="token operator">=</span><span class="token number">1</span> fail<span class="token punctuation">\</span>_timeout<span class="token operator">=</span>30s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment"># &#x6D41;&#x91CF;&#x5747;&#x5206;, &#x6CE8;&#x91CA;&#x6389;&#x5176;&#x4E2D;&#x67D0;&#x4E00;&#x8FB9;, &#x53E6;&#x4E00;&#x8FB9;&#x4E3A;&#x6B63;&#x5E38;&#x6D41;&#x91CF;&#x8BBF;&#x95EE;&#x8FB9;</span>
upstream server<span class="token punctuation">\</span>_default <span class="token punctuation">{</span>
  server <span class="token number">11.11</span>.11.11:8000 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">2</span> max<span class="token punctuation">\</span>_fails<span class="token operator">=</span><span class="token number">1</span> fail<span class="token punctuation">\</span>_timeout<span class="token operator">=</span>30s<span class="token punctuation">;</span>
  server <span class="token number">22.22</span>.22.22 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">2</span> max<span class="token punctuation">\</span>_fails<span class="token operator">=</span><span class="token number">1</span> fail<span class="token punctuation">\</span>_timeout<span class="token operator">=</span>30s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment"># &#x914D;&#x7F6E; 8000 &#x7AEF;&#x53E3;&#x7684;&#x8F6C;&#x53D1;&#x89C4;&#x5219;, &#x5E76;&#x4E14; expose port</span>
server <span class="token punctuation">{</span>
  listen <span class="token number">8000</span><span class="token punctuation">;</span>
  server<span class="token punctuation">\</span>_name <span class="token punctuation">\</span>_<span class="token punctuation">;</span>
  root /var/canaryDemo<span class="token punctuation">;</span>

  <span class="token comment"># Load configuration files for the default server block.</span>
  include /etc/nginx/default.d/<span class="token punctuation">\</span>*.conf<span class="token punctuation">;</span>

  location / <span class="token punctuation">{</span>
    root /var/canaryDemo<span class="token punctuation">;</span>
    index index.html<span class="token punctuation">;</span>
    try_files <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ /index.html<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

server <span class="token punctuation">{</span>
  listen <span class="token number">80</span> default<span class="token punctuation">\</span>_server<span class="token punctuation">;</span>
  listen <span class="token punctuation">\</span><span class="token punctuation">[</span>::<span class="token punctuation">\</span><span class="token punctuation">]</span>:80 default<span class="token punctuation">\</span>_server<span class="token punctuation">;</span>
  server<span class="token punctuation">\</span>_name <span class="token punctuation">\</span>_<span class="token punctuation">;</span>
  <span class="token comment"># root /usr/share/nginx/html;</span>
  root /var/canaryDemo<span class="token punctuation">;</span>

  <span class="token comment"># Load configuration files for the default server block.</span>
  include /etc/nginx/default.d/<span class="token punctuation">\</span>*.conf<span class="token punctuation">;</span>

  location / <span class="token punctuation">{</span>
    proxy<span class="token punctuation">\</span>_pass http://<span class="token variable">$group</span><span class="token punctuation">;</span>
    <span class="token comment"># root /var/canaryDemo;</span>
    <span class="token comment"># index index.html;</span>
  <span class="token punctuation">}</span>

  error<span class="token punctuation">\</span>_page <span class="token number">404</span> /404.html<span class="token punctuation">;</span>
    location <span class="token operator">=</span> /40x.html <span class="token punctuation">{</span>
  <span class="token punctuation">}</span>

  error<span class="token punctuation">\</span>_page <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span> /50x.html<span class="token punctuation">;</span>
  location <span class="token operator">=</span> /50x.h
<span class="token punctuation">}</span>
</code></pre>
<ul>
<li>&#x590D;&#x6742;&#x7070;&#x5EA6;&#x903B;&#x8F91;&#x901A;&#x8FC7; Nginx + Lua &#x65B0;&#x589E;&#x4E00;&#x4E2A;&#x7070;&#x5EA6;&#x4E2D;&#x5FC3;&#x670D;&#x52A1;,
&#x7ED3;&#x5408;&#x4E1A;&#x52A1;&#x6765;&#x505A;&#x6D41;&#x91CF;&#x7684;&#x7070;&#x5EA6;&#x4E0E;&#x5207;&#x6362;, &#x63A7;&#x5236; HTML &#x5165;&#x53E3;&#x6587;&#x4EF6;,
&#x4F7F;&#x7070;&#x5EA6;&#x89C4;&#x5219;&#x4E0E;&#x4E1A;&#x52A1;&#x4EE3;&#x7801;&#x89E3;&#x8026;.</li>
</ul>
<h4 id="gray-release-performance"><a name="gray-release-performance" class="anchor-navigation-ex-anchor" href="#gray-release-performance"><i class="fa fa-link" aria-hidden="true"></i></a><a name="gray-release-performance" class="plugin-anchor" href="#gray-release-performance"><i class="fa fa-link" aria-hidden="true"></i></a>Gray Release Performance</h4>
<ul>
<li><p>&#x524D;&#x7AEF;&#x4F18;&#x5316;:
&#x6BCF;&#x4E00;&#x4E2A;&#x9875;&#x9762;&#x90FD;&#x9700;&#x8981;&#x53BB;&#x83B7;&#x53D6;&#x7070;&#x5EA6;&#x89C4;&#x5219;&#xFF0C;&#x8FD9;&#x4E2A;&#x7070;&#x5EA6;&#x8BF7;&#x6C42;&#x5C06;&#x963B;&#x585E;&#x9875;&#x9762;.
&#x53EF;&#x4EE5;&#x4F7F;&#x7528; localStrage &#x5B58;&#x50A8;&#x8FD9;&#x4E2A;&#x7528;&#x6237;&#x662F;&#x5426;&#x4E3A;&#x7070;&#x5EA6;&#x7528;&#x6237;,
&#x7136;&#x540E;&#x5B9A;&#x671F;&#x7684;&#x66F4;&#x65B0; localStrage,
&#x53D6;&#x4EE3;&#x5927;&#x91CF;&#x7684;&#x8BF7;&#x6C42;&#x9020;&#x6210;&#x7684;&#x4F53;&#x9A8C;&#x95EE;&#x9898;.</p>
</li>
<li><p>&#x540E;&#x7AEF;&#x4F18;&#x5316;:
&#x5229;&#x7528; MemCache &#x5728;&#x5185;&#x5B58;&#x4E2D;&#x7F13;&#x5B58;&#x7070;&#x5EA6;&#x89C4;&#x5219;&#x4E0E;&#x7070;&#x5EA6;&#x7528;&#x6237;&#x5217;&#x8868;,
&#x63D0;&#x5347;&#x7070;&#x5EA6;&#x53D1;&#x5E03;&#x6027;&#x80FD;.</p>
</li>
</ul>
<footer class="page-footer"><span class="copyright">&#xA9; <a xmlns:cc="http://creativecommons.org/ns#" href="https://github.com/sabertazimi/awesome-notes" property="cc:attributionName" rel="cc:attributionURL" target="_blank">sabertazimi</a> &#xB7; &#x9075;&#x5FAA; <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">&#x77E5;&#x8BC6;&#x5171;&#x4EAB; &#x7F72;&#x540D;-&#x975E;&#x5546;&#x4E1A;&#x6027;&#x4F7F;&#x7528; 4.0 &#x56FD;&#x9645; &#x8BB8;&#x53EF;&#x534F;&#x8BAE;</a> all right reserved&#xFF0C;powered by Gitbook</span><span class="footer-modification">&#x6700;&#x8FD1;&#x66F4;&#x65B0;&#xFF1A;
2021-07-15 21:57
</span></footer>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                
                <a href="javascriptBasicNotes.html" class="navigation navigation-next navigation-unique" aria-label="Next page: Javascript Basic Notes">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Javascript Advanced Notes","level":"1.4.8.5.1","depth":4,"next":{"title":"Javascript Basic Notes","level":"1.4.8.5.2","depth":4,"path":"programming/web/javascript/javascriptBasicNotes.md","ref":"programming/web/javascript/javascriptBasicNotes.md","articles":[]},"previous":{"title":"Javascript","level":"1.4.8.5","depth":3,"ref":"","articles":[{"title":"Javascript Advanced Notes","level":"1.4.8.5.1","depth":4,"path":"programming/web/javascript/javascriptAdvancedNotes.md","ref":"programming/web/javascript/javascriptAdvancedNotes.md","articles":[]},{"title":"Javascript Basic Notes","level":"1.4.8.5.2","depth":4,"path":"programming/web/javascript/javascriptBasicNotes.md","ref":"programming/web/javascript/javascriptBasicNotes.md","articles":[]},{"title":"Typescript Basic Notes","level":"1.4.8.5.3","depth":4,"path":"programming/web/javascript/typescriptBasicNotes.md","ref":"programming/web/javascript/typescriptBasicNotes.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["-lunr","-search","search-plus","splitter","anchors","anchor-navigation-ex","copy-code-button","expandable-chapters","theme-darkblue","theme-comscore","tbfed-pagefooter","prism","-highlight","github-buttons","edit-link","disqus","introsum"],"ignores":[".*","build","_book","gitbook","node_modules"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"&copy <a xmlns:cc=\"http://creativecommons.org/ns#\" href=\"https://github.com/sabertazimi/awesome-notes\" property=\"cc:attributionName\" rel=\"cc:attributionURL\">sabertazimi</a> Â· éµå¾ª <a rel=\"license\" href=\"http://creativecommons.org/licenses/by-nc/4.0/\">ç¥è¯å±äº« ç½²å-éåä¸æ§ä½¿ç¨ 4.0 å½é è®¸å¯åè®®</a>","modify_label":"æè¿æ´æ°ï¼","modify_format":"YYYY-MM-DD HH:mm"},"prism":{"css":["prismjs/themes/prism-tomorrow.css"]},"disqus":{"useIdentifier":false,"shortName":"gitbook-8"},"splitter":{},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-darkblue":{},"anchor-navigation-ex":{"associatedWithSummary":true,"float":{"floatIcon":"fa fa-navicon","level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"mode":"float","multipleH1":false,"pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"printLog":false,"showGoTop":true,"showLevel":true},"theme-comscore":{},"github-buttons":{"buttons":[{"user":"sabertazimi","repo":"awesome-notes","type":"star","size":"small","count":true}]},"copy-code-button":{},"sharing":{"facebook":false,"twitter":true,"google":false,"weibo":true,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"edit-link":{"label":"Edit This Page","base":"https://github.com/sabertazimi/awesome-notes/edit/master"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchors":{},"introsum":{},"expandable-chapters":{},"search-plus":{}},"theme":"default","author":"sabertazimi","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Awesome Notes","links":{"sidebar":{"Awesome Notes":"https://github.com/sabertazimi/awesome-notes"}},"gitbook":"*"},"file":{"path":"programming/web/javascript/javascriptAdvancedNotes.md","mtime":"2021-07-15T21:57:06.376Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-07-15T21:58:50.568Z"},"basePath":"../../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../../gitbook/gitbook.js"></script>
    <script src="../../../gitbook/theme.js"></script>
    
        
        <script src="../../../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-github-buttons/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-edit-link/plugin.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.16.1/URI.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-disqus/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-theme-comscore/test.js"></script>
        
    

    </body>
</html>

